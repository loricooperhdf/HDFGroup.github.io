<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-07-19 Tue 12:04 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Call the Doctor - HDF(5) Clinic</title>
<meta name="author" content="gerd" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Call the Doctor - HDF(5) Clinic</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org049a47e">Clinic 2022-07-19</a>
<ul>
<li><a href="#org4faac26">Your questions</a></li>
<li><a href="#orgee11667">Last week's highlights</a></li>
<li><a href="#orge5a25b2">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org4734e29">Clinic 2022-07-12</a>
<ul>
<li><a href="#orgbc4e366">Your questions</a></li>
<li><a href="#orgee18a3d">Last week's highlights</a></li>
<li><a href="#orge632062">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org5dcfc42">Clinic 2022-07-05</a>
<ul>
<li><a href="#org18d9bae">Your questions</a></li>
<li><a href="#orgc75180b">Last week's highlights</a></li>
<li><a href="#orgdea318d">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgcdd789e">Clinic 2022-06-27</a>
<ul>
<li><a href="#orgec49c5a">Your questions</a></li>
<li><a href="#orgddbdd8a">Last week's highlights</a></li>
<li><a href="#org600cc25">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgcab5ef6">Clinic 2022-06-21</a>
<ul>
<li><a href="#org4f2a4bc">Your questions</a></li>
<li><a href="#org03ee83e">Last week's highlights</a></li>
<li><a href="#org66d218f">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org364ec52">Clinic 2022-06-14</a>
<ul>
<li><a href="#orgbe8f2b4">Your questions</a></li>
<li><a href="#orgcb6618d">Last week's highlights</a></li>
<li><a href="#orgcfe2488">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org9994599">Clinic 2022-06-07</a>
<ul>
<li><a href="#orgb48a40d">Your questions</a></li>
<li><a href="#org11c4186">Last week's highlights</a></li>
<li><a href="#orgb0efef3">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org6cdabbd">Clinic 2022-05-24</a>
<ul>
<li><a href="#org4089f93">Your questions</a></li>
<li><a href="#org6c92fd4">Last week's highlights</a></li>
<li><a href="#org6baf05f">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgdb6a0b6">Clinic 2022-05-17</a>
<ul>
<li><a href="#org9bf3827">Your questions</a></li>
<li><a href="#org88578bd">Last week's highlights</a></li>
<li><a href="#orgda763fe">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org2ed3223">Clinic 2022-05-10</a>
<ul>
<li><a href="#orgae7ee8c">Your questions</a></li>
<li><a href="#orge2ec4a4">Last week's highlights</a></li>
<li><a href="#org5482dcc">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org696d378">Clinic 2022-04-26</a>
<ul>
<li><a href="#org8110161">Your questions</a></li>
<li><a href="#org3c95f9f">Last week's highlights</a></li>
<li><a href="#org7d6d635">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org1be06d0">Clinic 2022-04-19</a>
<ul>
<li><a href="#org2936165">Your questions</a></li>
<li><a href="#org081cf0a">Last week's highlights</a></li>
<li><a href="#org4ee229f">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org6f95ca2">Clinic 2022-04-12</a>
<ul>
<li><a href="#orgbaed712">Your questions</a></li>
<li><a href="#orgab5f131">Last week's highlights</a></li>
<li><a href="#org91b5ea9">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org2e469cc">Clinic 2022-04-05</a>
<ul>
<li><a href="#org72e647e">Your questions</a></li>
<li><a href="#orgb911b2d">Last week's highlights</a></li>
<li><a href="#orge8f5b2e">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgf379de5">Clinic 2022-03-29</a>
<ul>
<li><a href="#org2f5c966">Your questions</a></li>
<li><a href="#org47df942">Last week's highlights</a></li>
<li><a href="#org4bbe91c">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgcfce61f">Clinic 2022-03-22</a>
<ul>
<li><a href="#org879dc84">Your questions</a></li>
<li><a href="#orgb49f03f">Last week's highlights</a></li>
<li><a href="#org40b8e19">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgf7bd1f1">Clinic 2022-03-15</a>
<ul>
<li><a href="#org512b21f">Your questions</a></li>
<li><a href="#org9a2ca92">Last week's highlights</a></li>
<li><a href="#org5f5fcd9">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgf557675">Clinic 2022-03-08</a>
<ul>
<li><a href="#org67d0612">Your Questions</a></li>
<li><a href="#org35e88eb">Last week's highlights</a></li>
<li><a href="#orge78b623">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org5001c9f">Clinic 2022-03-01</a>
<ul>
<li><a href="#org5217ecb">Your Questions</a></li>
<li><a href="#org2d6632e">Last week's highlights</a></li>
<li><a href="#org4ed91fc">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org4fe1306">Clinic 2022-02-22</a>
<ul>
<li><a href="#orga0691f9">Your Questions</a></li>
<li><a href="#orgb12a92d">Last week's highlights</a></li>
<li><a href="#org0b7c699">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgbbfc867">Clinic 2022-02-15</a>
<ul>
<li><a href="#org24b99b4">Your Questions</a></li>
<li><a href="#org18f87ca">Last week's highlights</a></li>
<li><a href="#org760edef">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org6f98f78">Clinic 2022-02-08</a>
<ul>
<li><a href="#org6aca59a">Your Questions</a></li>
<li><a href="#org886af85">Last week's highlights</a></li>
<li><a href="#orgde0e118">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org4d07d98">Clinic 2022-02-01</a>
<ul>
<li><a href="#org61d54dd">Your Questions</a></li>
<li><a href="#org189ad6f">Last week's highlights</a></li>
<li><a href="#orgff55dbb">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgdf13d34">Clinic 2022-01-25</a>
<ul>
<li><a href="#org872553d">Your Questions</a></li>
<li><a href="#orgd2c8d5a">Last week's highlights</a></li>
<li><a href="#orge717292">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org91876b7">Clinic 2022-01-18</a>
<ul>
<li><a href="#org520be6f">Your Questions</a></li>
<li><a href="#orgd2b1ccb">Last week's highlights</a></li>
<li><a href="#org74d994e">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orga1a3fd3">Clinic 2022-01-11</a>
<ul>
<li><a href="#orgfd80f17">Your Questions</a></li>
<li><a href="#org5631d6d">Last week's highlights</a></li>
<li><a href="#org88c15a9">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org1ba9c4a">Clinic 2022-01-04</a>
<ul>
<li><a href="#org67a2431">Your Questions</a></li>
<li><a href="#org07d50a5">Last week's highlights</a></li>
<li><a href="#orga69b812">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org5e4c291">Clinic 2021-12-21</a>
<ul>
<li><a href="#org13f2146">Your Questions</a></li>
<li><a href="#orgdcde0e5">Last week's highlights</a></li>
<li><a href="#org9754454">Tips, tricks, &amp; insights</a></li>
<li><a href="#org32a5726">On behalf of The HDF Group, I wish you a Merry Christmas and a Happy New Year!</a></li>
</ul>
</li>
<li><a href="#org7bbd06d">Clinic 2021-12-07</a>
<ul>
<li><a href="#org4103ea0">Your Questions</a></li>
<li><a href="#org8e3c00d">Last week's highlights</a></li>
<li><a href="#org4e7d6b7">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org72e910f">Clinic 2021-11-23</a>
<ul>
<li><a href="#orgfc2ab14">Your Questions</a></li>
<li><a href="#orge149840">Last week's highlights</a></li>
<li><a href="#orge5f2481">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org6c9488d">Clinic 2021-11-16</a>
<ul>
<li><a href="#orge54498a">Your Questions</a></li>
<li><a href="#org2a153e0">Last week's highlights</a></li>
<li><a href="#org14237ea">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org7e042bf">Clinic 2021-11-09</a>
<ul>
<li><a href="#org1133f58">Your Questions</a></li>
<li><a href="#org6e5b532">Last week's highlights</a></li>
<li><a href="#org6b34127">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgbf57238">Clinic 2021-11-02</a>
<ul>
<li><a href="#orgdbec2f6">Your Questions</a></li>
<li><a href="#org9f843e1">Last week's highlights</a></li>
<li><a href="#org7dabd8c">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org5895b26">Clinic 2021-10-28</a>
<ul>
<li><a href="#org3228ff9">Your Questions</a></li>
<li><a href="#org2913ffb">Last week's highlights</a></li>
<li><a href="#org54601ac">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org7d17c81">Clinic 2021-10-19</a>
<ul>
<li><a href="#orgf34076e">Your Questions</a></li>
<li><a href="#org804d518">Last week's highlights</a></li>
<li><a href="#org93f0183">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org34bf940">Clinic 2021-09-28</a>
<ul>
<li><a href="#org9e63dae">Your Questions</a></li>
<li><a href="#org10e6b28">Last week's highlights</a></li>
<li><a href="#org4eb16c1">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgb231861">Clinic 2021-09-21</a></li>
<li><a href="#org9e90357">Clinic 2021-08-31</a>
<ul>
<li><a href="#org6f8122b">Your Questions</a></li>
<li><a href="#orgceacf2f">Last week's highlights</a></li>
<li><a href="#org5adaa84">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org05e1039">Clinic 2021-08-24</a>
<ul>
<li><a href="#org5a22b43">Your Questions</a></li>
<li><a href="#org7959f42">Last week's highlights</a></li>
<li><a href="#orgb21382a">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgb42397c">Clinic 2021-08-17</a>
<ul>
<li><a href="#orgc523e3c">Your Questions</a></li>
<li><a href="#org91cbeff">Last week's highlights</a></li>
<li><a href="#org13c0f08">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgc9d25a9">Clinic 2021-08-10</a>
<ul>
<li><a href="#orgee9b2c7">Your Questions</a></li>
<li><a href="#orgac7785f">Last week's highlights</a></li>
<li><a href="#org75d6ec2">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org4485e8f">Clinic 2021-08-03</a>
<ul>
<li><a href="#orge73cfea">Your Questions</a></li>
<li><a href="#org536f7d8">Last week's highlights</a></li>
<li><a href="#orgea34148">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org129281a">Clinic 2021-07-27</a>
<ul>
<li><a href="#orgab7d8c5">Your Questions</a></li>
<li><a href="#org74dec1a">Last week's highlights</a></li>
<li><a href="#org178bfb4">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgebe778b">Clinic 2021-07-20</a>
<ul>
<li><a href="#orge148c68">Your Questions</a></li>
<li><a href="#org93dac6f">Last week's highlights</a></li>
<li><a href="#orge2e1a2b">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#org1a7c210">Clinic 2021-07-13</a>
<ul>
<li><a href="#orgb721519">Your Questions</a></li>
<li><a href="#orgdbd8ca8">Last week's highlights</a></li>
<li><a href="#org0af9ecc">Tips, tricks, &amp; insights</a></li>
</ul>
</li>
<li><a href="#orgae6b50e">Clinic 2021-07-06</a>
<ul>
<li><a href="#orgda9f2d8">Your Questions</a></li>
<li><a href="#org9fc8e04">Last week's highlights</a></li>
<li><a href="#org7778b46">Tips, tricks, &amp; insights</a></li>
<li><a href="#org75a0252">Coming soon</a></li>
</ul>
</li>
<li><a href="#org1e293c6">Clinic 2021-06-29</a>
<ul>
<li><a href="#org2053078">Your Questions</a></li>
<li><a href="#org5c09fce">Last week's highlights</a></li>
<li><a href="#org59cd9b5">Tips, tricks, &amp; insights</a></li>
<li><a href="#org3049fc7">Coming soon</a></li>
</ul>
</li>
<li><a href="#orgc8c965c">Clinic 2021-06-22</a>
<ul>
<li><a href="#orgd28d12c">Your Questions</a></li>
<li><a href="#orgc7571b2">Last week's highlights</a></li>
<li><a href="#orgb64fd5d">Tips, tricks, &amp; insights</a></li>
<li><a href="#org757ec33">Coming soon</a></li>
</ul>
</li>
<li><a href="#org3eb8847">Clinic 2021-06-15</a>
<ul>
<li><a href="#org09f30bc">Your Questions</a></li>
<li><a href="#orgae4b648">Last week's highlights</a></li>
<li><a href="#orga58ad24">Tips, tricks, &amp; insights</a></li>
<li><a href="#org0faa436">Coming soon</a></li>
</ul>
</li>
<li><a href="#orge7e76f7">Clinic 2021-06-08</a>
<ul>
<li><a href="#orge4f73c2">Your Questions</a></li>
<li><a href="#org5431f40">Last week's highlights</a></li>
<li><a href="#org59e290b">Tips, tricks, &amp; insights</a></li>
<li><a href="#org2b2332e">Coming soon</a></li>
</ul>
</li>
<li><a href="#orgdf2c450">Clinic 2021-06-01</a>
<ul>
<li><a href="#orgf367d6f">Your Questions</a></li>
<li><a href="#orgc7c2a10">Last week's highlights</a></li>
<li><a href="#org60d5b7e">Tips, tricks, &amp; insights</a></li>
<li><a href="#org2a3f217">Coming soon</a></li>
</ul>
</li>
<li><a href="#org0d0f74f">Clinic 2021-05-25</a>
<ul>
<li><a href="#orgb2c25fc">Your Questions</a></li>
<li><a href="#orga0b1b48">Last week's highlights</a></li>
<li><a href="#org5588e32">Tips, tricks, &amp; insights</a></li>
<li><a href="#org8e0c35c">Coming soon</a></li>
</ul>
</li>
<li><a href="#orgc55d8bf">Clinic 2021-05-18</a>
<ul>
<li><a href="#org9e0f0b0">Your Questions</a></li>
<li><a href="#orge7bdc82">Last week's highlights</a></li>
<li><a href="#orgca97b51">Tips, tricks, &amp; insights</a></li>
<li><a href="#orgab7e85a">Coming soon</a></li>
</ul>
</li>
<li><a href="#org4f1a9c1">Clinic 2021-05-11</a>
<ul>
<li><a href="#org144db28">Your Questions</a></li>
<li><a href="#org13c6111">Last week's highlights</a></li>
<li><a href="#org31f660f">Tips, tricks, &amp; insights</a></li>
<li><a href="#orgb3d0985">Coming soon</a></li>
</ul>
</li>
<li><a href="#org82e6dcf">Clinic 2021-05-04</a>
<ul>
<li><a href="#orgadb943f">Your Questions</a></li>
<li><a href="#org2acea86">Last week's highlights</a></li>
<li><a href="#org56c2b2f">Tips, tricks, &amp; insights</a></li>
<li><a href="#orgc00132e">Coming soon</a></li>
</ul>
</li>
<li><a href="#org3cb711f">Clinic 2021-04-27</a>
<ul>
<li><a href="#org6239fbe">Your questions</a></li>
<li><a href="#org15f5e8a">Last week's highlights</a></li>
<li><a href="#orgd67e903">Tips, tricks, &amp; insights</a></li>
<li><a href="#orgf252d05">Coming soon</a></li>
</ul>
</li>
<li><a href="#org31b65c9">Clinic 2021-04-20</a>
<ul>
<li><a href="#org4f920af">Your questions</a></li>
<li><a href="#org7d143f5">Last week's highlights</a></li>
<li><a href="#orgc0e82c3">Tips, tricks, &amp; insights</a></li>
<li><a href="#org8296843">Coming soon</a></li>
</ul>
</li>
<li><a href="#org55684ea">Clinic 2021-04-06</a>
<ul>
<li><a href="#org0e0ba1d">Your questions</a></li>
<li><a href="#orgf487ba5">Last week's highlights</a></li>
<li><a href="#orgfb8aeb2">Tips &amp; tricks</a></li>
<li><a href="#org579c7ef">Coming soon</a></li>
</ul>
</li>
<li><a href="#orga1d3df8">Clinic 2021-03-30</a></li>
<li><a href="#org84a3fb4">Clinic 2021-03-23</a>
<ul>
<li><a href="#org04fd3b9">Your questions</a></li>
<li><a href="#orgeeadf41">Last week's highlights</a></li>
<li><a href="#org40cce24">Tips &amp; tricks</a></li>
</ul>
</li>
<li><a href="#orge41e153">Clinic 2021-03-16</a>
<ul>
<li><a href="#org2654620">Your questions</a></li>
<li><a href="#orgb4a333a">Last week's highlights</a></li>
<li><a href="#org00cc3b5">Tips &amp; tricks</a></li>
</ul>
</li>
<li><a href="#org3456aa7">Clinic 2021-03-09</a>
<ul>
<li><a href="#org090db3c">Your questions (as of 9:00 a.m. Central Time)</a></li>
<li><a href="#org74980f9">Last week's highlights</a></li>
</ul>
</li>
<li><a href="#orgd371dc4">Clinic 2021-03-02</a>
<ul>
<li><a href="#org9b9e410">Your questions</a></li>
<li><a href="#orgd251c7b">Last week's highlights</a></li>
</ul>
</li>
<li><a href="#org58dc469">Clinic 2021-02-23</a>
<ul>
<li><a href="#org8ddbc97">Your questions</a></li>
<li><a href="#orgb116dc4">Last week's highlights</a></li>
<li><a href="#org280a8f8">Appendix</a></li>
</ul>
</li>
<li><a href="#org691498e">Clinic 2021-02-09</a>
<ul>
<li><a href="#org9e0398f">Goal(s)</a></li>
<li><a href="#org3a8eccc">This is a meeting dedicated to <i>your</i> questions.</a></li>
<li><a href="#org74fd3c7">In the unlikely event there aren't any</a></li>
<li><a href="#org4ed2812">Sometimes life deals you an HDF5 file</a></li>
<li><a href="#org7a83c7b">Meeting Etiquette</a></li>
<li><a href="#org4783aaf">Be social, turn on your camera (if you've got one)</a></li>
<li><a href="#org20cb2e0">Raise your hand to signal a contribution (question, comment)</a></li>
<li><a href="#orgd4ade04">Be mindful of your "airtime"</a></li>
<li><a href="#org815075d">Introduce yourself</a></li>
<li><a href="#orgd5e1cb1">Use the shared Google doc for questions and code snippets</a></li>
<li><a href="#org95e8ff4">When the 30 min. timer runs out, this meeting is over.</a></li>
<li><a href="#orgb944216">Notes</a></li>
<li><a href="#org427786a">Don't miss our next webinar about data virtualization with HDF5-UDF and how it can streamline your work</a></li>
<li><a href="#org3af2c31">Bug-of-the-Week Award (my candidate)</a></li>
<li><a href="#orgf0a7121">Documentation update</a></li>
</ul>
</li>
<li><a href="#org4f24f13">Clinic 2021-02-16</a>
<ul>
<li><a href="#orgf10e574">Your questions</a></li>
<li><a href="#org3da215c">Last week's highlights</a></li>
<li><a href="#org672a2f4">Notes</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org049a47e" class="outline-2">
<h2 id="org049a47e">Clinic 2022-07-19</h2>
<div class="outline-text-2" id="text-org049a47e">
</div>
<div id="outline-container-org4faac26" class="outline-3">
<h3 id="org4faac26">Your questions</h3>
<div class="outline-text-3" id="text-org4faac26">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-orgee11667" class="outline-3">
<h3 id="orgee11667">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgee11667">
</div>
<ul class="org-ul">
<li><a id="org6272018"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org29b2ba0"></a><a href="https://forum.hdfgroup.org/t/webinar-announcement-an-introduction-to-hdf5-for-hpc-data-models-analysis-and-performance/9947">Webinar Announcement: An Introduction to HDF5 for HPC Data Models, Analysis, and Performance</a><br />
<div class="outline-text-5" id="text-org29b2ba0">
<ul class="org-ul">
<li>Presented by The HDF Group's one and only Scot Breitenfeld</li>
<li><a href="https://events.cels.anl.gov/event/277/">Register here!</a></li>
</ul>
</div>
</li>
<li><a id="org6d768e4"></a><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-2-release/9796">VFD SWMR beta 2 release</a><br />
<div class="outline-text-5" id="text-org6d768e4">
<ul class="org-ul">
<li>Testers wanted</li>
</ul>
</div>
</li>
<li><a id="orgbe73885"></a><a href="https://forum.hdfgroup.org/t/vscode-extension-for-hdf5/9769">VSCode extension for HDF5</a><br />
<div class="outline-text-5" id="text-orgbe73885">
<ul class="org-ul">
<li>Brief demo later</li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="org5b344d2"></a>Forum<br />
<div class="outline-text-4" id="text-org5b344d2">
<p>
The week before last was quiet, but then it got hot&#x2026;
</p>
</div>
<ul class="org-ul">
<li><a id="orgb21bbad"></a><a href="https://forum.hdfgroup.org/t/ros3-driver-breaks-randomly/9957"><code>ros3</code> driver breaks randomly</a><br />
<div class="outline-text-5" id="text-orgb21bbad">
<ul class="org-ul">
<li>Not properly recovering from S3 read failures
<ul class="org-ul">
<li>No retries</li>
</ul></li>
<li>On Python, <a href="https://filesystem-spec.readthedocs.io/en/latest/"><code>fsspec</code></a> might be the better option for the time being</li>
</ul>
</div>
</li>
<li><a id="org86bec95"></a><a href="https://forum.hdfgroup.org/t/memory-mapping-paging-via-hdf5-vfd/9052">Memory mapping / Paging via HDF5 &amp; VFD?</a><br />
<div class="outline-text-5" id="text-org86bec95">
<ul class="org-ul">
<li>Goes back to a HUG 2021 discussion</li>
<li><p>
Maybe we don't need memory mapping API, but
</p>
<blockquote>
<p>
What we really need is the ability to allocate space in the HDF5 file without
writing. (@kittisopikulm)
</p>
</blockquote></li>
<li>Interesting idea</li>
</ul>
</div>
</li>
<li><a id="orge79534d"></a><a href="https://forum.hdfgroup.org/t/possibility-of-backporting-h5dchunk-iter-to-1-12/9971">Possibility of backporting <code>H5Dchunk_iter</code> to 1.12?</a><br />
<div class="outline-text-5" id="text-orge79534d">
<ul class="org-ul">
<li>1.12 is nearing EOL</li>
<li>1.10 might be a better target</li>
</ul>
</div>
</li>
<li><a id="orgd550bcf"></a><a href="https://forum.hdfgroup.org/t/hdfview-on-windows-not-displaying-fixed-length-utf-8-string-correctly/9962">HDFView on Windows not displaying fixed length UTF-8 string correctly</a><br />
<div class="outline-text-5" id="text-orgd550bcf">
<ul class="org-ul">
<li>Probably an HDFView bug</li>
</ul>
</div>
</li>
<li><a id="orgf74280a"></a><a href="https://forum.hdfgroup.org/t/virtual-datasets-in-hsds/9964">Virtual datasets in HSDS?</a><br />
<div class="outline-text-5" id="text-orgf74280a">
<ul class="org-ul">
<li>Not currently supported in HSDS, but&#x2026;
<ul class="org-ul">
<li>You can fake it via <a href="https://github.com/HDFGroup/hsds/blob/master/docs/design/single_object/SingleObject.md"><code>H5D_CHUNKED_REF_INDIRECT</code></a></li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orgf624d3b"></a><a href="https://forum.hdfgroup.org/t/implement-hdf5-in-eclipse-cdt-for-a-c-tool/9990">implement hdf5 in eclipse cdt for a c tool</a> and <a href="https://forum.hdfgroup.org/t/eclipse-mingw-32-need-help/9991">eclipse mingw 32 need help</a><br />
<div class="outline-text-5" id="text-orgf624d3b">
<ul class="org-ul">
<li>Are we failing developers?</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orge5a25b2" class="outline-3">
<h3 id="orge5a25b2">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orge5a25b2">
</div>
<ul class="org-ul">
<li><a id="orga4744d5"></a>First look at the <a href="https://forum.hdfgroup.org/t/vscode-extension-for-hdf5/9769">VSCode extension for HDF5</a><br />
<div class="outline-text-5" id="text-orga4744d5">
<ul class="org-ul">
<li>If you don't have a local installation of VSCode, you can use <a href="https://github.com/features/codespaces">GitHub
Codespaces</a> and run in a Web browser</li>
<li>Or roll your own w/ <a href="https://github.com/coder/code-server"><code>code-server</code></a> and run in the browser</li>
</ul>

<div id="org4a68881" class="figure">
<p><img src="./img/VSCode-ext-hdf5.png" alt="VSCode-ext-hdf5.png" />
</p>
</div>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org4734e29" class="outline-2">
<h2 id="org4734e29">Clinic 2022-07-12</h2>
<div class="outline-text-2" id="text-org4734e29">
</div>
<div id="outline-container-orgbc4e366" class="outline-3">
<h3 id="orgbc4e366">Your questions</h3>
<div class="outline-text-3" id="text-orgbc4e366">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-orgee18a3d" class="outline-3">
<h3 id="orgee18a3d">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgee18a3d">
</div>
<ul class="org-ul">
<li><a id="org7b002ff"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org6daa7fe"></a><a href="https://www.hdfgroup.org/2022/07/deep-dive-hsds-container-types/">Deep Dive: HSDS Container Types</a><br />
<div class="outline-text-5" id="text-org6daa7fe">
<ul class="org-ul">
<li>New blog post by Mr. HSDS (John Readey)</li>
</ul>
</div>
</li>
<li><a id="orgd9cdd29"></a><a href="https://forum.hdfgroup.org/t/webinar-announcement-an-introduction-to-hdf5-for-hpc-data-models-analysis-and-performance/9947">Webinar Announcement: An Introduction to HDF5 for HPC Data Models, Analysis, and Performance</a><br />
<div class="outline-text-5" id="text-orgd9cdd29">
<ul class="org-ul">
<li>Presented by The HDF Group's one and only Scot Breitenfeld</li>
<li><a href="https://events.cels.anl.gov/event/277/">Register here!</a></li>
</ul>
</div>
</li>
<li><a id="orgd609263"></a><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-2-release/9796">VFD SWMR beta 2 release</a><br />
<div class="outline-text-5" id="text-orgd609263">
<ul class="org-ul">
<li>Testers wanted</li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="orgef28065"></a>Forum<br />
<div class="outline-text-4" id="text-orgef28065">
<p>
It was all quiet on the forum. What happened? Everybody must be happy, I
guess&#x2026;
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-orge632062" class="outline-3">
<h3 id="orge632062">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orge632062">
</div>
<ul class="org-ul">
<li><a id="orge134208"></a>HDF5-style datatype conversion<br />
<div class="outline-text-4" id="text-orge134208">
<ul class="org-ul">
<li><b>Use case:</b> A lot of data coming from devices in physical experiments are
bitfields. To be useful for analysts, the data needs to be converted to
engineering types and units. Does that mean we always must store 2 or more
data copies?
<ul class="org-ul">
<li>There is no intrinsic reason to have multiple copies, but there might be
other reasons, e.g., performance, to maintain multiple copies.</li>
<li>How do we pull this off? Filters? (No! Same datatype&#x2026;)
<ul class="org-ul">
<li><i>Datatype transformations!</i></li>
</ul></li>
</ul></li>
<li><b>Example:</b> Use an in-memory bitfield representation and store as a compound w/
two fields</li>
<li><p>
<code>Code</code>
</p>
<div class="org-src-container">
<pre class="src src-C"><span style="color: #808080;">#include</span> <span style="color: #008000;">"hdf5.h"</span>

<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;assert.h&gt;</span>
<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdint.h&gt;</span>
<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdio.h&gt;</span>
<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdlib.h&gt;</span>

<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">our compound destination type in memory</span>
<span style="color: #0000FF;">typedef</span> <span style="color: #0000FF;">struct</span>
{
  <span style="color: #6434A3;">uint16_t</span> <span style="color: #BA36A5;">low</span>;
  <span style="color: #6434A3;">uint16_t</span> <span style="color: #BA36A5;">high</span>;
} <span style="color: #6434A3;">low_high_t</span>;

<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">our conversion function</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">HACK: in a production version, you would inspect SRC_ID and DST_ID, etc.</span>
<span style="color: #6434A3;">herr_t</span> <span style="color: #006699;">bits2cmpd</span>(<span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">src_id</span>, <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dst_id</span>, <span style="color: #6434A3;">H5T_cdata_t</span> *<span style="color: #BA36A5;">cdata</span>, <span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">nelmts</span>,
                 <span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">buf_stride</span>, <span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">bkg_stride</span>, <span style="color: #6434A3;">void</span> *<span style="color: #BA36A5;">buf</span>, <span style="color: #6434A3;">void</span> *<span style="color: #BA36A5;">bkg</span>,
                 <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dxpl</span>)
{
  <span style="color: #6434A3;">herr_t</span> <span style="color: #BA36A5;">retval</span> = EXIT_SUCCESS;

  <span style="color: #0000FF;">switch</span> (cdata-&gt;command)
  {
  <span style="color: #0000FF;">case</span> H5T_CONV_INIT:
    printf(<span style="color: #008000;">"Initializing conversion function...\n"</span>);
    <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">do non-trivial initialization here</span>
    <span style="color: #0000FF;">break</span>;
  <span style="color: #0000FF;">case</span> H5T_CONV_CONV:
    printf(<span style="color: #008000;">"Converting...\n"</span>);
    <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">the conversion function simply splits and swaps bitfield halves</span>
    <span style="color: #6434A3;">low_high_t</span>* <span style="color: #BA36A5;">ptr</span> = (<span style="color: #6434A3;">low_high_t</span>*) buf;
    <span style="color: #0000FF;">for</span> (<span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">i</span> = 0; i &lt; nelmts; ++i)
    {
      <span style="color: #6434A3;">uint16_t</span> <span style="color: #BA36A5;">swap</span> = ptr[i].low;
      ptr[i].low = ptr[i].high;
      ptr[i].high = swap;
    }
    <span style="color: #0000FF;">break</span>;
  <span style="color: #0000FF;">case</span> H5T_CONV_FREE:
    printf(<span style="color: #008000;">"Finalizing conversion function...\n"</span>);
    <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">do non-trivial finalization here</span>
    <span style="color: #0000FF;">break</span>;
  <span style="color: #0000FF;">default</span>:
    <span style="color: #0000FF;">break</span>;
  }

  <span style="color: #0000FF;">return</span> retval;
}

<span style="color: #6434A3;">int</span> <span style="color: #006699;">main</span>()
{
  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">retval</span> = EXIT_SUCCESS;

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">in-memory bitfield datatype</span>
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">btfd</span> = H5T_NATIVE_B32;

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">compound of two unsigned shorts</span>
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">cmpd</span> = H5Tcreate(H5T_COMPOUND, 4);
  H5Tinsert(cmpd, <span style="color: #008000;">"low"</span>, 0, H5T_NATIVE_USHORT);
  H5Tinsert(cmpd, <span style="color: #008000;">"high"</span>, 2, H5T_NATIVE_USHORT);

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">register our conversion function w/ the HDF5 library</span>
  assert(H5Tregister(H5T_PERS_SOFT, <span style="color: #008000;">"bitfield-&gt;compound"</span>, btfd, cmpd,
                     &amp;bits2cmpd) &gt;= 0);
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">notice that the conversion function is its own inverse</span>
  assert(H5Tregister(H5T_PERS_SOFT, <span style="color: #008000;">"compound-&gt;bitfield"</span>, cmpd, btfd,
                     &amp;bits2cmpd) &gt;= 0);

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">sample data</span>
  <span style="color: #6434A3;">uint32_t</span> <span style="color: #BA36A5;">buf</span>[32];
  <span style="color: #0000FF;">for</span> (<span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">i</span> = 0; i &lt; 32; ++i)
  {
    buf[i] = 1 &lt;&lt; i;
    printf(<span style="color: #008000;">"%ud\n"</span>, buf[i]);
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">we could check the conversion in-memory, in-place</span>
  <span style="color: #8D8D84;">//</span><span style="color: #8D8D84; font-style: italic;">H5Tconvert(btfd, cmpd, 32, buf, NULL, H5P_DEFAULT);</span>

  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file</span> = H5Fcreate(<span style="color: #008000;">"cmpd.h5"</span>, H5F_ACC_TRUNC, H5P_DEFAULT, H5P_DEFAULT);
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">fspace</span> = H5Screate_simple(1, (<span style="color: #6434A3;">hsize_t</span>[]) {32}, <span style="color: #D0372D;">NULL</span>);
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dset</span> = H5Dcreate(file, <span style="color: #008000;">"shorties"</span>, cmpd, fspace,
                         H5P_DEFAULT, H5P_DEFAULT, H5P_DEFAULT);

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">the datatype conversion function will be invoked as part of H5Dwrite</span>
  H5Dwrite(dset, btfd, H5S_ALL, H5S_ALL, H5P_DEFAULT, (<span style="color: #6434A3;">void</span>*) buf);

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">the datatype conversion function will be invoked as part of H5Dread</span>
  H5Dread(dset, btfd, H5S_ALL, H5S_ALL, H5P_DEFAULT, (<span style="color: #6434A3;">void</span>*) buf);

  <span style="color: #0000FF;">for</span> (<span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">i</span> = 0; i &lt; 32; ++i)
    printf(<span style="color: #008000;">"%ud\n"</span>, buf[i]);

  H5Dclose(dset);
  H5Sclose(fspace);
  H5Fclose(file);

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">housekeeping</span>
  assert(H5Tunregister(H5T_PERS_SOFT, <span style="color: #008000;">"compound-&gt;bitfield"</span>, cmpd, btfd,
                     &amp;bits2cmpd) &gt;= 0);
  assert(H5Tunregister(H5T_PERS_SOFT, <span style="color: #008000;">"bitfield-&gt;compound"</span>, btfd, cmpd,
                     &amp;bits2cmpd) &gt;= 0);

  H5Tclose(cmpd);

  <span style="color: #0000FF;">return</span> retval;
}
</pre>
</div></li>
<li>Datatype conversions do what it says on the tin and sometimes are just what
you need</li>
<li>Don't confuse them with <i>filters</i>!
<ul class="org-ul">
<li>With <a href="https://github.com/lucasvr/hdf5-udf">HDF5-UDF</a> it is possible to implement datatype conversions via filters,
but at the expense of additional datasets</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org5dcfc42" class="outline-2">
<h2 id="org5dcfc42">Clinic 2022-07-05</h2>
<div class="outline-text-2" id="text-org5dcfc42">
</div>
<div id="outline-container-org18d9bae" class="outline-3">
<h3 id="org18d9bae">Your questions</h3>
<div class="outline-text-3" id="text-org18d9bae">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-orgc75180b" class="outline-3">
<h3 id="orgc75180b">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgc75180b">
</div>
<ul class="org-ul">
<li><a id="org5ef6eab"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgfe7f9aa"></a><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-2-release/9796">VFD SWMR beta 2 release</a><br />
<div class="outline-text-5" id="text-orgfe7f9aa">
<ul class="org-ul">
<li>Testers wanted</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org52e93d7"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgfbc6266"></a><a href="https://forum.hdfgroup.org/t/hdf5-1-10-1-12-dramatic-drop-of-performance-vs-1-8/9896">HDF5 1.10, 1.12 dramatic drop of performance vs 1.8</a><br />
<div class="outline-text-5" id="text-orgfbc6266">
<ul class="org-ul">
<li>Recap: <code>h5open_f/h5close_f</code> overhead, chunk size 1 issue&#x2026;</li>
<li><p>
User provided a nice table
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right"><b>chunk size</b></th>
<th scope="col" class="org-right"><b>data</b> (bytes)</th>
<th scope="col" class="org-right"><b>metadata</b> (bytes)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">120000</td>
<td class="org-right">1128952</td>
</tr>

<tr>
<td class="org-right">50</td>
<td class="org-right">120000</td>
<td class="org-right">26456</td>
</tr>

<tr>
<td class="org-right">2048</td>
<td class="org-right">122880</td>
<td class="org-right">3400</td>
</tr>

<tr>
<td class="org-right">131072</td>
<td class="org-right">524288</td>
<td class="org-right">3400</td>
</tr>
</tbody>
</table></li>
<li>No compression</li>
<li>Steven Varga suggested that
<ol class="org-ol">
<li>The application might benefit from a dedicated I/O handler, and he provided
a multithreaded queue example</li>
<li>Data generationn can be decoupled from recording via ZeroMQ, and he
provided an example with the generator (sender) in Fortran and the recorder
(receiver) in C</li>
</ol></li>
</ul>
</div>
</li>
<li><a id="org5bb443d"></a>Issue w/ <a href="https://forum.hdfgroup.org/t/memory-backed-files/9878">memory backed files</a><br />
<div class="outline-text-5" id="text-org5bb443d">
<ul class="org-ul">
<li>We are able to reproduce the issue!</li>
<li>Slowdown in <code>H5Oget_info</code> because of <code>H5O_INFO_ALL</code> option</li>
<li>The difference between the in-file and in-memory image sizes can be explained
by incremental (re-)allocation in the core VFD</li>
<li><p>
The real issue is this:
</p>
<pre class="example" id="org7abc831">
HDF5-DIAG: Error detected in HDF5 (1.13.2-1) thread 0:
#000: H5F.c line 837 in H5Fopen(): unable to synchronously open file
  major: File accessibility
  minor: Unable to open file
#001: H5F.c line 797 in H5F__open_api_common(): unable to open file
  major: File accessibility
  minor: Unable to open file
#002: H5VLcallback.c line 3686 in H5VL_file_open(): open failed
  major: Virtual Object Layer
  minor: Can't open object
#003: H5VLcallback.c line 3498 in H5VL__file_open(): open failed
  major: Virtual Object Layer
  minor: Can't open object
#004: H5VLnative_file.c line 128 in H5VL__native_file_open(): unable to open file
  major: File accessibility
  minor: Unable to open file
#005: H5Fint.c line 1964 in H5F_open(): unable to read superblock
  major: File accessibility
  minor: Read failed
#006: H5Fsuper.c line 450 in H5F__super_read(): unable to load superblock
  major: File accessibility
  minor: Unable to protect metadata
#007: H5AC.c line 1396 in H5AC_protect(): H5C_protect() failed
  major: Object cache
  minor: Unable to protect metadata
#008: H5C.c line 2368 in H5C_protect(): can't load entry
  major: Object cache
  minor: Unable to load metadata into cache
#009: H5C.c line 7315 in H5C__load_entry(): incorrect metadata checksum after all read attempts
  major: Object cache
  minor: Read failed
</pre></li>
<li>It appears that the superblock checksum (in versions 2, 3) is not correctly
set or updated</li>
<li>Maybe this is a corner case of the use of HDF5 file image w/ core VFD?
Investigating&#x2026;</li>
</ul>
</div>
</li>
<li><a id="orga1a089b"></a><a href="https://forum.hdfgroup.org/t/authenticated-aws-s3/9924">Authenticated AWS S3</a><br />
<div class="outline-text-5" id="text-orga1a089b">
<ul class="org-ul">
<li>Use of the read-only S3 VFD w/ Python?</li>
</ul>
<blockquote>
<p>
The ros3 driver is very slick. It works great for public h5 files.
</p>

<p>
I am trying to perform a read of an H5 file using ros3 that requires
authentication credentials.  I have been successful in using h5ls/h5dump in
accessing an h5 file against an authenticated AWS S3 call using &#x2013;vfd=ros3 and
&#x2013;s3-cred=(&lt;region,&lt;key<sub>id</sub>&gt;,&lt;key<sub>secret</sub>&gt;).
</p>

<p>
However, I cannot get this to work with h5py.
</p>
</blockquote>
<ul class="org-ul">
<li>The user answered his on question, <code>h5py</code> does support this VFD and AWS
credentials as documented <a href="https://docs.h5py.org/en/stable/high/file.html#file-drivers">here</a></li>
<li>He also commented that this is not limited to AWS S3, but also works with
other S3-compatible storage options</li>
<li>And he's looking for <a href="https://forum.hdfgroup.org/t/hsds-on-google-cloud-platform/9925">HSDS on GCP (Google Cloud)</a></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orgdea318d" class="outline-3">
<h3 id="orgdea318d">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orgdea318d">
</div>
<ul class="org-ul">
<li><a id="orgb05f1b7"></a>What others are doing with HDF5<br />
<div class="outline-text-4" id="text-orgb05f1b7">
<ul class="org-ul">
<li>Subscribe for alerts on <a href="https://scholar.google.com/">Google Scholar</a>
<dl class="org-dl">
<dt>Alert query</dt><dd><code>hdf5</code></dd>
<dt>Email</dt><dd>&#x2026;</dd>
<dt>Type</dt><dd>Most relevant results</dd>
</dl></li>
<li>You will get 2-4 emails a week with about 6-10 citations</li>
</ul>
</div>
<ul class="org-ul">
<li><a id="orgd8f4c43"></a>Recent highlights<br />
<div class="outline-text-5" id="text-orgd8f4c43">
<ul class="org-ul">
<li><a href="https://www.osti.gov/biblio/1867160">Fission Matrix Processing Using the MCNP6.3 HDF5 Restart File</a>
<ul class="org-ul">
<li>See the Wikipedia article for <a href="https://en.wikipedia.org/wiki/Monte_Carlo_N-Particle_Transport_Code#:~:text=Monte%20Carlo%20N%2DParticle%20Transport%20(MCNP)%20is%20a%20general,by%20Los%20Alamos%20National%20Laboratory.">Monte Carlo N-Particle Transport Code</a></li>
</ul></li>
<li><p>
<a href="https://sdm.lbl.gov/~sbyna/research/papers/2022/2022-FAST-WIP-Posters-ProvIO-Abstract.pdf">Towards A Practical Provenance Framework for Scientific Data on HPC Systems</a>
</p>
<blockquote>
<p>
So we derive an I/O-centric provenance model, which enriches the W3C PROV
standard with a variety of concrete sub-classes to describe both the data
and the associated I/O operations and execution environments precisely with
extensibility.
</p>

<p>
Moreover, based on the unique provenance model, we are building a practical
prototype which includes three major components: (1) Provenance Tracking for
capturing diverse I/O operations; (2) Provenance Storage for persisting the
captured provenance information as standard RDF triples; (3) User Engine
for querying and visualizing provenance.
</p>
</blockquote></li>
<li><p>
<a href="http://www.cs.iit.edu/~scs/assets/files/stimulus2022.pdf">Stimulus: Accelerate Data Management for Scientific AI applications in HPC</a>
</p>
<blockquote>
<p>
&#x2026; a lack of support for scientific data formats in AI frameworks.  We need a
cohesive mechanism to effectively integrate at scale complex scientific data
formats such as HDF5, PnetCDF, ADIOS2, GNCF, and Silo into popular AI
frameworks such as TensorFlow, PyTorch, and Caffe. To this end, we designed
Stimulus, a data management library for ingesting scientific data effectively
into the popular AI frameworks.  We utilize the StimOps functions along with
StimPack abstraction to enable the integration of scientific data formats
with any AI framework. The evaluations show that Stimulus outperforms several
large-scale applications with different use-cases such as Cosmic Tagger
(consuming HDF5 dataset in PyTorch), Distributed FFN (consuming HDF5 dataset
in TensorFlow), and CosmoFlow (converting HDF5 into TFRecord and then
consuming that in TensorFlow) by 5.3x, 2.9x, and 1.9x respectively with ideal
I/O scalability up to 768 GPUs on the Summit supercomputer. Through Stimulus,
we can portably extend existing popular AI frameworks to cohesively support
any complex scientific data format and efficiently scale the applications on
large-scale supercomputers.
</p>
</blockquote></li>
<li><p>
<a href="https://meetingorganizer.copernicus.org/EGU22/EGU22-11201.html">DIARITSup: a framework to supervise live measurements, Digital Twins modelscomputations and predictions for structures monitoring.</a>
</p>
<blockquote>
<p>
DIARITSup is a chain of various softwares following the concept of system of
systems. It interconnects hardware and software layers dedicated to in-situ
monitoring of structures or critical components. It embeds data assimilation
capabilities combined with specific Physical or Statistical models like
inverse thermal and/or mechanical ones up to the predictive ones. It aims at
extracting and providing key parameters of interest for decision making
tools. Its framework natively integrates data collection from local sources
but also from external systems. DIARITSup is a milestone in our roadmap
for SHM Digital Twins research framework. Furthermore, it intends providing
some useful information for maintenance operations not only for surveyed
targets but also for deployed sensors.
</p>

<p>
Meanwhile, a recorder manage the recording of all data and metadata in the
Hierarchical Data Format (HDF5). HDF5 is used to its full potential with its
Single-Writer-Multiple-Readers feature that enables a graphical user interface
to represent the saved data in real-time, or the live computation of SHM
Digital Twins models for example. Furthermore, the flexibility of HDF5 data
storage allows the recording of various type of sensors such as punctual
sensors or full field ones.
</p>
</blockquote></li>
<li>It's impossible to keep up, but always a great source of inspiration!</li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="orgcf91a07"></a>Next time: datatype conversions<br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgcdd789e" class="outline-2">
<h2 id="orgcdd789e">Clinic 2022-06-27</h2>
<div class="outline-text-2" id="text-orgcdd789e">
</div>
<div id="outline-container-orgec49c5a" class="outline-3">
<h3 id="orgec49c5a">Your questions</h3>
<div class="outline-text-3" id="text-orgec49c5a">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-orgddbdd8a" class="outline-3">
<h3 id="orgddbdd8a">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgddbdd8a">
</div>
<ul class="org-ul">
<li><a id="orga8defd6"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org7f98ef8"></a><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-2-release/9796">VFD SWMR beta 2 release</a><br />
<div class="outline-text-5" id="text-org7f98ef8">
<ul class="org-ul">
<li>Testers wanted</li>
</ul>
</div>
</li>
<li><a id="org3858ec8"></a><a href="https://www.hdfgroup.org/2022/06/2022-hdf5-release-schedule/">2022 HDF5 Release Schedule</a> announced<br />
<div class="outline-text-5" id="text-org3858ec8">

<div id="orgc6b9de3" class="figure">
<p><img src="./img/release-schedule.png" alt="release-schedule.png" />
</p>
</div>
<ul class="org-ul">
<li>HDF5 1.8.x and 1.12.x are coming to an end (1.8.23, 1.12.3)</li>
<li>HDF5 1.10.x and 1.14.x are here to stay for a while
<ul class="org-ul">
<li>Performance work over the Summer</li>
<li>HDF5 1.13.2: Selection I/O, VFD SWMR, Onion VFD (late July/early August)</li>
<li>HDF5 1.13.3: Multi-dataset I/O, Subfiling (late September/early October)</li>
<li>HDF5 1.14.0 in late December/early January</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org64b40c9"></a>We are hiring<br />
<div class="outline-text-5" id="text-org64b40c9">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/director-of-software-engineering-the-hdf-group/9892">Director of Software Engineering</a></li>
<li><a href="https://forum.hdfgroup.org/t/chief-hdf5-software-architect-the-hdf-group/9893">Chief HDF5 Software Architect</a></li>
<li>Interested in working for The HDF Group? <a href="mailto:jobs@hdfgroup.org"><i>Send us your resume!</i></a></li>
</ul>
</div>
</li>
<li><a id="orga518bce"></a><a href="https://www.hdfgroup.org/2022/06/speed-up-cloud-access-using-multiprocessing/">Speed up cloud access using multiprocessing!</a> by John Readey (Mr. HSDS)<br />
<div class="outline-text-5" id="text-orga518bce">
<blockquote>
<p>
Each file is slightly more than 1 TB in size, so downloading the entire
collection would take around a month with a 80 Mbit/s connection. Instead, lets
suppose we need to retrieve the data for just one location index, but for the
entire time range 2007-2014. How long will this take?
</p>
</blockquote>
</div>
</li>
</ul>
</li>

<li><a id="org4a31224"></a>Forum<br />
<ul class="org-ul">
<li><a id="org13b2c03"></a><a href="https://forum.hdfgroup.org/t/how-efficient-is-hdf5-for-data-retrieval-as-opposed-to-data-storage/6362">How efficient is HDF5 for data retrieval as opposed to data storage?</a><br />
<div class="outline-text-5" id="text-org13b2c03">
<blockquote>
<p>
I would like to a keyed 500GB table into HDF5, and then then retrieve rows
matching specific keys.
</p>

<p>
For an HDF5 file, items like all the data access uses an integer row number,
so seems like I would have to implement a 'key to row number map" outside of
HDF5.
</p>

<p>
Isnt retrieval more efficient with a distributed system like Spark which uses
HDFS?
</p>
</blockquote>

<ul class="org-ul">
<li>Too open-ended question w/o additional context</li>
<li>There are no querying or indexing capabilities built into HDF5</li>
<li>Can something like this be implemented on top of HDF5? It's been done many
times, <i>for specific requirements.</i></li>
<li>Are other tools more efficient? Maybe. Maybe not.</li>
</ul>
</div>
</li>

<li><a id="orgb29d168"></a><a href="https://forum.hdfgroup.org/t/hdf5-1-10-1-12-dramatic-drop-of-performance-vs-1-8/9896">HDF5 1.10, 1.12 dramatic drop of performance vs 1.8</a><br />
<div class="outline-text-5" id="text-orgb29d168">
<ul class="org-ul">
<li><p>
Profiling (<a href="https://github.com/gperftools/gperftools">gperftools</a>) revealed
</p>
<blockquote>
<p>
85% of the time is spent in <code>H5Fget_obj_count</code>.
</p>
</blockquote></li>
<li>The user correctly inferred that this is related to frequent
<code>h5open_f/h5close_f</code>, and <a href="https://forum.hdfgroup.org/t/h5f-get-obj-count-f-extremely-buggy/9678">an issue</a> we covered in the past
<ul class="org-ul">
<li>Bug in <code>h5f_get_obj_count_f</code> &amp; fixed in <a href="https://github.com/HDFGroup/hdf5/pull/1657">PR#1657</a> by Scot.</li>
</ul></li>
<li>After applying that fix performance is on par w/ 1.8</li>
<li><p>
Happy ending! (almost)
</p>
<pre class="example" id="org2aa8c4e">
h5stat output:

...
Summary of file space information:
File metadata: 1201344 bytes
Raw data: 99260 bytes
Amount/Percent of tracked free space: 0 bytes/0.0%
Unaccounted space: 17392 bytes
Total space: 1317996 bytes
</pre>
<ul class="org-ul">
<li>Greater than 1:10 data to metadata ratio
<ul class="org-ul">
<li>Usually means trouble</li>
</ul></li>
<li>Culprit: chunk size of 1</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="org816d338"></a>Issue w/ <a href="https://forum.hdfgroup.org/t/memory-backed-files/9878">memory backed files</a><br />
<div class="outline-text-5" id="text-org816d338">
<ul class="org-ul">
<li>Still puzzled</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org600cc25" class="outline-3">
<h3 id="org600cc25">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org600cc25">
</div>
<ul class="org-ul">
<li><a id="org73aaf4b"></a>SWMR (old) and compression "issues" - take 2<br />
<div class="outline-text-4" id="text-org73aaf4b">
<ul class="org-ul">
<li>Free-space managment is disabled in the original SWMR implementation</li>
<li>Can lead to file bloat when compression is enabled &amp; overly aggressive
flushing</li>
<li><b><b>Question:</b></b> How does the new SWMR VFD implementation behave?
<ul class="org-ul">
<li>Untested, but should work in principle</li>
</ul></li>
<li>There is an updated <a href="https://github.com/HDFGroup/hdf5/blob/feature/vfd_swmr/doc/VFD_SWMR_RFC_200916.pdf">VFD SWMR RFC</a></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgcab5ef6" class="outline-2">
<h2 id="orgcab5ef6">Clinic 2022-06-21</h2>
<div class="outline-text-2" id="text-orgcab5ef6">
</div>
<div id="outline-container-org4f2a4bc" class="outline-3">
<h3 id="org4f2a4bc">Your questions</h3>
<div class="outline-text-3" id="text-org4f2a4bc">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-org03ee83e" class="outline-3">
<h3 id="org03ee83e">Last week's highlights</h3>
<div class="outline-text-3" id="text-org03ee83e">
</div>
<ul class="org-ul">
<li><a id="org9c02b49"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgf1397ee"></a><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-2-release/9796">VFD SWMR beta 2 release</a><br />
<div class="outline-text-5" id="text-orgf1397ee">
<ul class="org-ul">
<li>Testers wanted</li>
</ul>
</div>
</li>
<li><a id="orged516fb"></a><a href="https://forum.hdfgroup.org/t/release-of-hdfview-3-1-4-newsletter-186-the-hdf-group/9874">HDFView 3.1.4 released</a><br />
<div class="outline-text-5" id="text-orged516fb">
<ul class="org-ul">
<li>Some confusion around versioning
<ul class="org-ul">
<li>HDFView 3.2.x series is based on the HDF5 1.12.x releases.</li>
<li>HDFView 3.1.x series is based on the HDF5 1.10.x releases.</li>
<li>HDFView 3.3.x series will be based on the future 1.14.x releases.</li>
</ul></li>
<li>Known issue in 3.2.0: HDFView crashes on an attribute of VLEN of REFERENCE</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="orgcd11f71"></a>Forum<br />
<ul class="org-ul">
<li><a id="org6c7d30a"></a><a href="https://forum.hdfgroup.org/t/check-if-two-identifiers-refer-to-the-same-object/7160">Check if two identifiers refer to the same object</a><br />
<div class="outline-text-5" id="text-org6c7d30a">
<ul class="org-ul">
<li><a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_i.html"><code>H5I</code></a> module</li>
<li>Identifiers are transient</li>
<li>Pre-defined and user-defined identifier types</li>
<li>Pre-defined IDs identify HDF5 objects but also VFL and VOL plugins, etc.
<ul class="org-ul">
<li>See <a href="https://docs.hdfgroup.org/hdf5/develop/_h5_ipublic_8h.html#a13afe14178faf81b89fa2167e7ab832b"><code>H5I_type_t</code></a></li>
</ul></li>
<li><a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_i_u_d.html">User-defined ID</a> types must be first registered w/ the library before use
<ul class="org-ul">
<li><p>
Certain functions are only available for user-defined IDs
</p>
<pre class="example" id="org7b0e8e9">
[1] H5Iobject_verify: Object atom/Unable to find ID group information
    cannot call public function on library type
</pre></li>
</ul></li>
<li>Assuming pre-defined HDF5 IDs for objects, use <a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_o.html#title4"><code>H5Oget_info</code></a> to retrieve a
structure that contains an address or token which can then be compared</li>
</ul>
</div>
</li>
<li><a id="org86c1883"></a>Issue w/ <a href="https://forum.hdfgroup.org/t/memory-backed-files/9878">memory backed files</a><br />
<div class="outline-text-5" id="text-org86c1883">
<ul class="org-ul">
<li>Workflow:
<ol class="org-ol">
<li>Create a memory-backed file (w/ core VFD)</li>
<li>Make changes</li>
<li>Get a file image (in memory) and share w/ another process (shared mem. or
network)</li>
<li>Create another memory-backed file from this file image</li>
</ol></li>
<li>Should work just fine w/ <code>H5P[g,s]et_file_image</code></li>
</ul>
</div>
</li>
<li><a id="org1833fdf"></a><a href="https://forum.hdfgroup.org/t/multithread-writing-to-two-files/9850">Multithread Writing to two files</a><br />
<div class="outline-text-5" id="text-org1833fdf">
<ul class="org-ul">
<li>Some users don't know how to help themselves.</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org66d218f" class="outline-3">
<h3 id="org66d218f">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org66d218f">
</div>
<ul class="org-ul">
<li><a id="org9ba7973"></a>SWMR (old) and compression "issues"<br />
<div class="outline-text-4" id="text-org9ba7973">
<ul class="org-ul">
<li>Reports:
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/bug-compression-doesnt-compress-data-on-swmr/5280">Compression doesnt compress data on SWMR</a></li>
<li><a href="https://forum.hdfgroup.org/t/swmr-with-compression-fails-to-compress/8428">SWMR with Compression Fails to Compress</a></li>
</ul></li>
<li>Elena answered in both cases</li>
<li><i>It's not a bug but a "feature"</i></li>
<li>File space recycling is disabled in SWMR mode</li>
<li>Every time a dataset chunk is flushed, new space is allocated in the file</li>
<li>How to alleviate?
<ul class="org-ul">
<li>Keep the chunk in cache &amp; flush only once it's baked</li>
<li>Don't compress edge chunks</li>
</ul></li>
<li><b>Bigger picture:</b> We need a <span class="underline">feature (in-)compatibility matrix</span>! Long overdue!</li>
<li>Question: How does the new SWMR implementation behave?</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org364ec52" class="outline-2">
<h2 id="org364ec52">Clinic 2022-06-14</h2>
<div class="outline-text-2" id="text-org364ec52">
</div>
<div id="outline-container-orgbe8f2b4" class="outline-3">
<h3 id="orgbe8f2b4">Your questions</h3>
<div class="outline-text-3" id="text-orgbe8f2b4">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-orgcb6618d" class="outline-3">
<h3 id="orgcb6618d">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgcb6618d">
</div>
<ul class="org-ul">
<li><a id="orgbab976e"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgdba43fa"></a><a href="https://forum.hdfgroup.org/t/hermes-0-7-0-beta-release/9853">Hermes 0.7.0-beta release</a><br />
<div class="outline-text-5" id="text-orgdba43fa">
<ul class="org-ul">
<li>Bug fixes</li>
<li><a href="https://developers.google.com/optimization">Google OR tools</a> replaced by <a href="https://www.gnu.org/software/glpk/">GLPK</a></li>
</ul>
</div>
</li>
<li><a id="orge6e22cf"></a><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-2-release/9796">VFD SWMR beta 2 release</a><br />
<div class="outline-text-5" id="text-orge6e22cf">
<ul class="org-ul">
<li>Testers wanted</li>
</ul>
</div>
</li>
<li><a id="orgd9d7710"></a>HUG 2022 Europe videos available<br />
<div class="outline-text-5" id="text-orgd9d7710">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/hug/europeanhug22/agenda/">Agenda</a> and <a href="https://youtube.com/playlist?list=PLPyhR4PdEeGbKtlUy2yLe6OPhj_iGHP1Y">YouTube playlist</a></li>
<li>Thanks to Lori Cooper</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="orgd75a644"></a>Forum<br />
<ul class="org-ul">
<li><a id="org9c97239"></a><a href="https://forum.hdfgroup.org/t/multithread-writing-to-two-files/9850">Multithread Writing to two files</a><br />
<div class="outline-text-5" id="text-org9c97239">
<blockquote>
<p>
Reading Image data from single file and writing to two h5 files using
threads. Getting run time error doing this. What could be the reason ?
</p>
</blockquote>
<ul class="org-ul">
<li>It turns out the user is using high-level library (<code>hdf5_hl.h</code>) functions,
e.g., <a href="https://portal.hdfgroup.org/display/HDF5/H5IM_MAKE_IMAGE_24BIT"><code>H5IMmake_image_24bit</code></a></li>
<li>These functions are <b>not</b> thread-safe, even if the underlying HDF5 library
was built w/ thread-safety enabled</li>
<li><b>Workaround:</b> Use the thread-safe core library and follow the specification,
such as <a href="https://docs.hdfgroup.org/hdf5/develop/_i_m_g.html">HDF5 Image and Palette Specification Version 1.2</a></li>
</ul>
</div>
</li>
<li><a id="org82bfa8a"></a><a href="https://forum.hdfgroup.org/t/h5rdestroy-when-stored/9860"><code>H5Rdestroy</code> when stored</a><br />
<div class="outline-text-5" id="text-org82bfa8a">
<blockquote>
<p>
If a reference is stored as an attribute to an object, should <code>H5Rdestroy</code> still
be called?
</p>
</blockquote>
<ul class="org-ul">
<li>Yes</li>
</ul>
</div>
</li>
<li><a id="org0d7f5d9"></a><a href="https://forum.hdfgroup.org/t/fake-it-till-you-make-it-gans-with-hdf5/9857">Fake it till you make it: GANs with HDF5</a><br />
<div class="outline-text-5" id="text-org0d7f5d9">
<ul class="org-ul">
<li>Never the same HDF5 dataset (value) twice!</li>
<li>A clever combination of <a href="https://github.com/lucasvr/hdf5-udf">HDF5-UDF</a> and <a href="https://en.wikipedia.org/wiki/Generative_adversarial_network">generative adversarial networks (GAN)</a>
<ul class="org-ul">
<li>Competition between two neural networks a (synthetic-) data generator and a
discriminator</li>
</ul></li>
<li>TensorFlow Keras API supports <a href="https://www.tensorflow.org/guide/keras/save_and_serialize#keras_h5_format">storing trained model weights in HDF5 files</a></li>
<li>We can collocate the HDF5-UDF to synthesize data with the generator model
<ul class="org-ul">
<li>Reading from this dataset creates a new sample every time</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orgcfe2488" class="outline-3">
<h3 id="orgcfe2488">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orgcfe2488">
</div>
<ul class="org-ul">
<li><a id="org2398611"></a>HDF5 command-line tools and HDF5 path names w/ special characters<br />
<div class="outline-text-4" id="text-org2398611">
<ul class="org-ul">
<li>Example: <code>/equilibrium/time_slice[]&amp;profiles_2d[]&amp;theta_SHAPE</code></li>
<li>We have a problem!</li>
</ul>
</div>
<ul class="org-ul">
<li><a id="orga0c2c30"></a><code>h5ls</code><br />
<div class="outline-text-5" id="text-orga0c2c30">
<ul class="org-ul">
<li><p>
First try
</p>
<pre class="example" id="orgdada173">
gerd@penguin:~$ h5ls equilibrium.h5/equilibrium/time_slice[]&amp;profiles_2d[]&amp;theta_SHAPE
[2] 8959
[3] 8960
-bash: profiles_2d[]: command not found
-bash: theta_SHAPE: command not found
[3]+  Exit 127                profiles_2d[]
gerd@penguin:~$ time_slice[]**NOT FOUND** ^C
[2]+  Exit 1                  h5ls equilibrium.h5/equilibrium/time_slice[]
gerd@penguin:~$
</pre></li>
<li><p>
Double quotes to the rescue
</p>
<pre class="example" id="org77b6c65">
gerd@penguin:~$ h5ls "equilibrium.h5/equilibrium/time_slice[]&amp;profiles_2d[]&amp;theta_SHAPE"
time_slice[]&amp;profiles_2d[]&amp;theta_SHAPE Dataset {107/Inf, 3/Inf, 2/Inf}
</pre></li>
</ul>
</div>
</li>
<li><a id="org1599df9"></a><code>h5dump</code><br />
<div class="outline-text-5" id="text-org1599df9">
<ul class="org-ul">
<li><p>
First attempt
</p>
<pre class="example" id="org7e6a24e">
gerd@penguin:~$ h5dump -pH -d "/equilibrium/vacuum_toroidal_field&amp;b0" equilibrium.h5
HDF5 "equilibrium.h5" {
DATASET "/equilibrium/vacuum_toroidal_field&amp;b0" {
   DATATYPE  H5T_IEEE_F64LE
   DATASPACE  SIMPLE { ( 107 ) / ( H5S_UNLIMITED ) }
   STORAGE_LAYOUT {
      CHUNKED ( 107 )
      SIZE 656 (1.305:1 COMPRESSION)
   }
   FILTERS {
      COMPRESSION DEFLATE { LEVEL 1 }
   }
   FILLVALUE {
      FILL_TIME H5D_FILL_TIME_IFSET
      VALUE  -9e+40
   }
   ALLOCATION_TIME {
      H5D_ALLOC_TIME_INCR
   }
}
}
</pre></li>
<li><p>
Second attempt
</p>
<pre class="example" id="orgcef4a63">
gerd@penguin:~$ ~/packages/bin/h5dump -pH -d "/equilibrium/time_slice[]&amp;profiles_2d[]&amp;z_SHAPE" equilibrium.h5
HDF5 "equilibrium.h5" {h5dump error: unable to get link info from "/equilibrium/time_slice[]&amp;profiles_2d"}
</pre></li>
</ul>

<p>
<i>Not good.</i> Need to investigate.
</p>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org9994599" class="outline-2">
<h2 id="org9994599">Clinic 2022-06-07</h2>
<div class="outline-text-2" id="text-org9994599">
</div>
<div id="outline-container-orgb48a40d" class="outline-3">
<h3 id="orgb48a40d">Your questions</h3>
<div class="outline-text-3" id="text-orgb48a40d">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-org11c4186" class="outline-3">
<h3 id="org11c4186">Last week's highlights</h3>
<div class="outline-text-3" id="text-org11c4186">
</div>
<ul class="org-ul">
<li><a id="org65285c5"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org86d68ce"></a><a href="https://forum.hdfgroup.org/t/release-of-hdf5-1-10-9-newsletter-186/9808">Release of HDF5-1.10.9</a><br />
<div class="outline-text-5" id="text-org86d68ce">
<ul class="org-ul">
<li>Parallel compression improvements</li>
<li>Doxygen-based User Guide draft</li>
<li>HDF5 is now tested and supported on macOS 11.6 M1</li>
<li>VS 2015 will no longer be supported starting in 2023</li>
</ul>
</div>
</li>
<li><a id="orgda9f17b"></a><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-2-release/9796">VFD SWMR beta 2 release</a><br />
<div class="outline-text-5" id="text-orgda9f17b">
<ul class="org-ul">
<li>Testers wanted</li>
</ul>
</div>
</li>
<li><a id="org7ca289e"></a><a href="https://forum.hdfgroup.org/t/european-hdf5-user-group-hug-meeting-2022-the-hdf-group/9518">2022 European HDF5 Users Group</a><br />
<div class="outline-text-5" id="text-org7ca289e">
<ul class="org-ul">
<li>Was a HUGE success</li>
<li>Thanks to Lana Abadie of ITER, Andy Gotz of ESRF, and Lori Cooper of HDFG</li>
<li>Stay tuned for the presentation videos!
<ul class="org-ul">
<li>They will be posted on the <a href="https://www.youtube.com/channel/UCRhtsIZquL3r-zH-R-r9-tQ">YouTube channel</a></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="orgd0ac219"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgf6dbe68"></a><a href="https://forum.hdfgroup.org/t/make-hdfview-available-on-flathub-org/9476">Make HDFView available on Flathub.org</a><br />
<div class="outline-text-5" id="text-orgf6dbe68">
<ul class="org-ul">
<li><p>
There's been some <a href="https://github.com/t-chaik/flathub/tree/HDFView">progress</a>
</p>
<blockquote>
<p>
Mostly working except filesystem portal integration, which makes the entire
thing pretty useless for now, the code may need patching
</p>
</blockquote>
<ul class="org-ul">
<li>Not sure what that means</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org57b83cf"></a><a href="https://forum.hdfgroup.org/t/hdf5-write-perf-regular-api-vs-direct-chunk-on-uncompressed-dataset/9731">HDF5 write perf - Regular API vs Direct Chunk on uncompressed dataset</a><br />
<div class="outline-text-5" id="text-org57b83cf">
<ul class="org-ul">
<li>Samuel posted <code>pprof</code> <a href="https://forum.hdfgroup.org/t/hdf5-write-perf-regular-api-vs-direct-chunk-on-uncompressed-dataset/9731/27">profiles</a>
<ul class="org-ul">
<li>Need time to digest</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orgb0efef3" class="outline-3">
<h3 id="orgb0efef3">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orgb0efef3">
</div>
<ul class="org-ul">
<li><a id="org7edb883"></a>I can't create a compound datatype with XXX (too many) fields<br />
<div class="outline-text-4" id="text-org7edb883">
<ul class="org-ul">
<li><b>Cause:</b> size limitation of the datatype message</li>
<li><span class="underline">Possible solutions</span>:
<ol class="org-ol">
<li>Break up the compound type into multiple compound types</li>
<li>Use a group and make each field a dataset</li>
<li>Use an opaque type and store metadata to parse</li>
<li>Use multiple (extendible) 2D datasets
<ul class="org-ul">
<li>One dataset for each field datatype</li>
<li>Keep the field metadata (names, order) in attributes</li>
</ul></li>
</ol></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org6cdabbd" class="outline-2">
<h2 id="org6cdabbd">Clinic 2022-05-24</h2>
<div class="outline-text-2" id="text-org6cdabbd">
</div>
<div id="outline-container-org4089f93" class="outline-3">
<h3 id="org4089f93">Your questions</h3>
<div class="outline-text-3" id="text-org4089f93">
<dl class="org-dl">
<dt>Q</dt><dd>Element order preservation in point selections?</dd>
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-org6c92fd4" class="outline-3">
<h3 id="org6c92fd4">Last week's highlights</h3>
<div class="outline-text-3" id="text-org6c92fd4">
</div>
<ul class="org-ul">
<li><a id="orgb2b70be"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgf6a53d9"></a>2022 European HDF5 Users Group (HUGE)<br />
<div class="outline-text-5" id="text-orgf6a53d9">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/hug/europeanhug22/">Website</a></li>
<li><b>Registration for in-person attendance is now closed.</b></li>
<li>You can still register for online attendance. Please do!</li>
<li>May 31 - June 2, 2022</li>
<li>Face-to-face/online hybrid hosted at <a href="https://www.iter.org/">ITER</a> in Saint Paul-lez-Durance, France</li>
</ul>
</div>
</li>
<li><a id="org94016f3"></a><a href="https://forum.hdfgroup.org/t/hdf5-1-10-9-2-rc-1-source-available-for-testing/9779">HDF5 1.10.9-2-rc-1 source available for testing</a><br />
<div class="outline-text-5" id="text-org94016f3">
<ul class="org-ul">
<li>Parallel Compression improvements</li>
<li>First steps toward a Doxygen-based User Guide</li>
<li>HDF5 is now tested and supported on macOS 11.6 M1</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org1452790"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgc9b032f"></a><a href="https://forum.hdfgroup.org/t/survey-on-the-usage-of-self-describing-data-formats/9762">Survey on the usage of self-describing data formats</a><br /></li>
<li><a id="org5898c80"></a><a href="https://forum.hdfgroup.org/t/a-minor-step-towards-thread-concurrency/9767">A minor step towards thread concurrency</a><br />
<div class="outline-text-5" id="text-org5898c80">
<dl class="org-dl">
<dt>Idea</dt><dd>Drop the global lock (temporarily) whenever we are performing file I/O
<ul class="org-ul">
<li>Interesting idea, but devil's in the details (memory/file-hybrid state)</li>
</ul></dd>
</dl>
</div>
</li>
<li><a id="org0c83a96"></a><a href="https://forum.hdfgroup.org/t/make-hdfview-available-on-flathub-org/9476">Make HDFView available on</a> <a href="https://flathub.org/home"><code>flathub.org</code></a><br />
<div class="outline-text-5" id="text-org0c83a96">
<ul class="org-ul">
<li>Again, very interesting idea</li>
<li>How can we help?</li>
</ul>
</div>
</li>
<li><a id="orga1fbb15"></a><a href="https://forum.hdfgroup.org/t/vscode-extension-for-hdf5/9769">VSCode extension for HDF5</a><br />
<div class="outline-text-5" id="text-orga1fbb15">
<ul class="org-ul">
<li>Someone <a href="https://github.com/lochbrunner/vscode-hdf5-viewer">started it already</a>. Duh!</li>
<li>How "complete" is it? (What are the requirements?)
<ul class="org-ul">
<li>How can it be improved?</li>
</ul></li>
<li>We'll discuss this at HUG Europe 2022</li>
</ul>
</div>
</li>
<li><a id="org7a6e221"></a><a href="https://forum.hdfgroup.org/t/hdf5-write-perf-regular-api-vs-direct-chunk-on-uncompressed-dataset/9731">HDF5 write perf - Regular API vs Direct Chunk on uncompressed dataset</a><br />
<div class="outline-text-5" id="text-org7a6e221">
<ul class="org-ul">
<li><p>
Some good news: no performance regression from HDF5 1.8.22
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">-</th>
<th scope="col" class="org-right">direct chunk</th>
<th scope="col" class="org-right">hyperslab chunk</th>
<th scope="col" class="org-right">hyperslab contiguous</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">regular</td>
<td class="org-right">19.060877</td>
<td class="org-right">38.609770</td>
<td class="org-right">23.500788</td>
</tr>

<tr>
<td class="org-left">never fill</td>
<td class="org-right">19.578496</td>
<td class="org-right">19.223011</td>
<td class="org-right">24.316146</td>
</tr>

<tr>
<td class="org-left">latest fmt</td>
<td class="org-right">19.697542</td>
<td class="org-right">35.719180</td>
<td class="org-right">24.503973</td>
</tr>

<tr>
<td class="org-left">never fill + latest format</td>
<td class="org-right">19.084984</td>
<td class="org-right">18.970671</td>
<td class="org-right">24.817945</td>
</tr>
</tbody>
</table></li>
<li><p>
HDF5 1.12.1
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">-</th>
<th scope="col" class="org-right">direct chunk</th>
<th scope="col" class="org-right">hyperslab chunk</th>
<th scope="col" class="org-right">hyperslab contiguous</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">regular</td>
<td class="org-right">21.050749</td>
<td class="org-right">35.889814</td>
<td class="org-right">23.982538</td>
</tr>

<tr>
<td class="org-left">never fill</td>
<td class="org-right">18.917586</td>
<td class="org-right">20.929941</td>
<td class="org-right">23.291541</td>
</tr>

<tr>
<td class="org-left">latest fmt</td>
<td class="org-right">19.921759</td>
<td class="org-right">35.472971</td>
<td class="org-right">23.935622</td>
</tr>

<tr>
<td class="org-left">never fill + latest format</td>
<td class="org-right">19.646342</td>
<td class="org-right">19.800098</td>
<td class="org-right">24.406450</td>
</tr>
</tbody>
</table></li>
<li><span class="underline">Question remains</span>: Why is <code>hyperslab contiguous</code> consistently 25% slower than
the chunky versions?
<ul class="org-ul">
<li>Need to dig deeper
<ul class="org-ul">
<li>Read the code or &#x2026; (both)</li>
<li><a href="https://github.com/gperftools/gperftools">gperftools (<code>pprof</code>)</a> output visualized w/ <a href="https://kcachegrind.github.io/html/Home.html"><code>[q,k]cachegrind</code></a>
<img src="./img/KcgShot3Small.gif" alt="KcgShot3Small.gif" /></li>
</ul></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org6baf05f" class="outline-3">
<h3 id="org6baf05f">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org6baf05f">
</div>
<ul class="org-ul">
<li><a id="org4d4b38a"></a>Awkward arrays<br />
<div class="outline-text-4" id="text-org4d4b38a">
<ul class="org-ul">
<li><a href="https://awkward-array.org/quickstart.html">Project home</a></li>
<li><a href="https://www.youtube.com/watch?v=WlnUF3LRBj4">Awkward Array: Manipulating JSON-like Data with NumPy-like Idioms</a>
<ul class="org-ul">
<li>SciPy 2020 presentation by Jim Pivarski</li>
<li>Watch this!</li>
</ul></li>
<li><p>
How would you repesent something like this in HDF5? (Example from Jim's video)
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">import</span> awkward <span style="color: #0000FF;">as</span> ak
<span style="color: #BA36A5;">array</span> = ak.Array([
    [{<span style="color: #008000;">"x"</span>: 1,  <span style="color: #008000;">"y"</span>: [11]},
     {<span style="color: #008000;">"x"</span>: 4,  <span style="color: #008000;">"y"</span>: [12, 22]},
     {<span style="color: #008000;">"x"</span>: 9,  <span style="color: #008000;">"y"</span>: [13, 23, 33]}],
    [],
    [{<span style="color: #008000;">"x"</span>: 16, <span style="color: #008000;">"y"</span>: [14, 24, 34, 44]}]
])
</pre>
</div>
<ul class="org-ul">
<li>Compound? Meh! Empty or partial records? Variable-length sequences&#x2026; <code>=:-O</code></li>
<li>Columnar layout
<ul class="org-ul">
<li>Pick an iteration order</li>
<li>Put record fields into contiguous buffers</li>
<li><p>
Keep track list offsets
</p>
<pre class="example" id="orge2585f0">
outer offsets:  0,                     3,  3, 5
content for x:  1,  4,      9,            16
offsets for y:  0,  1,      3,             6,            10
content for y: 11, 12, 22, 13, 23, 33,    14, 24, 34, 44
</pre></li>
<li>A picture is worth a thousand words (screenshot from Jim's presentation)
<img src="./img/awkward.png" alt="awkward.png" />
<ul class="org-ul">
<li>See the HDF5 structure?
<ul class="org-ul">
<li>You can store both iteration orders, if that's what you need</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li><span class="underline">Food for thought</span>: Sometimes HDF5 is about finding balance between appearance
and performance</li>
<li>We will have a few HEP (High-Energy Physics)-themed presentations at HUG
Europe 2022
<ul class="org-ul">
<li>You have been warned <code>;-)</code></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgdb6a0b6" class="outline-2">
<h2 id="orgdb6a0b6">Clinic 2022-05-17</h2>
<div class="outline-text-2" id="text-orgdb6a0b6">
</div>
<div id="outline-container-org9bf3827" class="outline-3">
<h3 id="org9bf3827">Your questions</h3>
<div class="outline-text-3" id="text-org9bf3827">
<dl class="org-dl">
<dt>Q</dt><dd>Element order preservation in point selections?</dd>
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-org88578bd" class="outline-3">
<h3 id="org88578bd">Last week's highlights</h3>
<div class="outline-text-3" id="text-org88578bd">
</div>
<ul class="org-ul">
<li><a id="orgb6e6bfd"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orge4963da"></a>2022 European HDF5 Users Group (HUGE)<br />
<div class="outline-text-5" id="text-orge4963da">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/hug/europeanhug22/">Website</a></li>
<li><b>Registration for in-person attendance is now closed.</b></li>
<li>You can still register for online attendance. Please do!</li>
<li>May 31 - June 2, 2022</li>
<li>Face-to-face/online hybrid hosted at <a href="https://www.iter.org/">ITER</a> in Saint Paul-lez-Durance, France</li>
</ul>
</div>
</li>

<li><a id="org88f1a34"></a><a href="https://www.hdfgroup.org/2022/05/release-of-hdfview-3-2-0-newsletter-184/">Release of HDFView 3.2.0</a><br />
<div class="outline-text-5" id="text-org88f1a34">
<ul class="org-ul">
<li>SWMR support (configurable refresh timer)</li>
<li>Display and edit attribute data in table views, the same way as datasets</li>
<li>Read and display non-standard floating-point numbers</li>
</ul>
</div>
</li>
<li><a id="org6faf15a"></a><a href="https://www.hdfgroup.org/2022/05/hdf5-vol-status-report-exascale-computing-project/">HDF5 VOL Status Report  Exascale Computing Project</a><br />
<div class="outline-text-5" id="text-org6faf15a">
<ul class="org-ul">
<li>Includes early DAOS VOL connector performance numbers</li>
</ul>
</div>
</li>
<li><a id="org616d2f6"></a><a href="https://hdfgroup.us14.list-manage.com/track/click?u=1e990656e9cfaeda233d0858d&amp;id=ff720f0edb&amp;e=26e5bab6bd">HSDS Data Streaming Arrives</a><br />
<div class="outline-text-5" id="text-org616d2f6">
<ul class="org-ul">
<li>100 MB (configurable) cap on HTTP request size
<ul class="org-ul">
<li>Otherwise <code>413 - Payload Too Large</code> error</li>
<li>Increasing the <code>max_request_size</code> can help only if HSDS Docker container or
Kubernetes pod has sufficient RAM</li>
<li>Now what? <i>Streaming to the rescue!</i>
<ul class="org-ul">
<li>Let clients see bytes returning from the server while that is still
processing the tail chunks in the selection</li>
</ul></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org60d45e5"></a>Forum<br />
<ul class="org-ul">
<li><a id="orga97c7ad"></a><a href="https://forum.hdfgroup.org/t/hdf5-write-perf-regular-api-vs-direct-chunk-on-uncompressed-dataset/9731">HDF5 write perf - Regular API vs Direct Chunk on uncompressed dataset</a><br />
<div class="outline-text-5" id="text-orga97c7ad">
<ul class="org-ul">
<li>We provided a little <a href="https://dbkt.hdfgroup.org/original/2X/f/ff98069f1dbae5568a38855eac72be49a83a8593.c">test program</a> to eliminate as many layers as possible</li>
<li><p>
The user ran the tests and obtained these results (seconds via
<code>clock_gettime(CLOCK_PROCESS_CPUTIME_ID,.)</code>):
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">-</th>
<th scope="col" class="org-right">direct chunk</th>
<th scope="col" class="org-right">hyperslab chunk</th>
<th scope="col" class="org-right">hyperslab contiguous</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">regular</td>
<td class="org-right">1.631005</td>
<td class="org-right">3.368258</td>
<td class="org-right">2.069583</td>
</tr>

<tr>
<td class="org-left">never fill</td>
<td class="org-right">1.632858</td>
<td class="org-right">1.641345</td>
<td class="org-right">2.069205</td>
</tr>

<tr>
<td class="org-left">latest fmt</td>
<td class="org-right">1.643421</td>
<td class="org-right">3.233817</td>
<td class="org-right">2.068250</td>
</tr>

<tr>
<td class="org-left">never fill + latest format</td>
<td class="org-right">1.633859</td>
<td class="org-right">1.611976</td>
<td class="org-right">2.029573</td>
</tr>
</tbody>
</table></li>
<li>Why is <code>hyperslab contiguous</code> consistently 25% slower than the chunky versions?
<ul class="org-ul">
<li>Perhaps some extra buffer copying going on here??? TBD</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="orgfe75a9f"></a><a href="https://forum.hdfgroup.org/t/failures-with-insufficient-disk-space/9712">Failures with insufficient disk space</a><br />
<div class="outline-text-5" id="text-orgfe75a9f">
<ul class="org-ul">
<li>The HDF5 library state appears to be inconsistent after a disk-full error
(<code>ENOSPC</code>)
<ul class="org-ul">
<li>What's the state of a file in that situation? (Undefined)
<ul class="org-ul">
<li>Recovering to the last sane state is harder than it may seem, if not
impossible</li>
</ul></li>
<li>But things appear to be worse: The library crashes (assertion failure) on
shutdown
<ul class="org-ul">
<li>Open handle accounting is screwed up</li>
</ul></li>
</ul></li>
<li>See the reproducer in last week's notes!</li>
<li id="Update">It appears that the problem might be Windows-specific.
<ul class="org-ul">
<li>@Dana tried to reproduce the problem under Linux and couldn't</li>
<li>Nobody has come forward so far with a non-Windows error report</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="org71afc3d"></a><a href="https://forum.hdfgroup.org/t/corrupted-file-due-to-shutdown/9658">Corrupted file due to shutdown</a><br />
<div class="outline-text-5" id="text-org71afc3d">
<blockquote>
<p>
Thank you for all your help and all of the very useful pointers. I managed to
recover the data in the file. I did not get all the names of the datasets but
with the mentioned attribute i was able to reconstruct the data.
</p>

<p>
Thank you and all the best,
Christian
</p>
</blockquote>

<ul class="org-ul">
<li>Great!</li>
<li>A lost business opportunity <code>;-)</code>, but also a sign that skill, determination,
and documentation go a long way</li>
<li>Our way always was and will be: <span class="underline">Open-Source Software and Specifications</span></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orgda763fe" class="outline-3">
<h3 id="orgda763fe">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orgda763fe">
<p>
Next time&#x2026;
</p>
</div>
</div>
</div>

<div id="outline-container-org2ed3223" class="outline-2">
<h2 id="org2ed3223">Clinic 2022-05-10</h2>
<div class="outline-text-2" id="text-org2ed3223">
</div>
<div id="outline-container-orgae7ee8c" class="outline-3">
<h3 id="orgae7ee8c">Your questions</h3>
<div class="outline-text-3" id="text-orgae7ee8c">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-orge2ec4a4" class="outline-3">
<h3 id="orge2ec4a4">Last week's highlights</h3>
<div class="outline-text-3" id="text-orge2ec4a4">
</div>
<ul class="org-ul">
<li><a id="org0685309"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org00433f1"></a>2022 European HDF5 Users Group (HUGE)<br />
<div class="outline-text-5" id="text-org00433f1">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/hug/europeanhug22/">Website</a></li>
<li><b>Registration closes on Sunday May 15!</b></li>
<li>May 31 - June 2, 2022</li>
<li>Face-to-face at <a href="https://www.iter.org/">ITER</a> in Saint Paul-lez-Durance, France</li>
<li>Reserve your spot before telling your friends! <code>;-)</code></li>
</ul>
</div>
</li>

<li><a id="orgf41168c"></a><a href="https://forum.hdfgroup.org/t/hermes-0-6-0-beta-release/9704">Hermes 0.6.0-beta release</a><br />
<div class="outline-text-5" id="text-orgf41168c">
<ul class="org-ul">
<li>Highlight: Hermes HDF5 Virtual File Driver</li>
<li><a href="https://github.com/HDFGroup/hermes/tree/master/adapter/vfd">GitHub</a></li>
</ul>
</div>
</li>
<li><a id="orge9212f8"></a><a href="https://forum.hdfgroup.org/t/release-of-hdf5-1-12-2-newsletter-183/9702">HDF5 1.12.2 is out</a><br />
<div class="outline-text-5" id="text-orge9212f8">
<ul class="org-ul">
<li>Parallel compression improvements</li>
<li>Support for macOS Apple M1 11.6 Darwin 20.6.0 arm64 with Apple clang version 12.0.5.</li>
<li>The shortened versions of the long options (ex: <code>--datas</code> instead of
<code>--dataset</code>) have been removed from all the tools.</li>
</ul>
</div>
</li>
<li><a id="orge0d128a"></a><a href="https://forum.hdfgroup.org/t/sharing-experience-on-hdf5-vol-connectors-development-and-maintenance-public-talk/9749">Sharing Experience on HDF5 VOL Connectors Development and Maintenance</a><br />
<div class="outline-text-5" id="text-orge0d128a">
<ul class="org-ul">
<li>Wednesday, May 11, 1:00-2:00 PM ET</li>
<li>Part of the <a href="https://www.exascaleproject.org/event/ecp-community-bof-days-2022/">ECP 2022 Community BOF days</a></li>
<li><a href="https://exascaleproject.zoomgov.com/meeting/register/vJIsdOyvrjorHa4v2i8Chiza1GLF1W1yCzc">Open registration</a></li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="orgd9506b7"></a>Forum<br />
<ul class="org-ul">
<li><a id="org722aab0"></a><a href="https://forum.hdfgroup.org/t/select-mulptiple-hyperslabs-in-some-order/9706">Select mulptiple hyperslabs in some order</a><br />
<div class="outline-text-5" id="text-org722aab0">
<ul class="org-ul">
<li>(Hyperslab) Selections can be combined via set-theoretic operations (union,
intersection, &#x2026;)</li>
<li>There's an implicit (C or Fortran) ordering of the selected grid points, i.e.,
(within commutativity rules of set theory) the order of those operations
doesn't matter</li>
<li id="Q">What about point selections?</li>
</ul>
</div>
</li>
<li><a id="org3ef6f94"></a><a href="https://forum.hdfgroup.org/t/hdf5-vs-hf-file/9734"><code>hdf5</code> vs <code>hf</code> file</a><br />
<div class="outline-text-5" id="text-org3ef6f94">
<ul class="org-ul">
<li>Naming conventions (extensions) for HDF5 files</li>
<li>Technically, it doesn't matter</li>
<li>Tools, such as <a href="https://www.hdfgroup.org/downloads/hdfview/">HDFView</a>, use search filters, e.g., <code>*.h5</code> and <code>*.hdf5</code></li>
</ul>
</div>
</li>
<li><a id="org644ebcb"></a><a href="https://forum.hdfgroup.org/t/hdf5-write-perf-regular-api-vs-direct-chunk-on-uncompressed-dataset/9731">HDF5 write perf - Regular API vs Direct Chunk on uncompressed dataset</a><br />
<div class="outline-text-5" id="text-org644ebcb">
<ul class="org-ul">
<li><code>h5py</code> has <code>write_direct</code> and <code>write_direct_chunk</code>
<ul class="org-ul">
<li>About a 50% difference in performance. Why?</li>
</ul></li>
<li>What could slow down <code>H5Dwrite</code> (vs <code>H5Dwrite_chunk</code>) when having no data
conversion, no data scattering (contiguous layout), no chunking, no filters?</li>
</ul>
</div>
</li>
<li><a id="orgf401136"></a><a href="https://forum.hdfgroup.org/t/failures-with-insufficient-disk-space/9712">Failures with insufficient disk space</a><br />
<div class="outline-text-5" id="text-orgf401136">
<ul class="org-ul">
<li>The HDF5 library state appears to be inconsistent after a disk-full error
(<code>ENOSPC</code>)
<ul class="org-ul">
<li>What's the state of a file in that situation? (Undefined)
<ul class="org-ul">
<li>Recovering to the last sane state is harder than it may seem, if not
impossible</li>
</ul></li>
<li>But things appear to be worse: The library crashes (assertion failure) on
shutdown
<ul class="org-ul">
<li>Open handle accounting is screwed up</li>
</ul></li>
</ul></li>
<li><p>
Reproducer
</p>
<div class="org-src-container">
<pre class="src src-C">
<span style="color: #808080;">#include</span> <span style="color: #008000;">"hdf5.h"</span>

<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdint.h&gt;</span>
<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdlib.h&gt;</span>

<span style="color: #808080;">#define</span> <span style="color: #BA36A5;">SIZE</span> (1024 * 1024 * 128)

<span style="color: #6434A3;">int</span> <span style="color: #006699;">work</span>(<span style="color: #0000FF;">const</span> <span style="color: #6434A3;">char</span>* <span style="color: #BA36A5;">path</span>)
{
  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">retval</span> = EXIT_SUCCESS;

  <span style="color: #6434A3;">uint8_t</span>* <span style="color: #BA36A5;">data</span> = (<span style="color: #6434A3;">uint8_t</span>*) malloc(<span style="color: #0000FF;">sizeof</span>(uint8_t)*SIZE);

  <span style="color: #0000FF;">for</span> (<span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">i</span> = 0; i &lt; SIZE; ++i) {
    *(data+i) = i % 256;
  }

  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">fapl</span> = H5I_INVALID_HID;
  <span style="color: #0000FF;">if</span> ((fapl = H5Pcreate(H5P_FILE_ACCESS))
      == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_fapl</span>;
  }
  <span style="color: #0000FF;">if</span> (H5Pset_fclose_degree(fapl, H5F_CLOSE_STRONG) &lt; 0) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }

  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file</span> = H5I_INVALID_HID;
  <span style="color: #0000FF;">if</span> ((file = H5Fcreate(path, H5F_ACC_TRUNC, H5P_DEFAULT, fapl))
      == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }

  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">group</span> = H5I_INVALID_HID;
  <span style="color: #0000FF;">if</span> ((group = H5Gcreate(file, <span style="color: #008000;">"H5::Group"</span>, H5P_DEFAULT, H5P_DEFAULT,
                         H5P_DEFAULT)) == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_group</span>;
  }

  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">fspace</span> = H5I_INVALID_HID;
  <span style="color: #0000FF;">if</span> ((fspace = H5Screate_simple(1, (<span style="color: #6434A3;">hsize_t</span>[]) {(<span style="color: #6434A3;">hsize_t</span>) SIZE}, <span style="color: #D0372D;">NULL</span>))
      == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_fspace</span>;
  }

  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dset</span> = H5I_INVALID_HID;
  <span style="color: #0000FF;">if</span> ((dset = H5Dcreate(group, <span style="color: #008000;">"H5::Dataset"</span>, H5T_NATIVE_UINT8, fspace,
                        H5P_DEFAULT, H5P_DEFAULT, H5P_DEFAULT))
      == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dset</span>;
  }

  <span style="color: #0000FF;">if</span> (H5Dwrite(dset, H5T_NATIVE_UINT8, fspace, fspace, H5P_DEFAULT, data) &lt; 0) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_write</span>;
  }
  printf(<span style="color: #008000;">"Write successed.\n"</span>);

  <span style="color: #0000FF;">if</span> (H5Fflush(file, H5F_SCOPE_GLOBAL) &lt; 0) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_flush</span>;
  }
  printf(<span style="color: #008000;">"Flush succeeded.\n"</span>);

<span style="color: #D0372D;">fail_flush</span>:
<span style="color: #D0372D;">fail_write</span>:
  <span style="color: #0000FF;">if</span> (H5Dclose(dset) &lt; 0) {
    printf(<span style="color: #008000;">"H5Dclose failed.\n"</span>);
  }

<span style="color: #D0372D;">fail_dset</span>:
  <span style="color: #0000FF;">if</span> (H5Sclose(fspace) &lt; 0) {
    printf(<span style="color: #008000;">"H5Sclose failed.\n"</span>);
  }

<span style="color: #D0372D;">fail_fspace</span>:
  <span style="color: #0000FF;">if</span> (H5Gclose(group) &lt; 0) {
    printf(<span style="color: #008000;">"H5Gclose failed.\n"</span>);
  }

<span style="color: #D0372D;">fail_group</span>:
  <span style="color: #0000FF;">if</span> (H5Fclose(file) &lt; 0) {
    printf(<span style="color: #008000;">"H5Fclose failed.\n"</span>);
  }

<span style="color: #D0372D;">fail_file</span>:
  <span style="color: #0000FF;">if</span> (H5Pclose(fapl) &lt; 0) {
    printf(<span style="color: #008000;">"H5Pclose failed.\n"</span>);
  }

<span style="color: #D0372D;">fail_fapl</span>:
  <span style="color: #0000FF;">return</span> retval;
}

<span style="color: #6434A3;">int</span> <span style="color: #006699;">main</span>()
{
    <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">retval</span> = EXIT_SUCCESS;
    retval &amp;= work(<span style="color: #008000;">"O:/foo.h5"</span>); <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">limited available space to force failure</span>
    retval &amp;= work(<span style="color: #008000;">"D:/foo.h5"</span>); <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">lots of free space</span>
    <span style="color: #0000FF;">return</span> retval;
}

</pre>
</div></li>
</ul>
</div>
</li>

<li><a id="org826ea38"></a><a href="https://forum.hdfgroup.org/t/external-datasets-relative-to-current-directory-or-hdf5-file-as-documented/9742">External datasets relative to current directory or HDF5 file as documented?</a><br />
<div class="outline-text-5" id="text-org826ea38">
<ul class="org-ul">
<li>Documentation error: <i>Thanks to the user who reported it.</i></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org5482dcc" class="outline-3">
<h3 id="org5482dcc">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org5482dcc">
<p>
Next time&#x2026;
</p>
</div>
</div>
</div>

<div id="outline-container-org696d378" class="outline-2">
<h2 id="org696d378">Clinic 2022-04-26</h2>
<div class="outline-text-2" id="text-org696d378">
</div>
<div id="outline-container-org8110161" class="outline-3">
<h3 id="org8110161">Your questions</h3>
<div class="outline-text-3" id="text-org8110161">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-org3c95f9f" class="outline-3">
<h3 id="org3c95f9f">Last week's highlights</h3>
<div class="outline-text-3" id="text-org3c95f9f">
</div>
<ul class="org-ul">
<li><a id="orgdd63405"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org4ff5d89"></a>2022 European HDF5 Users Group (HUG)<br />
<div class="outline-text-5" id="text-org4ff5d89">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/hug/europeanhug22/">Website</a></li>
<li>May 31 - June 2, 2022</li>
<li>Face-to-face at <a href="https://www.iter.org/">ITER</a> in Saint Paul-lez-Durance, France</li>
<li>Reserve your spot before telling your friends! <code>;-)</code></li>
</ul>
</div>
</li>

<li><a id="org2b6e986"></a>HDF5 1.12.2 is around the corner<br />
<div class="outline-text-5" id="text-org2b6e986">
<ul class="org-ul">
<li>As early as this week</li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="orgc7094a0"></a>Forum<br />
<ul class="org-ul">
<li><a id="org21358a6"></a><a href="https://forum.hdfgroup.org/t/bug-h5tcopy-of-empty-enum/9634">Bug? H5TCopy of empty enum</a><br />
<div class="outline-text-5" id="text-org21358a6">
<ul class="org-ul">
<li>Is an empty enumeration datatype legit?</li>
<li>I couldn't find that ticket @Elena mentioned a while ago
<ul class="org-ul">
<li>Where is it?</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org7d6d635" class="outline-3">
<h3 id="org7d6d635">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org7d6d635">
</div>
<ul class="org-ul">
<li><a id="org4be19ac"></a><a href="https://github.com/HDFGroup/hdf5/issues/1682">Documentation - variable-length datatype description seems incomplete (doesn't mention global heap)</a><br />
<div class="outline-text-4" id="text-org4be19ac">
<ul class="org-ul">
<li><p>
Interesting GitHub issue
</p>
<blockquote>
<p>
I'm working on trying to decode an HDF5 file (attached) manually using the
specification (for the purpose of writing rust code for a decoder that quickly
extracts raw signal data from nanopore FAST5 files)&#x2026;
</p>
</blockquote></li>
<li>Tools of the trade <code>h5dump</code>, <code>h5debug</code>, <code>h5check</code></li>
<li>Highlights gaps/inaccuracies/inconveniences in the <a href="https://docs.hdfgroup.org/hdf5/develop/_f_m_t3.html">file format specification</a>
<ul class="org-ul">
<li>Bit-level representation of variable-length string datatypes
<ul class="org-ul">
<li>What's a <i>parent type</i>? (spec. doesn't say)</li>
<li>What's the parent type of a VLEN string? (character)</li>
<li>(How) Is it encoded in the datatype message?</li>
</ul></li>
<li>Use of the global heap for VLEN data
<ul class="org-ul">
<li>Not discussed where VLEN datatype message is discussed</li>
</ul></li>
</ul></li>
<li><p>
Sample
</p>
<pre class="example" id="orge5d6520">
HDF5 "perfect_guppy_3.6.0_LAST_gci_vs_Nb_mtDNA.fast5" {
GROUP "/" {
   ATTRIBUTE "file_version" {
      DATATYPE  H5T_STRING {
         STRSIZE H5T_VARIABLE;
         STRPAD H5T_STR_NULLTERM;
         CSET H5T_CSET_UTF8;
         CTYPE H5T_C_S1;
      }
      DATASPACE  SCALAR
      DATA {
      (0): "2.0"
      }
   }
   GROUP "read_44dcef85-283e-4782-b7b1-1c9a0f682597" {
      ATTRIBUTE "run_id" {
         DATATYPE  H5T_STRING {
            STRSIZE H5T_VARIABLE;
            STRPAD H5T_STR_NULLTERM;
            CSET H5T_CSET_ASCII;
            CTYPE H5T_C_S1;
         }
         DATASPACE  SCALAR
         DATA {
         (0): "cb45e5bda47a362d52bcfa146df9083b463bf65e"
         }
      }
...
</pre></li>
<li><code>2.0\0</code> is <code>322e 3000</code> in hex.
<ul class="org-ul">
<li>Let's find it!</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org1be06d0" class="outline-2">
<h2 id="org1be06d0">Clinic 2022-04-19</h2>
<div class="outline-text-2" id="text-org1be06d0">
</div>
<div id="outline-container-org2936165" class="outline-3">
<h3 id="org2936165">Your questions</h3>
<div class="outline-text-3" id="text-org2936165">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-org081cf0a" class="outline-3">
<h3 id="org081cf0a">Last week's highlights</h3>
<div class="outline-text-3" id="text-org081cf0a">
</div>
<ul class="org-ul">
<li><a id="org09d65a8"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orga092533"></a>2022 European HDF5 Users Group (HUG)<br />
<div class="outline-text-5" id="text-orga092533">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/hug/europeanhug22/">Website</a></li>
<li>May 31 - June 2, 2022</li>
<li>Face-to-face at <a href="https://www.iter.org/">ITER</a> in Saint Paul-lez-Durance, France</li>
<li>Reserve your spot before telling your friends! <code>;-)</code></li>
</ul>
</div>
</li>
<li><a id="org1627545"></a><a href="https://forum.hdfgroup.org/t/hdf5-1-12-2-3-rc-1-source-available-for-testing/9666">HDF5 1.12.2-3-rc-1 source available for testing</a><br />
<div class="outline-text-5" id="text-org1627545">
<ul class="org-ul">
<li>Parallel compression improvements backported from HDF5 1.13.1</li>
</ul>
</div>
</li>
<li><a id="org49cf452"></a>HSDS v0.7beta13<br />
<div class="outline-text-5" id="text-org49cf452">
<ul class="org-ul">
<li>Support for <a href="https://docs.h5py.org/en/stable/high/dataset.html?highlight=fancy#fancy-indexing">Fancy Indexing</a>
<ul class="org-ul">
<li>Unlike with h5py though, HSDS works well with long lists of indexes by
parallelizing access across the chunks in the selection.</li>
<li>For example, retrieving 4000 random columns from a 17,520 by 2,018,392
dataset demonstrated good scaling as the number of HSDS nodes was increased:
<ul class="org-ul">
<li>4 nodes: 65.4s</li>
<li>8 nodes: 35.7s</li>
<li>16 nodes: 23.4 s</li>
</ul></li>
</ul></li>
<li>The limit on the number of chunks accesses per request has been removed
<img src="./img/chunk_1000.png" alt="chunk_1000.png" /></li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="org6d7f9c4"></a>Forum<br />
<ul class="org-ul">
<li><a id="org729198f"></a><a href="https://forum.hdfgroup.org/t/help-request-regarding-java-3-3-2/9672">Help Request regarding Java 3.3.2</a><br />
<div class="outline-text-5" id="text-org729198f">
<ul class="org-ul">
<li>Switched from HDF Java 2.6.1 to 3.3.2 &amp; seeing errors not seen before</li>
<li>Artifact of checking for <a href="https://docs.hdfgroup.org/hdf5/develop/_i_m_g.html">HDF5 Image convention</a> attributes</li>
<li>Prior versions ignored exceptions silently <code>8-(</code></li>
<li>Now we have "expected errors"???</li>
</ul>
</div>
</li>
<li><a id="orge5785dc"></a><a href="https://forum.hdfgroup.org/t/h5f-get-obj-count-f-extremely-buggy/9678"><code>h5f_get_obj_count_f</code> Extremely Buggy?</a><br />
<div class="outline-text-5" id="text-orge5785dc">
<ul class="org-ul">
<li>User is trying to use <code>h5fget_obj_count_f</code> to establish the number of open
handles; it appears that the result depends on the number of times <code>h5open_f</code>
was called (???)</li>
<li>Calling <code>H5open</code> w/ the C-API is usually not necessary and multiple calls have
no side-effects</li>
<li><code>h5open_f</code> (Fortran API) appears to behave differently, <a href="https://jira.hdfgroup.org/browse/HDFFV-11306">buggy</a>?</li>
<li>Fixed by Scot Breitenfeld in <a href="https://github.com/HDFGroup/hdf5/pull/1657">HDFFV-11306 Fixed #1657</a>
<ul class="org-ul">
<li><i>What a turnaround!</i></li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org8c19e18"></a><a href="https://forum.hdfgroup.org/t/c-read-h5-cmpd-struct-dataset-that-each-field-is-vector/9677">C++ Read h5 cmpd (/struct) dataset that each field is vector</a><br />
<div class="outline-text-5" id="text-org8c19e18">
<ul class="org-ul">
<li><p>
User's data
</p>
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #0000FF;">typedef</span> <span style="color: #0000FF;">struct</span> { <span style="color: #D0372D;">std</span>::<span style="color: #6434A3;">vector</span> <span style="color: #BA36A5;">FieldA</span>, <span style="color: #BA36A5;">FieldB</span>, <span style="color: #BA36A5;">FieldC</span>; } <span style="color: #6434A3;">TestH5</span>;
TestH5.FieldA = {1.0,2.0,3.0,4.0}; <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">similar to FieldB, FieldC</span>
</pre>
</div></li>
<li id="Q">How to read this <code>TestH5</code> using C++?</li>
</ul>

<p>
This brings us to today's &#x2026;
</p>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org4ee229f" class="outline-3">
<h3 id="org4ee229f">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org4ee229f">
</div>
<ul class="org-ul">
<li><a id="orgd58fc4a"></a>How <a href="https://github.com/steven-varga/h5cpp">H5CPP</a> makes you ask the right questions<br />
<div class="outline-text-4" id="text-orgd58fc4a">
<p>
<i>(All quotations from Steven Varga's response!)</i>
</p>

<p>
The expression below is a [templated] Class datatype in C++, placed in a
non-contiguous memory location, requiring scatter-gather operators and a
mechanism to dis-assemble reassemble the components. Becuase of the complexity
AFAIK there is no automatic support for this sort of operation.
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #0000FF;">template</span> &lt;<span style="color: #0000FF;">typename</span> <span style="color: #6434A3;">T</span>&gt;
<span style="color: #0000FF;">struct</span> <span style="color: #6434A3;">TestH5</span>{
    <span style="color: #D0372D;">std</span>::<span style="color: #6434A3;">vector</span>&lt;<span style="color: #6434A3;">T</span>&gt; <span style="color: #BA36A5;">FieldA</span>, <span style="color: #BA36A5;">FieldB</span>, <span style="color: #BA36A5;">FieldC</span>;
};
</pre>
</div>

<p>
The structure above maybe modelled in HDF5 in the following way:
</p>

<ul class="org-ul">
<li>(Columnar) <code>/group/[fieldA, fieldB, fieldC]</code> fast indexing by columns, more
complex and slower indexing by rows; also easier read/write from
Julia/Python/R/C/ etc</li>
<li>(Records) by a vector of tuples: <code>std::vector&lt;std::tuple&lt;T,T,T&gt;&gt;</code> where you
work with a single dataset, fast indexing by rows and slower indexing by
columns</li>
<li>(Blocked) exotic custom solution based on direct chunk write/read: fast
indexing of blocks by row and column wise at the increased complexity of the
code.</li>
<li>(Hybrid) &#x2026;</li>
</ul>

<p>
H5CPP provides mechanism for the first two solutions:
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #6434A3;">TestH5</span>&lt;<span style="color: #6434A3;">int</span>&gt; <span style="color: #BA36A5;">data</span> = {<span style="color: #D0372D;">std</span>::<span style="color: #6434A3;">vector</span>&lt;<span style="color: #6434A3;">int</span>&gt;{1,2,3,4},
  <span style="color: #D0372D;">std</span>::<span style="color: #6434A3;">vector</span>&lt;<span style="color: #6434A3;">int</span>&gt;{5,6,7},
  <span style="color: #D0372D;">std</span>::<span style="color: #6434A3;">vector</span>&lt;<span style="color: #6434A3;">int</span>&gt;{8,9,10}};

<span style="color: #D0372D;">h5</span>::<span style="color: #6434A3;">fd_t</span> <span style="color: #BA36A5;">fd</span> = <span style="color: #D0372D;">h5</span>::create(<span style="color: #008000;">"example.h5"</span>,H5F_ACC_TRUNC);
<span style="color: #D0372D;">h5</span>::write(fd, <span style="color: #008000;">"/some_path/fieldA"</span>, data.fieldA);
<span style="color: #D0372D;">h5</span>::write(fd, <span style="color: #008000;">"/some_path/fieldB"</span>, data.fieldB);
<span style="color: #D0372D;">h5</span>::write(fd, <span style="color: #008000;">"/some_path/fieldC"</span>, data.fieldC);
</pre>
</div>

<p>
Ok the above is simple and well behaved, the second solution needs a POD struct
backing, as tuples are not supported in the current H5CPP version (the upcoming
will support arbitrary STL)
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #0000FF;">struct</span> <span style="color: #6434A3;">my_t</span> {
   <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">fieldA</span>;
   <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">fieldB</span>;
   <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">fieldC</span>;
}
</pre>
</div>

<p>
You can have any data types and arbitrary combination in the POD struct, as long
as it qualifies as POD type in C++. This approach involves H5CPP LLVM based
compiler assisted reflection  long word, I know; sorry about that. The bottom
line you need the type descriptor and this compiler does it for you, without
lifting a pinky.
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #D0372D;">std</span>::<span style="color: #6434A3;">vector</span>&lt;<span style="color: #6434A3;">my_t</span>&gt; <span style="color: #BA36A5;">data</span>;
<span style="color: #D0372D;">h5</span>::<span style="color: #6434A3;">fd_t</span> <span style="color: #BA36A5;">fd</span> = <span style="color: #D0372D;">h5</span>::create(<span style="color: #008000;">"example.h5"</span>,H5F_ACC_TRUNC);
<span style="color: #D0372D;">h5</span>::write(fd, <span style="color: #008000;">"some_path/some_name"</span>, data);
</pre>
</div>

<p>
This approach is often used in event recorders, hence there is this <code>h5::append</code>
operator to help you out:
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #D0372D;">h5</span>::<span style="color: #6434A3;">ds_t</span> <span style="color: #BA36A5;">ds</span> = <span style="color: #D0372D;">h5</span>::open(...);
<span style="color: #0000FF;">for</span>(<span style="color: #0000FF;">const</span> <span style="color: #0000FF;">auto</span>&amp; <span style="color: #BA36A5;">event</span>: event_provider)
  <span style="color: #D0372D;">h5</span>::append(ds, event);
</pre>
</div>

<p>
Both of the layouts are used to model sparse matrices, the second resembling COO
or coordinate of points, whereas the first is for Compressed Sparse Row|Column
format.
</p>

<p>
<a href="http://sandbox.h5cpp.org/presentations/">Slides are here</a>, the <a href="https://github.com/steven-varga/h5cpp/tree/master/examples">examples are here</a>.
</p>

<pre class="example" id="orgbbc204e">
best wishes: steve
</pre>

<p>
<span class="underline">Go on and read the rest of the thread</span>! There is a lot of good information there
(layouts, strings, array types, &#x2026;).
</p>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org6f95ca2" class="outline-2">
<h2 id="org6f95ca2">Clinic 2022-04-12</h2>
<div class="outline-text-2" id="text-org6f95ca2">
</div>
<div id="outline-container-orgbaed712" class="outline-3">
<h3 id="orgbaed712">Your questions</h3>
<div class="outline-text-3" id="text-orgbaed712">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-orgab5f131" class="outline-3">
<h3 id="orgab5f131">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgab5f131">
</div>
<ul class="org-ul">
<li><a id="orga7d9f61"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org8fcb705"></a>2022 European HDF5 Users Group (HUG)<br />
<div class="outline-text-5" id="text-org8fcb705">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/hug/europeanhug22/">Website</a></li>
<li>May 31 - June 2, 2022</li>
<li>Face-to-face at <a href="https://www.iter.org/">ITER</a> in Saint Paul-lez-Durance, France</li>
<li>Reserve your spot before telling your friends! <code>;-)</code></li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="orgc238401"></a>Forum<br />
<ul class="org-ul">
<li><a id="org17039c6"></a><a href="https://forum.hdfgroup.org/t/what-kind-of-stl-containers-do-you-use-in-your-field/9636">What kind of STL containers do you use in your field?</a><br />
<div class="outline-text-5" id="text-org17039c6">
<ul class="org-ul">
<li>Does anybody use the STL? <code>;-)</code></li>
</ul>
</div>
</li>
<li><a id="orgbdce9f7"></a><a href="https://forum.hdfgroup.org/t/bug-h5tcopy-of-empty-enum/9634">Bug? H5TCopy of empty enum</a><br />
<div class="outline-text-5" id="text-orgbdce9f7">
<ul class="org-ul">
<li>Looks like one</li>
</ul>
</div>
</li>
<li><a id="org45c5a9d"></a><a href="https://forum.hdfgroup.org/t/broken-hdf5-file-cannot-be-opened/9618">Broken HDF5 file cannot be opened</a><br />
<div class="outline-text-5" id="text-org45c5a9d">
<ul class="org-ul">
<li>Don't make a fuzz! <code>;-)</code></li>
<li>Cornering the HDF5 library by feeding it random byte sequences as attribute
and link names (or values)</li>
<li>Mission accomplished!
<img src="./img/fuzz.png" alt="fuzz.png" /></li>
</ul>
</div>
</li>
<li><a id="orgbb9ed55"></a><a href="https://forum.hdfgroup.org/t/automated-formatted-display-of-stl-like-containers/9641">Automated formatted display of STL-like containers</a><br />
<div class="outline-text-5" id="text-orgbb9ed55">
<pre class="example" id="org16216f7">
g++ -I./include -o pprint-test.o   -std=c++17 -DFMT_HEADER_ONLY -c pprint-test.cpp
g++ pprint-test.o -lhdf5  -lz -ldl -lm  -o pprint-test
./pprint-test


LISTS/VECTORS/SETS:
---------------------------------------------------------------------
array&lt;string,7&gt;:[xSs,wc,gu,Ssi,Sx,pzb,OY]
vector:[CDi,PUs,zpf,Hm,teO,XG,bu,QZs]
deque:[256,233,23,89,128,268,69,278,130]
list:[95,284,24,124,49,40,200,108,281,251,57, ...]
forward_list:[147,76,81,193,44]
set:[V,f,szy,v]
unordered_set:[2.59989,1.86124,2.93324,1.78615,2.43869,2.04857,1.69145]
multiset:[3,5,12,21,23,28,30,30]
unordered_multiset:[gZ,rb,Dt,Q,Ark,dW,Ez,wmE,GwF]


ADAPTORS:
---------------------------------------------------------------------
stack&lt;T,vector&lt;T&gt;&gt;:[172,252,181,11]
stack&lt;T,deque&lt;T&gt;&gt;:[54,278,66,70,230,44,121,15,58,149,224, ...]
stack&lt;T,list&lt;T&gt;&gt;:[251,82,278,86,66,40,278,45,211,225,271, ...]
priority_queue:[zdbUzd,tTknDw,qorxgk,mCcEay,gDeJ,FYPOEd,CIhMU]
queue&lt;T,deque&lt;T&gt;&gt;:[bVG,Bbs,vchuT,FfxEw,CXFrr,JAx,sVlcI]
queue&lt;T,list&lt;T&gt;&gt;:[ARPl,dddmHT,mEiCJ,OVEYS,FIJi,jbQwb,tpJnpj,rlCRoKn,nBKjJ,KPlU,jatsUI, ...]

ASSOCIATE CONTAINERS:
---------------------------------------------------------------------
map&lt;string,int&gt;:[{LID:2},{U:2},{Xr:1},{e:2},{esU:1},{kbj:1},{qFc:3}]
map&lt;short,list&lt;string&gt;&gt;:[{LjwUkey:5},{jZxhk:6},{sxKKVu:8},{vSmHmu:8},{wRBTdGS:7}]
multimap&lt;short,list&lt;int&gt;&gt;:[{ALpPkqbJ:[6,6,8,7,8,5,7,8,5,5,6, ...]},{AwsHR:[8,5,6,6,5,6,7,6,7,6,8, ...]},{HtLQMvHv:[5,7,6,7,8,6,7]},{KbseLYEs:[5,8,6,8]},{RzsJm:[7,6,8,7,7,7,7,6,6,8,7, ...]},{XpNSkhDa:[7,5,8,8,7,8,5,5,5]},{cXPImNk:[6,8,6,5,8,7,5,6,6,8,6, ...]},{gkKHyh:[5,8,6,6,6,6,5,5,6]},{iPmaraP:[7,6,7,6,7,7,5,7,5,7,7, ...]},{pLmqL:[6,5,5,5,6]}]
unordered_map&lt;short,list&lt;string&gt;&gt;:[{udXahPXD:7},{hUgYjak:5},{OpOmaBqA:7},{vTldeWdS:5},{jEHQST:8},{UZxId:7},{IslGsnGY:8}]
unordered_multimap&lt;short,list&lt;int&gt;&gt;:[{JldxFw:[5,6,8,6,6]},{tnzhP:[8,6,8,5,5,8,8,8]},{cvMaS:[5,7,5,5,5,5]},{eGlyp:[8,7,8,8,7]}]


RAGGED ARRAYS:
---------------------------------------------------------------------
vector&lt;vector&lt;string&gt;&gt;:[[pkwZZ,lBqsR,cmKt,PDjaS,Zj],[Nr,jj,xe,uC,bixzV],[uBAU,pXCa,fZEH,FIAIO],[Vczda,HKEzO,ySqr,Fjd,nh,pgb,zcsw],[fLCgg,qQ,Reul,aTXp,DENn,ZDtkV,VXcB]]
array&lt;vector&lt;short&gt;,N&gt;:[[29,49,29,42,25,33,49,33,44,49],[50,48,35,22,35,33,33],[46,27,23,20,48,38,45,28,45],[25,33,41,22,36]]
array&lt;array&lt;short,M&gt;,N&gt;:[[90,35,99],[47,58,53],[82,25,72],[76,92,62],[39,88,32]]

MISC:
---------------------------------------------------------------------
pair&lt;int,string&gt;:{6:hJnCm}
pair&lt;string,vector&lt;int&gt;&gt;:{iLclgkjnoY:[2,5,6,6,7,3,7,3,3,4,8, ...]}
tuple&lt;string,int,float,short&gt;:&lt;XTK,3,2.63601,6&gt;
tuple&lt;string,list&lt;int&gt;,vector&lt;float&gt;,short&gt;:&lt;[TaPryDWKv,attpFqqIc,geHwbX,vdZ,kvruDeaxpZ,dSOqbVpr,jTciLPgBbI,duc,yUZiCP,zGrTsweTk,LNouX, ...],4,5.81555,[2,3,5,6,8]&gt;
</pre>
</div>
</li>
<li><a id="orgaa981c7"></a><a href="https://forum.hdfgroup.org/t/group-overhead-file-size-problem-for-hierarchical-data/9640">Group Overhead - File size problem for hierarchical data</a><br />
<div class="outline-text-5" id="text-orgaa981c7">
<blockquote>
<p>
We found that a group has quite a memory overhead (was it 2 or 20 kb?).
</p>
</blockquote>
<ul class="org-ul">
<li>How was that measured?</li>
<li>What's in a group?</li>
<li>Responses from Steven, John, and GH</li>
<li>The figure quoted looks unusual/too high</li>
</ul>
</div>
</li>
<li><a id="org6b7fb03"></a><a href="https://forum.hdfgroup.org/t/h5pset-est-link-info-regression-in-1-13-1/9645"><code>H5Pset_est_link_info</code> regression in 1.13.1?</a><br />
<div class="outline-text-5" id="text-org6b7fb03">
<ul class="org-ul">
<li>Yup, looks like it!</li>
<li>Compact vs. dense group storage</li>
<li>The <a href="https://docs.hdfgroup.org/hdf5/develop/group___g_c_p_l.html#gaa8571642d45e73ab5a9ae71cf00501f9">documentation</a> has a few clues</li>
</ul>
</div>
</li>
<li><a id="org1f1d3ba"></a><a href="https://forum.hdfgroup.org/t/corrupted-file-due-to-shutdown/9658">Corrupted file due to shutdown</a><br />
<div class="outline-text-5" id="text-org1f1d3ba">
<blockquote>
<p>
I have a problem with a HDF5 file created with h5py. I have the suspicion that
the process writing to the file was killed.
</p>
</blockquote>
<ul class="org-ul">
<li><p>
Try common household tools
</p>
<div class="org-src-container">
<pre class="src src-shell">strings -t d file.h5
</pre>
</div></li>
<li>Then reach for the heavier guns (<a href="https://guix.gnu.org/packages/h5check-2.0.1/"><code>h5check</code></a>)</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org91b5ea9" class="outline-3">
<h3 id="org91b5ea9">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org91b5ea9">
</div>
<ul class="org-ul">
<li><a id="org2376923"></a>HDFView in Web-browsers?<br />
<div class="outline-text-4" id="text-org2376923">
<ul class="org-ul">
<li>Great community projects (Thanks to Andy Gotz at <a href="https://www.esrf.fr/">ESRF</a>!)</li>
<li><a href="https://github.com/silx-kit/h5web"><code>h5web</code></a> - React components for data visualization and exploration
<ul class="org-ul">
<li><a href="https://h5web.panosc.eu/">Demo</a></li>
<li><a href="https://h5web.panosc.eu/hsds">HSDS support</a></li>
<li><a href="https://hdflab.hdfgroup.org/">HDFLab</a> integration?</li>
</ul></li>
<li><a href="https://github.com/usnistgov/h5wasm"><code>h5wasm</code></a> - A WebAssembly HDF5 reader/writer library
<ul class="org-ul">
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/FileSystem">HTML5 <code>FileSystem</code> API</a></li>
<li><a href="https://ncnr.nist.gov/ncnrdata/view/panosc-hdf-viewer.html?pathlist=ncnrdata/ngbsans/201708/nonims152/data">NeXuS-HDF5 file viewer</a></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org2e469cc" class="outline-2">
<h2 id="org2e469cc">Clinic 2022-04-05</h2>
<div class="outline-text-2" id="text-org2e469cc">
</div>
<div id="outline-container-org72e647e" class="outline-3">
<h3 id="org72e647e">Your questions</h3>
<div class="outline-text-3" id="text-org72e647e">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-orgb911b2d" class="outline-3">
<h3 id="orgb911b2d">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgb911b2d">
</div>
<ul class="org-ul">
<li><a id="org8d5d06a"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org35ddfe5"></a>2022 European HDF5 Users Group (HUG)<br />
<div class="outline-text-5" id="text-org35ddfe5">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/hug/europeanhug22/">Website</a></li>
<li>May 31 - June 2, 2022</li>
<li>Face-to-face at <a href="https://www.iter.org/">ITER</a> in Saint Paul-lez-Durance, France</li>
<li>Reserve your spot before telling your friends! <code>;-)</code></li>
</ul>
</div>
</li>

<li><a id="orgafaca24"></a>ASCR Workshop January 2022 on the Managment and Storage of Scientific Data<br />
<div class="outline-text-5" id="text-orgafaca24">
<ul class="org-ul">
<li><a href="https://www.osti.gov/biblio/1843500-position-papers-ascr-workshop-management-storage-scientific-data">Position Papers</a></li>
<li><a href="https://www.osti.gov/biblio/1845705">Technical Report</a></li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="org80a80e9"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgbd8f356"></a><a href="https://forum.hdfgroup.org/t/file-remains-open-after-calling-hd5f-close/9602">File remains open after calling <code>HD5F.close</code></a><br />
<div class="outline-text-5" id="text-orgbd8f356">
<ul class="org-ul">
<li>Context: .NET, <code>HDF5.PInvoke</code> migrating from 1.8.x to 1.10.x</li>
<li>Biggest change: switch to 64-bit handles</li>
<li>Symptoms: Change in unit test behavior, file closure</li>
<li>User forgot to switch from <code>int</code> to <code>long</code> in one place</li>
<li><p>
C-style <code>typedef</code> has no equivalent in C#; hack:
</p>
<div class="org-src-container">
<pre class="src src-C"><span style="color: #808080;">#if</span> HDF5_VER1_10
<span style="color: #6434A3;">using</span> <span style="color: #BA36A5;">hid_t</span> = System.Int64;
<span style="color: #808080;">#else</span>
<span style="color: #6434A3;">using</span> <span style="color: #BA36A5;">hid_t</span> = System.Int32;
<span style="color: #808080;">#endif</span>
</pre>
</div></li>
<li>How to discover open handles?
<ul class="org-ul">
<li><a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_f.html#gadcdae0aca7c88064db0d32de7f1e31f2"><code>H5Fget_obj_count</code></a>, <a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_f.html#ga35e72579bd07433162b80ddc0bd0c5b1"><code>H5Fget_obj_ids</code></a></li>
<li><a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_i_u_d.html#ga3bc2a11a594bf484cc5dc69ac987d0f4"><code>H5Iiterate</code></a> (since HDF5 1.12)</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orge8f5b2e" class="outline-3">
<h3 id="orge8f5b2e">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orge8f5b2e">
</div>
<ul class="org-ul">
<li><a id="org7d11384"></a>HDF5 applications and clients in Cloud-based environments<br />
<div class="outline-text-4" id="text-org7d11384">

<div id="org8bea188" class="figure">
<p><img src="./img/options.png" alt="options.png" />
</p>
</div>
</div>

<ul class="org-ul">
<li><a id="org94b5eb1"></a>Application-centric<br />
<ul class="org-ul">
<li><a id="org699a8fd"></a>Object<br />
<div class="outline-text-6" id="text-org699a8fd">
<ul class="org-ul">
<li>Application is completely isolated from storage details</li>
</ul>
</div>
</li>
<li><a id="org789b75a"></a>File<br />
<div class="outline-text-6" id="text-org789b75a">
<ul class="org-ul">
<li>Application is potentially "exposed" to storage details via a file-centric view</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org6b7e86c"></a>Service-centric<br />
<div class="outline-text-5" id="text-org6b7e86c">
<ul class="org-ul">
<li>State-less</li>
<li>Cloud-native</li>
<li>Weak consistency</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgf379de5" class="outline-2">
<h2 id="orgf379de5">Clinic 2022-03-29</h2>
<div class="outline-text-2" id="text-orgf379de5">
</div>
<div id="outline-container-org2f5c966" class="outline-3">
<h3 id="org2f5c966">Your questions</h3>
<div class="outline-text-3" id="text-org2f5c966">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-org47df942" class="outline-3">
<h3 id="org47df942">Last week's highlights</h3>
<div class="outline-text-3" id="text-org47df942">
</div>
<ul class="org-ul">
<li><a id="orgd1f3de7"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgced80c6"></a><a href="https://forum.hdfgroup.org/t/free-seminar-using-hdf5-and-hsds-for-open-science-research-at-scale/9532">Free seminar: Using HDF5 and HSDS for Open Science Research at Scale</a><br />
<div class="outline-text-5" id="text-orgced80c6">
<ul class="org-ul">
<li>Friday, April 1, 2022, 11:00 am - 12:30 pm EDT</li>
</ul>
</div>
</li>

<li><a id="orga5b4e6e"></a>2022 European HDF5 Users Group (HUG)<br />
<div class="outline-text-5" id="text-orga5b4e6e">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/hug/europeanhug22/">Website</a></li>
<li>May 31 - June 2, 2022</li>
<li>Face-to-face at <a href="https://www.iter.org/">ITER</a> in Saint Paul-lez-Durance, France</li>
<li>Reserve your spot before telling your friends! <code>;-)</code></li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="orga582221"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgd97139a"></a><a href="https://forum.hdfgroup.org/t/error-read-failed/9531">Error: Read failed</a><br />
<div class="outline-text-5" id="text-orgd97139a">
<ul class="org-ul">
<li>Got a sample, nothing unusual</li>
<li>Core VFD works just fine</li>
<li>Need to find a way to reproduce the behavior (I/O kernel)</li>
<li>Mystery continues</li>
</ul>
</div>
</li>

<li><a id="org85cc1a1"></a><a href="https://forum.hdfgroup.org/t/symbolic-links-with-relative-path/9552">Symbolic links with relative path</a><br />
<div class="outline-text-5" id="text-org85cc1a1">
<ul class="org-ul">
<li>What's the meaning of 'relative' in HDF5? W.r.t. handle (file, group, &#x2026;)!</li>
<li><code>..</code> does and cannot mean what it does in a shell (no tree structure)</li>
<li>Special characters in link names? (<code>/</code>, <code>.</code>, <code>./</code>, <code>/./</code>)</li>
<li><code>..</code>, <code>...</code>, etc., and spaces are legitimate link names</li>
</ul>
</div>
</li>

<li><a id="org8d4a6fe"></a><a href="https://forum.hdfgroup.org/t/refresh-object-so-that-external-changes-were-applied/9544">Refresh object so that external changes were applied</a><br />
<div class="outline-text-5" id="text-org8d4a6fe">
<ul class="org-ul">
<li>The state of an <i>open</i> HDF5 file is a hybrid (in-memory, in-file)</li>
<li>Simultaneously opening an HDF5 file in different processes with one or more
writers, without inter-process communication, creates a coherence problem!
(and potentially a consistency problem&#x2026;)
<ul class="org-ul">
<li>Don't go there!</li>
<li>Use SWMR, IPC, or I/O request queue!</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="orgec30810"></a><a href="https://forum.hdfgroup.org/t/read-portion-of-dataset/9545">Read Portion of Dataset</a><br />
<div class="outline-text-5" id="text-orgec30810">
<ul class="org-ul">
<li>That's what HDF5 is all about</li>
<li>Great responses from a number of people</li>
<li>Most comprehensive example by Steven (<a href="http://h5cpp.org/">H5CPP</a>)</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org4bbe91c" class="outline-3">
<h3 id="org4bbe91c">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org4bbe91c">
</div>
<ul class="org-ul">
<li><a id="orgf09bf95"></a>HDF5 applications and clients in Cloud-based environments<br />
<div class="outline-text-4" id="text-orgf09bf95">

<div id="org519f219" class="figure">
<p><img src="./img/options.png" alt="options.png" />
</p>
</div>
</div>

<ul class="org-ul">
<li><a id="org5ca9688"></a>Application-centric<br />
<ul class="org-ul">
<li><a id="orgab58e98"></a>Object<br />
<div class="outline-text-6" id="text-orgab58e98">
<ul class="org-ul">
<li>Application is completely isolated from storage details</li>
</ul>
</div>
</li>
<li><a id="org909c6d8"></a>File<br />
<div class="outline-text-6" id="text-org909c6d8">
<ul class="org-ul">
<li>Application is potentially "exposed" to storage details via a file-centric view</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org1a166c0"></a>Service-centric<br />
<div class="outline-text-5" id="text-org1a166c0">
<ul class="org-ul">
<li>State-less</li>
<li>Cloud-native</li>
<li>Weak consistency</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgcfce61f" class="outline-2">
<h2 id="orgcfce61f">Clinic 2022-03-22</h2>
<div class="outline-text-2" id="text-orgcfce61f">
</div>
<div id="outline-container-org879dc84" class="outline-3">
<h3 id="org879dc84">Your questions</h3>
<div class="outline-text-3" id="text-org879dc84">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-orgb49f03f" class="outline-3">
<h3 id="orgb49f03f">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgb49f03f">
</div>
<ul class="org-ul">
<li><a id="org9684928"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org9bb02cc"></a><a href="https://forum.hdfgroup.org/t/free-seminar-using-hdf5-and-hsds-for-open-science-research-at-scale/9532">Free seminar: Using HDF5 and HSDS for Open Science Research at Scale</a><br />
<div class="outline-text-5" id="text-org9bb02cc">
<ul class="org-ul">
<li>Friday, April 1, 2022, 11:00 am - 12:30 pm EDT</li>
</ul>
</div>
</li>

<li><a id="org81ad269"></a>2022 European HDF5 Users Group (HUG)<br />
<div class="outline-text-5" id="text-org81ad269">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/hug/europeanhug22/">Website</a></li>
<li>May 31 - June 2, 2022</li>
<li>Face-to-face at <a href="https://www.iter.org/">ITER</a> in Saint Paul-lez-Durance, France</li>
<li>Reserve your spot before telling your friends! <code>;-)</code></li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="orgb4b5764"></a>Forum<br />
<ul class="org-ul">
<li><a id="org1d2fa93"></a><a href="https://forum.hdfgroup.org/t/check-if-hard-soft-external-link-is-broken/9543">Check if Hard/Soft/External link is broken</a><br />
<div class="outline-text-5" id="text-org1d2fa93">
<ul class="org-ul">
<li>How to detect broken soft or external links?
<ul class="org-ul">
<li><a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_l.html#ga171be6e41dc1a464edc402df0ebdf801"><code>H5Lexists</code></a> checks only for link existence in a group, not validity of destination</li>
</ul></li>
<li>Not a perfect match, but <a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_o.html#title16"><code>H5Oexists_by_name</code></a> might do the trick</li>
</ul>
</div>
</li>
<li><a id="org04af99b"></a><a href="https://forum.hdfgroup.org/t/a-problem-when-saving-native-ldouble-variables/9504">A problem when saving <code>NATIVE_LDOUBLE</code> variables</a><br />
<div class="outline-text-5" id="text-org04af99b">
<ul class="org-ul">
<li>Interesting discussion around <code>NATIVE_LDOUBLE</code></li>
<li>Compiler and processor dependent =&gt; you are opening a can of worms</li>
<li>Two options:
<ul class="org-ul">
<li>User-defined FP datatype + soft conversions (relatively safe)</li>
<li>Opaque datatype + metadata (dangerous)</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org833ef4c"></a><a href="https://forum.hdfgroup.org/t/error-read-failed/9531">Error: Read failed</a><br />
<div class="outline-text-5" id="text-org833ef4c">
<ul class="org-ul">
<li>Mystery continues</li>
<li>Trying to get a sample</li>
<li>Use the core VFD to check if it's potentially a POSIX VFD/Windows issue</li>
</ul>
</div>
</li>
<li><a id="org3ed9da7"></a><a href="https://forum.hdfgroup.org/t/reading-and-writing-multiple-files-using-multiple-threads-c/9503">Reading and Writing Multiple Files Using Multiple Threads C++</a><br />
<div class="outline-text-5" id="text-org3ed9da7">
<ul class="org-ul">
<li>The HDF5 library can be built thread-safe</li>
<li>Multiple threads can open HDF5 files independently</li>
<li>BUT, currently, only a single thread can be executing code in the HDF5 library,
i.e., there's no concurrency, at the moment</li>
<li>Two options:
<ul class="org-ul">
<li>(Intermediate) Have a I/O request queue and a single thread servicing I/O
requests</li>
<li>(Advanced) Carefully plan dataset allocation and file metadata discovery to
do concurrent writes and reads outside the HDF5 library</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orge4eb013"></a><a href="https://forum.hdfgroup.org/t/memory-management-in-h5fd-class-t/9452">Memory management in <code>H5FD_class_t</code></a><br />
<div class="outline-text-5" id="text-orge4eb013">
<ul class="org-ul">
<li><a href="https://github.com/HDFGroup/hdf5/pull/1502">GitHub PR#1502</a></li>
<li>Good discussion</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org40b8e19" class="outline-3">
<h3 id="org40b8e19">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org40b8e19">
<p>
(Out of time&#x2026;)
</p>
</div>
</div>
</div>

<div id="outline-container-orgf7bd1f1" class="outline-2">
<h2 id="orgf7bd1f1">Clinic 2022-03-15</h2>
<div class="outline-text-2" id="text-orgf7bd1f1">
</div>
<div id="outline-container-org512b21f" class="outline-3">
<h3 id="org512b21f">Your questions</h3>
<div class="outline-text-3" id="text-org512b21f">
<p>
Re: split/multi driver question from Session 55.  On review, just would like to
confirm:
</p>
<dl class="org-dl">
<dt>Q</dt><dd>Once the member files (<code>-s.h5, -b.h5, </code>) are written with the <code>MULTI</code>
driver (most likely on a POSIX filesystem), they must remain co-located.</dd>
<dt>A</dt><dd>No, however care must be used when re-opening them.</dd>
<dt>Q</dt><dd>They can, however, be copied into a (read-only) S3 bucket.</dd>
<dt>A</dt><dd>Yes.</dd>
<dt>Q</dt><dd>An application can read the S3 multi HDF5 "file" by configuring both
the <code>MULTI</code> file driver and the <code>ROS3</code> driver</dd>
<dt>A</dt><dd>Yes, but this is untested.</dd>
<dt>Q</dt><dd>There is no provision for putting the raw data <code>-r.h5</code> on S3 and the
others (<code>-s.h5, -b.h5, -g.h5, -l.h5, -o.h5</code>) on a local POSIX filesystem.</dd>
<dt>A</dt><dd>This should be possible, but has not been tested, AFAIK.</dd>
</dl>
</div>
</div>

<div id="outline-container-org9a2ca92" class="outline-3">
<h3 id="org9a2ca92">Last week's highlights</h3>
<div class="outline-text-3" id="text-org9a2ca92">
</div>
<ul class="org-ul">
<li><a id="org79dba49"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgbaa7ed2"></a>2022 European HDF5 Users Group (HUG)<br />
<div class="outline-text-5" id="text-orgbaa7ed2">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/hug/europeanhug22/">Website</a></li>
<li>May 31 - June 2, 2022</li>
<li>Face-to-face at <a href="https://www.iter.org/">ITER</a> in Saint Paul-lez-Durance, France</li>
<li>Reserve your spot before telling your friends! <code>;-)</code></li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="orgbef9eac"></a>Forum<br />
<ul class="org-ul">
<li><a id="org1984d61"></a><a href="https://forum.hdfgroup.org/t/reading-multiple-hdf5-files-mounted-on-remote-folder/7238">Reading multiple hdf5 files mounted on remote folder</a><br />
<div class="outline-text-5" id="text-org1984d61">
<ul class="org-ul">
<li>(Blast from the past)</li>
<li>Not sure if that's an <code>h5py</code> issue</li>
</ul>
</div>
</li>
<li><a id="orgab6d433"></a><a href="https://forum.hdfgroup.org/t/a-problem-when-saving-native-ldouble-variables/9504">A problem when saving <code>NATIVE_LDOUBLE</code> variables</a><br />
<div class="outline-text-5" id="text-orgab6d433">
<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Long_double">Wikipedia:long double</a></li>
<li>Need more information</li>
</ul>
</div>
</li>
<li><a id="orgc082980"></a><a href="https://forum.hdfgroup.org/t/reading-and-writing-multiple-files-using-multiple-threads-c/9503">Reading and Writing Multiple Files Using Multiple Threads C++</a><br />
<div class="outline-text-5" id="text-orgc082980">
<ul class="org-ul">
<li>Steven posted a good comment</li>
<li>Too many options w/o additional context</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org5f5fcd9" class="outline-3">
<h3 id="org5f5fcd9">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org5f5fcd9">
<p>
(Out of time&#x2026;)
</p>
</div>
</div>
</div>

<div id="outline-container-orgf557675" class="outline-2">
<h2 id="orgf557675">Clinic 2022-03-08</h2>
<div class="outline-text-2" id="text-orgf557675">
</div>
<div id="outline-container-org67d0612" class="outline-3">
<h3 id="org67d0612">Your Questions</h3>
<div class="outline-text-3" id="text-org67d0612">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-org35e88eb" class="outline-3">
<h3 id="org35e88eb">Last week's highlights</h3>
<div class="outline-text-3" id="text-org35e88eb">
</div>
<ul class="org-ul">
<li><a id="org553f34f"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org227733b"></a><a href="https://portal.hdfgroup.org/display/support/HDF5%201.13.1">HDF5 1.13.1 release</a><br />
<div class="outline-text-5" id="text-org227733b">
<ul class="org-ul">
<li><a href="https://support.hdfgroup.org/ftp/HDF5/releases/hdf5-1.13/hdf5-1.13.1/src/hdf5-1.13.1-RELEASE.txt">Release notes</a></li>
<li>Blog post <a href="https://www.hdfgroup.org/2022/03/parallel-compression-improvements-in-hdf5-1-13-1/">Parallel compression improvements in HDF5 1.13.1</a>
<ul class="org-ul">
<li>Bug fixes &amp; performance improvements and better support for collective I/O</li>
<li>Much improved IOR results from <code>Cori</code> at NERSC</li>
<li>For parallel dataset creation early allocation was the only option
<ul class="org-ul">
<li>Incremental file space allocation is now supported for datasets created in
parallel but <i>only if</i> they have filters applied to them</li>
</ul></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="orgd178f4a"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgc51d390"></a><a href="https://forum.hdfgroup.org/t/extent-the-dataspace-of-an-existing-attribute/9464">Extent the dataspace of an existing attribute</a><br />
<div class="outline-text-5" id="text-orgc51d390">
<ul class="org-ul">
<li>Storing multiple physical quantities in a single scalar dataset, e.g.,
velocity, density and temperature of a cubic with dimensional elements of
<code>101 x 71 x 51</code> , the dataset would have for example an extent of <code>(3, 101, 71, 51)</code></li>
<li>How to keep track of quantity metadata, e.g., unit symbol?
<ul class="org-ul">
<li>What to do if we add a (e.g., fourth) quantity to the dataset?</li>
</ul></li>
</ul>
</div>
<ul class="org-ul">
<li><a id="org91dc5c6"></a>Idea<br />
<div class="outline-text-6" id="text-org91dc5c6">
<p>
Store the quantity metadata in an array-like attribute
</p>
</div>
</li>
<li><a id="org5aa885a"></a>Problems<br />
<div class="outline-text-6" id="text-org5aa885a">
<ul class="org-ul">
<li><code>H5T_ARRAY</code> class datatypes are fixed rank and extent</li>
<li>Attribute dataspaces are not extendable</li>
</ul>
</div>
</li>
<li><a id="org8fcfc11"></a>Solutions<br />
<div class="outline-text-6" id="text-org8fcfc11">
<p>
All solutions come with different trade-offs!
</p>

<ul class="org-ul">
<li>Assuming this doesn't happen too often: extend/re-write the attribute on
each dimension change</li>
<li>Use a variable-length sequence (VLEN) datatype: read/re-write the attribute
on each dimension change</li>
<li><p>
Use a "shared" attribute (=attribute that is an object reference to an
extendable dataset)
</p>
<dl class="org-dl">
<dt>Note</dt><dd>For the use case at hand, the sharing aspect is <i>not</i>
important. It's the extendability of the object-referenced dataset.</dd>
</dl>

<div id="org89050e3" class="figure">
<p><img src="./img/shared_attribute.png" alt="shared_attribute.png" />
</p>
<p><span class="figure-number">Figure 1: </span>A "shared" attribute</p>
</div></li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="orge7dc16e"></a><a href="https://forum.hdfgroup.org/t/memory-leak-while-reading-data/9473">Memory Leak while Reading Data?</a><br />
<div class="outline-text-5" id="text-orge7dc16e">
<ul class="org-ul">
<li>Loop over a directory of HDF5 files and populate a list of per-file
dictionaries</li>
<li>A bit of a mystery; appears to happen only under macOS
<ul class="org-ul">
<li>No issues under Windows w/ <code>h5py</code> 2.x or 3.x, according to the user</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orge78b623" class="outline-3">
<h3 id="orge78b623">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orge78b623">
<p>
(Out of time&#x2026;)
</p>
</div>
</div>
</div>
<div id="outline-container-org5001c9f" class="outline-2">
<h2 id="org5001c9f">Clinic 2022-03-01</h2>
<div class="outline-text-2" id="text-org5001c9f">
</div>
<div id="outline-container-org5217ecb" class="outline-3">
<h3 id="org5217ecb">Your Questions</h3>
<div class="outline-text-3" id="text-org5217ecb">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-org2d6632e" class="outline-3">
<h3 id="org2d6632e">Last week's highlights</h3>
<div class="outline-text-3" id="text-org2d6632e">
</div>
<ul class="org-ul">
<li><a id="org60fc5e8"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgdf43bcf"></a><a href="https://forum.hdfgroup.org/t/tutorial-announcement-constructing-a-simple-terminal-vol-connector/9187">Tutorial Announcement: Constructing a Simple Terminal VOL Connector</a><br />
<div class="outline-text-5" id="text-orgdf43bcf">
<ul class="org-ul">
<li><a href="https://youtu.be/7XEbm-__QuM">Recording</a> and <a href="https://www.hdfgroup.org/wp-content/uploads/2022/02/VOL_tutorial_feb_2022.pdf">slides</a> available</li>
<li><a href="https://github.com/HDFGroup/vol-toolkit">VOL toolkit</a> on GitHub</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="orge1427bf"></a>Forum<br />
<ul class="org-ul">
<li><a id="org59d00db"></a><a href="https://forum.hdfgroup.org/t/can-compound-dataset-been-compressed/9457">Can Compound Dataset been compressed?</a><br />
<div class="outline-text-5" id="text-org59d00db">
<ul class="org-ul">
<li>Yes.</li>
<li>Compound datatype with array datatype fields</li>
<li>Misunderstanding on chunking and elements</li>
<li>No <a href="https://en.wikipedia.org/wiki/Minimal_reproducible_example">Minimal Reproducible Example (MRE)</a>, no error messages</li>
</ul>
</div>
</li>
<li><a id="org2494f73"></a><a href="https://forum.hdfgroup.org/t/hdf5-crosscompile-to-arm64/6759">Hdf5 crosscompile to arm64</a><br /></li>
<li><a id="org6800ebc"></a><a href="https://forum.hdfgroup.org/t/memory-management-in-h5fd-class-t/9452">Memory management in <code>H5FD_class_t</code></a><br />
<div class="outline-text-5" id="text-org6800ebc">
<ul class="org-ul">
<li>When the VFL layer was created (~1998?) there were only RAM and HDDs</li>
<li>With GPU, FPGA, and other near-data computing devices there are new types of
memory, storage, and storage access paths</li>
<li>The (de-)allocation VFD callbacks deal with (de-)allocation of (virtual) file
space</li>
<li>I/O acceleration depends on device-specific memory</li>
<li id="Goal">Avoid reams of device specific conditonally-compiled allocation code</li>
<li id="Approach">Since the application selects a device-specific VFD, extend the
<a href="https://docs.hdfgroup.org/hdf5/develop/struct_h5_f_d__class__t.html"><code>H5FD_class_t</code></a> interface with generic device-memory (de-)allocation callbacks</li>
<li id="Proposal"><p>
My colleague Jordan Henderson recently added a control callback
and a corresponding op-code.
</p>
<div class="org-src-container">
<pre class="src src-C"><span style="color: #8D8D84;">/*</span>
<span style="color: #8D8D84; font-style: italic;"> * Defining H5FD_FEAT_MEMMANAGE for a VFL driver means that</span>
<span style="color: #8D8D84; font-style: italic;"> * the driver uses special memory management routines or wishes</span>
<span style="color: #8D8D84; font-style: italic;"> * to do memory management in a specific manner. Therefore, HDF5</span>
<span style="color: #8D8D84; font-style: italic;"> * should request that the driver handle any memory management</span>
<span style="color: #8D8D84; font-style: italic;"> * operations when appropriate.</span>
<span style="color: #8D8D84;"> */</span>
<span style="color: #808080;">#define</span> <span style="color: #BA36A5;">H5FD_FEAT_MEMMANAGE</span> 0x00010000

<span style="color: #6434A3;">herr_t</span> (*<span style="color: #006699;">ctl</span>)(<span style="color: #6434A3;">H5FD_t</span> *<span style="color: #BA36A5;">file</span>, <span style="color: #6434A3;">uint64_t</span> <span style="color: #BA36A5;">op_code</span>, <span style="color: #6434A3;">uint64_t</span> <span style="color: #BA36A5;">flags</span>,
              <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">void</span> *<span style="color: #BA36A5;">input</span>, <span style="color: #6434A3;">void</span> **<span style="color: #BA36A5;">output</span>);

</pre>
</div></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org4ed91fc" class="outline-3">
<h3 id="org4ed91fc">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org4ed91fc">
</div>
<ul class="org-ul">
<li><a id="orgb347825"></a>HDF5 extension APIs - Virtual File Layer (VFL)<br />
<div class="outline-text-4" id="text-orgb347825">
<ul class="org-ul">
<li><a href="https://docs.hdfgroup.org/hdf5/develop/_v_f_l.html">Introductory technical note</a></li>
</ul>

<div id="orgf6d159e" class="figure">
<p><img src="./img/vol_vfd.png" alt="vol_vfd.png" />
</p>
<p><span class="figure-number">Figure 2: </span>HDF5 extension APIs (Elena Pourmal, The HDF Group)</p>
</div>
<ul class="org-ul">
<li>No VFL toolkit, but using an existing VFD (= VFL plugin) is a good starting
point, see files called <code>H5FD*.[c,h]</code> in the HDF5 source tree.</li>
<li>Example: read-only VFD plugin for Hadoop File System (HDFS)
<ul class="org-ul">
<li><a href="https://github.com/HDFGroup/hdf5/blob/develop/src/H5FDhdfs.h"><code>H5FDhdfs.h</code></a></li>
<li><a href="https://github.com/HDFGroup/hdf5/blob/develop/src/H5FDhdfs.c"><code>H5FDhdfs.c</code></a></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org4fe1306" class="outline-2">
<h2 id="org4fe1306">Clinic 2022-02-22</h2>
<div class="outline-text-2" id="text-org4fe1306">
</div>
<div id="outline-container-orga0691f9" class="outline-3">
<h3 id="orga0691f9">Your Questions</h3>
<div class="outline-text-3" id="text-orga0691f9">
<dl class="org-dl">
<dt>Q</dt><dd>Clarification/explanation on John Readeys "seismic data" post regarding
using native HDF5 as an HSDS "single object".  Robert Seip</dd>
</dl>
</div>
</div>

<div id="outline-container-orgb12a92d" class="outline-3">
<h3 id="orgb12a92d">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgb12a92d">
</div>
<ul class="org-ul">
<li><a id="orgae23d8b"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org1bfed17"></a><a href="https://forum.hdfgroup.org/t/tutorial-announcement-constructing-a-simple-terminal-vol-connector/9187">Constructing a Simple Terminal VOL Connector</a><br />
<div class="outline-text-5" id="text-org1bfed17">
<ul class="org-ul">
<li>It's happening on this Friday, February 25th, 11:00 a.m. to 1:00
p.m. (Central)</li>
<li>You can still register!</li>
</ul>
</div>
</li>
<li><a id="org04b0cef"></a>Check out another interesting blog post<br />
<div class="outline-text-5" id="text-org04b0cef">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/2022/02/a-kind-of-magic-storing-computations-in-hdf5/">A Kind of Magic: Storing Computations in HDF5</a>
<ul class="org-ul">
<li>The latest and greatest on Lucas C. Villa Real's <a href="https://github.com/lucasvr/hdf5-udf">HDF5-UDF</a></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="orgf7569c5"></a>Forum<br />
<ul class="org-ul">
<li><a id="org6fb52cb"></a><a href="https://forum.hdfgroup.org/t/unable-to-open-a-dataset-in-my-hdf5-file/9425">Unable to open a Dataset in my HDF5 file</a><br />
<div class="outline-text-5" id="text-org6fb52cb">
<ul class="org-ul">
<li>It often helps to read what people are actually asking&#x2026;</li>
<li><p>
I'm glad my colleague Aleksandar did just that and clarified that the way to
obtain a NumPy array from a dataset is
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">phrase_numpy</span> = phrase[...]
</pre>
</div>
<p>
and <b>not</b>
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">phrase_numpy</span> = np.array(phrase)
</pre>
</div></li>
</ul>
</div>
</li>
<li><a id="org405a1d6"></a><a href="https://forum.hdfgroup.org/t/read-subgroups-parallel-bug/9426">Read subgroups parallel bug?</a><br />
<div class="outline-text-5" id="text-org405a1d6">
<ul class="org-ul">
<li>Poor performance of <code>H5Lget_name_by_idx</code> or <code>H5Literate</code> with large numbers of
links</li>
<li>Running against <a href="https://www.beegfs.io/c/">BeeGFS</a></li>
<li>File sizes of 1-2 GB</li>
<li>Better strategy: Use HDF5 core VFD (<a href="https://docs.hdfgroup.org/hdf5/develop/group___f_a_p_l.html#title51"><code>H5Pset_fapl_core</code></a>) to load into memory
and then do the iteration without I/O at memory speed.</li>
</ul>
</div>
</li>
<li><a id="org28b51a6"></a><a href="https://forum.hdfgroup.org/t/help-with-broken-file/9436">Help with broken file</a><br />
<div class="outline-text-5" id="text-org28b51a6">
<ul class="org-ul">
<li>Sad story</li>
<li>We talked about the HDF5 file state <a href="#org87af9da">about a year ago</a>
<ul class="org-ul">
<li>There are currently no user-level transactions in HDF5, making file content
vulnerable to application crash</li>
</ul></li>
<li>Familiarity with the <a href="https://docs.hdfgroup.org/hdf5/develop/_f_m_t3.html">file format specification</a> and <a href="https://github.com/HDFGroup/hdf5/blob/develop/tools/src/misc/h5debug.c"><code>h5debug</code></a> can help to
inspect parts of an HDF5 file that is in an inconsistent state</li>
<li>A proper discovery tool of recoverable information would be great &amp; we even
have ideas how to do it
<ul class="org-ul">
<li><p>
There are comments in the file format specification such as this:
</p>
<blockquote>
<p>
The ASCII character string "SNOD" is used to indicate the beginning of a
symbol table node. This gives file consistency checking utilities a better
chance of reconstructing a damaged file.
</p>
</blockquote>
<p>
Alas, those "file consistency checking utilities" never materialized.
</p></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org0b7c699" class="outline-3">
<h3 id="org0b7c699">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org0b7c699">
</div>
<ul class="org-ul">
<li><a id="org88a2228"></a>How do HDF5-UDF work?<br />
<div class="outline-text-4" id="text-org88a2228">
<p>
Currently, they are repesented as chunked datasets with a single chunk. That's
why they work fine with existing tools. The UDF itself is executed as part of the
HDF5 filter pipeline. Its code is stored in the dataset blob data plus metadata
and managed by the UDF handler.
</p>


<div id="org8bd8916" class="figure">
<p><img src="./img/H5Dwrite_chunk.png" alt="H5Dwrite_chunk.png" />
</p>
<p><span class="figure-number">Figure 3: </span><code>H5Dwrite_chunk</code></p>
</div>


<div id="org2ceaabc" class="figure">
<p><img src="./img/hdf5-udf.png" alt="hdf5-udf.png" />
</p>
<p><span class="figure-number">Figure 4: </span>HDF5-UDF overview (Lucas C. Villa Real)</p>
</div>

<ul class="org-ul">
<li><p>
Example: <a href="https://github.com/lucasvr/user-defined-functions/tree/default/data_virtualization/csv">Virtualization of CSV files through HDF5-UDF</a>
</p>

<pre class="example" id="orgee7d8f0">

def dynamic_dataset():
    udf_data = lib.getData("GreatestAlbums")
    udf_dims = lib.getDims("GreatestAlbums")

    # The file is encoded as ISO-8859-1, so instruct Python about it
    with open("albumlist.csv", encoding="iso-8859-1") as f:

        # Read and ignore the header
        f.readline()

        for i, line in enumerate(f.readlines()):
            # Remove double-quotes and newlines around certain strings
            parts = [col.strip('"').strip("\n") for col in line.split(",")]
            udf_data[i].Number = int(parts[0])
            udf_data[i].Year = int(parts[1])
            lib.setString(udf_data[i].Album,  parts[2].encode("utf-8"))
            lib.setString(udf_data[i].Artist,  parts[3].encode("utf-8"))
            lib.setString(udf_data[i].Genre,  parts[4].encode("utf-8"))
            lib.setString(udf_data[i].Subgenre,  parts[5].encode("utf-8"))

</pre></li>

<li>Resources
<ul class="org-ul">
<li><a href="https://github.com/lucasvr/hdf5-udf">HDF5-UDF on GitHub</a></li>
<li><a href="https://hdf5-udf.readthedocs.io/en/latest/#json-schema-for-hdf5-udf-datasets">HDF5-UDF Documentation</a></li>
<li><a href="https://github.com/lucasvr/user-defined-functions/">HDF5-UDF examples</a></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgbbfc867" class="outline-2">
<h2 id="orgbbfc867">Clinic 2022-02-15</h2>
<div class="outline-text-2" id="text-orgbbfc867">
</div>
<div id="outline-container-org24b99b4" class="outline-3">
<h3 id="org24b99b4">Your Questions</h3>
<div class="outline-text-3" id="text-org24b99b4">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>

<div id="outline-container-org18f87ca" class="outline-3">
<h3 id="org18f87ca">Last week's highlights</h3>
<div class="outline-text-3" id="text-org18f87ca">
</div>
<ul class="org-ul">
<li><a id="org3270886"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org3c87701"></a><a href="https://forum.hdfgroup.org/t/tutorial-announcement-constructing-a-simple-terminal-vol-connector/9187">VOL tutorial postponed</a><br />
<div class="outline-text-5" id="text-org3c87701">
<ul class="org-ul">
<li>New date February 25th, 11:00 a.m. to 1:00 p.m. (Central)</li>
<li>You can still register</li>
</ul>
</div>
</li>
<li><a id="orgffa2b97"></a>Check out this interesting blog post<br />
<div class="outline-text-5" id="text-orgffa2b97">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/2022/02/biosimulations-a-platform-for-sharing-and-reusing-biological-simulations/"><i>BioSimulations: a platform for sharing and reusing biological simulations</i></a></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="orgd76aa38"></a>Forum<br />
<ul class="org-ul">
<li><a id="org5aa3c0b"></a><a href="https://forum.hdfgroup.org/t/read-compound-data-to-buffer/9402">Read compound data to buffer</a><br />
<div class="outline-text-5" id="text-org5aa3c0b">
<ul class="org-ul">
<li>HDFView screenshot of a compound dataset</li>
<li><p>
Simple &amp; elegant <a href="https://www.hdfql.com/">HDFql</a> solution
</p>
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;iostream&gt;</span>
<span style="color: #808080;">#include</span> <span style="color: #008000;">"HDFql.hpp"</span>

<span style="color: #0000FF;">struct</span> <span style="color: #6434A3;">data</span>
{
    <span style="color: #6434A3;">unsigned</span> <span style="color: #6434A3;">long</span> <span style="color: #6434A3;">long</span> <span style="color: #BA36A5;">timestamp</span>;
    <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">order</span>;
    <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">serial_number</span>;
    <span style="color: #6434A3;">double</span> <span style="color: #BA36A5;">temperature</span>;
    <span style="color: #6434A3;">double</span> <span style="color: #BA36A5;">pressure</span>;
    <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">int_array</span>[2][2];
};

<span style="color: #6434A3;">int</span> <span style="color: #006699;">main</span>(<span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">argc</span>, <span style="color: #6434A3;">char</span> *<span style="color: #BA36A5;">argv</span>[])
{
   <span style="color: #0000FF;">struct</span> <span style="color: #6434A3;">data</span> <span style="color: #BA36A5;">values</span>[4];

   <span style="color: #D0372D;">HDFql</span>::variableRegister(values);

   <span style="color: #D0372D;">HDFql</span>::execute(<span style="color: #008000;">"select from h5ex_t_cmpd.h5 DS1 into memory 0"</span>);

   <span style="color: #0000FF;">for</span>(<span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">i</span> = 0; i &lt; 4; i++)
   {
       <span style="color: #D0372D;">std</span>::cout &lt;&lt; <span style="color: #008000;">"Timestamp="</span> &lt;&lt; values[i].timestamp &lt;&lt; <span style="color: #D0372D;">std</span>::endl;
       <span style="color: #D0372D;">std</span>::cout &lt;&lt; <span style="color: #008000;">"Order="</span> &lt;&lt; values[i].order &lt;&lt; <span style="color: #D0372D;">std</span>::endl;
       <span style="color: #D0372D;">std</span>::cout &lt;&lt; <span style="color: #008000;">"Serial number="</span> &lt;&lt; values[i].serial_number &lt;&lt; <span style="color: #D0372D;">std</span>::endl;
       <span style="color: #D0372D;">std</span>::cout &lt;&lt; <span style="color: #008000;">"Temperature="</span> &lt;&lt; values[i].temperature &lt;&lt; <span style="color: #D0372D;">std</span>::endl;
       <span style="color: #D0372D;">std</span>::cout &lt;&lt; <span style="color: #008000;">"Pressure="</span> &lt;&lt; values[i].pressure &lt;&lt; <span style="color: #D0372D;">std</span>::endl;
       <span style="color: #D0372D;">std</span>::cout &lt;&lt; <span style="color: #008000;">"IntArray[0][0]="</span> &lt;&lt; values[i].int_array[0][0] &lt;&lt; <span style="color: #D0372D;">std</span>::endl;
       <span style="color: #D0372D;">std</span>::cout &lt;&lt; <span style="color: #008000;">"IntArray[0][1]="</span> &lt;&lt; values[i].int_array[0][1] &lt;&lt; <span style="color: #D0372D;">std</span>::endl;
       <span style="color: #D0372D;">std</span>::cout &lt;&lt; <span style="color: #008000;">"IntArray[1][0]="</span> &lt;&lt; values[i].int_array[1][0] &lt;&lt; <span style="color: #D0372D;">std</span>::endl;
       <span style="color: #D0372D;">std</span>::cout &lt;&lt; <span style="color: #008000;">"IntArray[1][1]="</span> &lt;&lt; values[i].int_array[1][1] &lt;&lt; <span style="color: #D0372D;">std</span>::endl;
   }

   <span style="color: #0000FF;">return</span> 0;
}
</pre>
</div></li>
</ul>
</div>
</li>
<li><a id="org3ead739"></a><a href="https://forum.hdfgroup.org/t/can-we-use-external-links-to-read-only-data-in-writable-files/9390">Can we use external links to read-only data in writable files?</a><br />
<div class="outline-text-5" id="text-org3ead739">
<ul class="org-ul">
<li>Interesting follow-up from Thomas Kluyver (<code>h5py</code> project)
<ul class="org-ul">
<li><code>h5py</code> does not currently expose <code>H5Pset_elink_acc_flags</code></li>
<li>Would be easy to do in the low-level API</li>
<li>High-level API unclear</li>
</ul></li>
<li>Ambiguous error message; API failure due to insufficient permissions
vs. non-existent file or directory
<ul class="org-ul">
<li><a href="https://github.com/HDFGroup/hdf5/issues/1431">GitHub issue</a></li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org932d9f0"></a><a href="https://forum.hdfgroup.org/t/read-subgroups-parallel-bug/9426">Read subgroups parallel bug?</a><br />
<div class="outline-text-5" id="text-org932d9f0">
<ul class="org-ul">
<li>Goal: Determine the link names of blocks of subgroups in a group in parallel.</li>
<li>Idea: Assign a link index range to each MPI process and fire away:
<code>H5Lget_name_by_idx</code>.</li>
<li>Issues:
<ul class="org-ul">
<li>MPI hangs; not sure why&#x2026;</li>
<li><code>H5Lget_name_by_idx</code> is an expensive call, looping over <code>idx</code> makes it worse
<ul class="org-ul">
<li>Parallel file systems don't like it</li>
</ul></li>
<li><code>H5Literate</code> + callback would be better, but not much
<ul class="org-ul">
<li>To many small reads will be a drag on performance</li>
</ul></li>
</ul></li>
<li>The real question is what the underlying use case is about.
<ul class="org-ul">
<li>Maybe a dataset of object references instead of a group would be more
suitable?</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org760edef" class="outline-3">
<h3 id="org760edef">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org760edef">
</div>
<ul class="org-ul">
<li><a id="org50c1e8f"></a>Do you need a link or a reference?<br />
<div class="outline-text-4" id="text-org50c1e8f">
<dl class="org-dl">
<dt>HDF5 link</dt><dd><p>
Explicit, unidirectional, named association between a source
(HDF5 group) and a destination
</p>
<pre class="example" id="org04f35cd">
     name
src -------&gt; dst
</pre></dd>
<dt>HDF5 (object) reference</dt><dd><p>
An HDF5 datatype whose values represent references
(pointers) to HDF5 objects in the same or other HDF5 files.
</p>
<pre class="example" id="org9695831">
&amp;object
</pre></dd>
</dl>
</div>

<ul class="org-ul">
<li><a id="org8559216"></a>Similarities<br />
<div class="outline-text-5" id="text-org8559216">
<ul class="org-ul">
<li>Links can be used in the role of a (non-value) reference
<ul class="org-ul">
<li>A link can be "de-referenced" by link traversal</li>
</ul></li>
<li>References can be used as implicit links
<ul class="org-ul">
<li>A reference can be "traversed" by address/token resolution</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="orge550194"></a>Differences<br />
<div class="outline-text-5" id="text-orge550194">
<ul class="org-ul">
<li>Links
<ul class="org-ul">
<li>Are inseparable from groups and not values of an HDF5 datatype</li>
<li>Have a name</li>
<li>Can be dangling</li>
</ul></li>
<li>References
<ul class="org-ul">
<li>Are values of an HDF5 datatype</li>
<li>We can store them in attributes and datasets</li>
<li>Have no name other than their implicit position</li>
<li>Cannot dangle</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org6f98f78" class="outline-2">
<h2 id="org6f98f78">Clinic 2022-02-08</h2>
<div class="outline-text-2" id="text-org6f98f78">
</div>
<div id="outline-container-org6aca59a" class="outline-3">
<h3 id="org6aca59a">Your Questions</h3>
<div class="outline-text-3" id="text-org6aca59a">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
<dt>Q</dt><dd><p>
Can a point selection be written to/read from a hypserslab selection?
Does this work in parallel? Yes!
</p>
<div class="org-src-container">
<pre class="src src-C"><span style="color: #808080;">#include</span> <span style="color: #008000;">"hdf5.h"</span>
<span style="color: #808080;">#include</span> <span style="color: #008000;">"mpi.h"</span>

<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdlib.h&gt;</span>

<span style="color: #6434A3;">int</span> <span style="color: #006699;">main</span>(<span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">argc</span>, <span style="color: #6434A3;">char</span>** <span style="color: #BA36A5;">argv</span>)
{
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">boilerplate</span>
  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">retval</span> = EXIT_SUCCESS;
  <span style="color: #0000FF;">if</span> (MPI_Init(&amp;argc, &amp;argv) != MPI_SUCCESS) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_mpi</span>;
  }

  <span style="color: #6434A3;">MPI_Comm</span> <span style="color: #BA36A5;">comm</span> = MPI_COMM_WORLD;
  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">size</span>, <span style="color: #BA36A5;">rank</span>;
  <span style="color: #0000FF;">if</span> (MPI_Comm_size(comm, &amp;size) != MPI_SUCCESS ||
      MPI_Comm_rank(comm, &amp;rank) != MPI_SUCCESS) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }

  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">fapl</span> = H5I_INVALID_HID;
  <span style="color: #0000FF;">if</span> ((fapl = H5Pcreate(H5P_FILE_ACCESS)) == H5I_INVALID_HID ||
      H5Pset_fapl_mpio(fapl, comm, MPI_INFO_NULL) &lt; 0) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }

  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file</span> = H5I_INVALID_HID;
  <span style="color: #0000FF;">if</span> ((file = H5Fcreate(<span style="color: #008000;">"sel_par.h5"</span>, H5F_ACC_TRUNC, H5P_DEFAULT, fapl))
      == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">1D filespace, size of communicator</span>
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">fspace</span> = H5I_INVALID_HID;
  <span style="color: #0000FF;">if</span> ((fspace = H5Screate_simple(1, (<span style="color: #6434A3;">hsize_t</span>[]) {2*size}, <span style="color: #D0372D;">NULL</span>)) ==
      H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_fspace</span>;
  }

  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dset</span> = H5I_INVALID_HID;
  <span style="color: #0000FF;">if</span> ((dset = H5Dcreate(file, <span style="color: #008000;">"ints"</span>, H5T_STD_I32LE, fspace, H5P_DEFAULT,
                        H5P_DEFAULT, H5P_DEFAULT)) == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dset</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">2-element memory space</span>
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">mspace</span> = H5I_INVALID_HID;
  <span style="color: #0000FF;">if</span> ((mspace = H5Screate_simple(1, (<span style="color: #6434A3;">hsize_t</span>[]) {2}, <span style="color: #D0372D;">NULL</span>)) ==
      H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_mspace</span>;
  }

  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">data</span>[2] = { 2*rank, 2*rank+1 };

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">1. Make a (single) point selection in memory</span>
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">2. Make a hyperslab selection in the file</span>
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">3. Write</span>
  <span style="color: #0000FF;">if</span> (H5Sselect_elements(mspace, H5S_SELECT_SET, 1, (<span style="color: #6434A3;">hsize_t</span>[]){0}) &lt; 0 ||
      H5Sselect_hyperslab(fspace, H5S_SELECT_SET, (<span style="color: #6434A3;">hsize_t</span>[]){2*rank}, <span style="color: #D0372D;">NULL</span>,
                          (<span style="color: #6434A3;">hsize_t</span>[]){1}, (<span style="color: #6434A3;">hsize_t</span>[]){1}) &lt; 0 ||
      H5Dwrite(dset, H5T_NATIVE_INT, mspace, fspace, H5P_DEFAULT, data) &lt; 0) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_write</span>;
  }

<span style="color: #D0372D;">fail_write</span>:
  H5Sclose(mspace);
<span style="color: #D0372D;">fail_mspace</span>:
  H5Dclose(dset);
<span style="color: #D0372D;">fail_dset</span>:
  H5Sclose(fspace);
<span style="color: #D0372D;">fail_fspace</span>:
  H5Fclose(file);
<span style="color: #D0372D;">fail_file</span>:
  <span style="color: #0000FF;">if</span> (fapl != H5I_INVALID_HID)
    H5Pclose(fapl);

  MPI_Barrier(comm);

  MPI_Finalize();

<span style="color: #D0372D;">fail_mpi</span>:
  <span style="color: #0000FF;">return</span> retval;
}
</pre>
</div>
<p>
Output:
</p>
<pre class="example" id="orgf2bcf3d">
penguin:~$ mpiexec -n 4 ./sel_par
penguin:~$ h5dump sel_par.h5
HDF5 "sel_par.h5" {
GROUP "/" {
   DATASET "ints" {
      DATATYPE  H5T_STD_I32LE
      DATASPACE  SIMPLE { ( 8 ) / ( 8 ) }
      DATA {
      (0): 0, 0, 2, 0, 4, 0, 6, 0
      }
   }
}
}
</pre></dd>
</dl>
</div>
</div>

<div id="outline-container-org886af85" class="outline-3">
<h3 id="org886af85">Last week's highlights</h3>
<div class="outline-text-3" id="text-org886af85">
</div>
<ul class="org-ul">
<li><a id="orgce232c5"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgbcc945d"></a><a href="https://forum.hdfgroup.org/t/tutorial-announcement-constructing-a-simple-terminal-vol-connector/9187">VOL tutorial postponed</a><br />
<div class="outline-text-5" id="text-orgbcc945d">
<ul class="org-ul">
<li>New date February 25th, 11:00 a.m. to 1:00 p.m. (Central)</li>
<li>You can still register</li>
</ul>
</div>
</li>
<li><a id="orgc61e8f4"></a>Check out this interesting blog post<br />
<div class="outline-text-5" id="text-orgc61e8f4">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/2022/02/biosimulations-a-platform-for-sharing-and-reusing-biological-simulations/"><i>BioSimulations: a platform for sharing and reusing biological simulations</i></a></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org7bd670e"></a>Forum<br />
<ul class="org-ul">
<li><a id="org547a8bf"></a><a href="https://forum.hdfgroup.org/t/recover-corrupted-datasets/9375">Recover corrupted datasets</a><br />
<div class="outline-text-5" id="text-org547a8bf">
<ul class="org-ul">
<li>Turns out that there was a single corrupted chunk</li>
<li>Unclear how it got corrupted</li>
<li>The user was able to recover the good chunks via <a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_d.html#title30"><code>H5Dread_chunk</code></a></li>
</ul>
</div>
</li>
<li><a id="org3823b38"></a><a href="https://forum.hdfgroup.org/t/using-gzip-compression-does-not-compress-and-cannot-be-opened-by-hdfview/9388">Using GZIP compression does not compress, and cannot be opened by HDFView</a><br />
<div class="outline-text-5" id="text-org3823b38">
<ul class="org-ul">
<li>It appears that the user didn't appreciate the implications of using
<a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_d.html#title37"><code>H5Dwrite_chunk</code></a>
<ul class="org-ul">
<li>Using this function tells the HDF5 library to "step aside" and let the
user take full control</li>
<li>Compression outside the library is fine, but you need to make sure that
the right metadata is in place</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org4eabf07"></a><a href="https://forum.hdfgroup.org/t/why-are-there-err-files-next-to-test-files-in-binary-plugin-download/9394">Why are there .err files next to test files in binary plugin download?</a><br />
<div class="outline-text-5" id="text-org4eabf07">
<ul class="org-ul">
<li>Just artifacts for testing</li>
<li>Could they be stripped from release binaries? Perhaps.</li>
</ul>
</div>
</li>
<li><a id="orgbdce2cc"></a><a href="https://forum.hdfgroup.org/t/can-we-use-external-links-to-read-only-data-in-writable-files/9390">Can we use external links to read-only data in writable files?</a><br />
<div class="outline-text-5" id="text-orgbdce2cc">
<ul class="org-ul">
<li>Traversing external links typically involves opening another HDF5 file</li>
<li>What's the access mode? (The link does <b>NOT</b> contain that information.)
<ul class="org-ul">
<li>Default access mode: inherited from the link's "parent"</li>
<li>Can be overwritten via a link access property list with <a href="https://docs.hdfgroup.org/hdf5/develop/group___l_a_p_l.html#ga020f7eb2eae01043286af50db0a76d82"><code>H5Pset_elink_acc_flags</code></a></li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org147bb01"></a><a href="https://forum.hdfgroup.org/t/compression-filter-that-employes-multiple-datasets/9398">Compression filter that employes multiple datasets</a><br />
<div class="outline-text-5" id="text-org147bb01">
<ul class="org-ul">
<li>Use case: compression of unstructured mesh connectivity
<ul class="org-ul">
<li>Involves multiple datasets</li>
<li>The current filter extension API has no support for that</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orgde0e118" class="outline-3">
<h3 id="orgde0e118">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orgde0e118">
<p>
Back next time.
</p>
</div>
</div>
</div>

<div id="outline-container-org4d07d98" class="outline-2">
<h2 id="org4d07d98">Clinic 2022-02-01</h2>
<div class="outline-text-2" id="text-org4d07d98">
</div>
<div id="outline-container-org61d54dd" class="outline-3">
<h3 id="org61d54dd">Your Questions</h3>
<div class="outline-text-3" id="text-org61d54dd">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
<dt>Q</dt><dd>Can a point selection be written to/read from a hypserslab selection?
Does this work in parallel?
<ul class="org-ul">
<li>It appears to work for simple examples in sequential mode</li>
<li>I have yet to try parallel mode</li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-org189ad6f" class="outline-3">
<h3 id="org189ad6f">Last week's highlights</h3>
<div class="outline-text-3" id="text-org189ad6f">
</div>
<ul class="org-ul">
<li><a id="orgfc87ea1"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgbcfd649"></a>Auth0 authentication issues resolved<br />
<div class="outline-text-5" id="text-orgbcfd649">
<ul class="org-ul">
<li>Let us know if you still have issues!</li>
</ul>
</div>
</li>
<li><a id="org16e2407"></a><a href="https://forum.hdfgroup.org/t/tutorial-announcement-constructing-a-simple-terminal-vol-connector/9187">VOL tutorial postponed</a><br />
<div class="outline-text-5" id="text-org16e2407">
<ul class="org-ul">
<li>New date February 25th, 11:00 a.m. to 1:00 p.m. (Central)</li>
<li>You can still register</li>
</ul>
</div>
</li>
<li><a id="org92fca02"></a>Hermes 0.3.0-beta release<br />
<div class="outline-text-5" id="text-org92fca02">
<ul class="org-ul">
<li>Available on <a href="https://github.com/HDFGroup/hermes/releases">GitHub</a></li>
<li>Most notable change: a <a href="https://github.com/HDFGroup/hermes/wiki/Adapters#pubsub-adapter">publisher/subscriber API</a> by Jamie Cernuda</li>
</ul>
</div>
</li>
<li><a id="orgab64a72"></a>Stay tuned for an upcoming blog post<br />
<div class="outline-text-5" id="text-orgab64a72">
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/2022/02/biosimulations-a-platform-for-sharing-and-reusing-biological-simulations/"><i>BioSimulations: a platform for sharing and reusing biological simulations</i></a></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org7cd2486"></a>Forum<br />
<div class="outline-text-4" id="text-org7cd2486">
<ul class="org-ul">
<li>???</li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgff55dbb" class="outline-3">
<h3 id="orgff55dbb">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orgff55dbb">
</div>
<ul class="org-ul">
<li><a id="org008670a"></a>HDFView binaries for Debian and Ubuntu<br />
<div class="outline-text-4" id="text-org008670a">
<ul class="org-ul">
<li>They are well-hidden <code>:-(</code>
<ul class="org-ul">
<li>It takes <b>four</b> clicks to get there (if you know where to go&#x2026;)</li>
</ul></li>
<li>Current version (HDFView 3.1.3) <a href="https://support.hdfgroup.org/ftp/HDF5/releases/HDF-JAVA/hdfview-3.1.3/bin/">link</a>
<ul class="org-ul">
<li><a href="https://support.hdfgroup.org/ftp/HDF5/releases/HDF-JAVA/hdfview-3.1.3/bin/HDFView-3.1.3-ubuntu2004_64.tar.gz">HDFView-3.1.3-ubuntu2004<sub>64.tar.gz</sub></a></li>
<li><a href="https://support.hdfgroup.org/ftp/HDF5/releases/HDF-JAVA/hdfview-3.1.3/bin/HDFView-3.1.3-ubuntu2010_64.tar.gz">HDFView-3.1.3-ubuntu2010<sub>64.tar.gz</sub></a></li>
</ul></li>
<li>Download an unpack (<code>tar -zxvf ...</code>)</li>
<li>Content Debian installer and <code>README.txt</code></li>
<li>Install w/ <code>sudo dpkg -i hdfview_..._amd64deb</code></li>
<li>Installation directories <code>/opt/hdfview/[bin,lib,share]</code></li>
<li>Launch w/ <code>/opt/hdfview/bin/HDFView</code> (add to your <code>PATH</code> as needed)</li>
<li>Does it need to be this hard?</li>
</ul>
</div>
</li>

<li><a id="org5aa5603"></a>One Stop HDF5 - <a href="https://hdflab.hdfgroup.org/">HDF Lab</a><br />
<div class="outline-text-4" id="text-org5aa5603">
<ul class="org-ul">
<li>Your registration w/ the HDF Group website is the ticket</li>
<li>Home directory w/ 10 GB of free storage</li>
<li>HSDS, <code>h5py</code>, <code>h5cc</code></li>
<li>Plenty of examples (Jupyter notebooks, Python scripts, etc.)</li>
<li><i>Coming soon:</i> <a href="https://h5web.panosc.eu/hsds"><code>h5web</code></a></li>
</ul>
</div>
</li>

<li><a id="org44f936f"></a><a href="https://software.pan-data.eu/software/180/h5web"><code>h5web</code></a><br />
<div class="outline-text-4" id="text-org44f936f">
<ul class="org-ul">
<li>Developed by <a href="https://esrf.fr/">ESRF</a></li>
<li><a href="https://reactjs.org/">React</a> components for data visualization and exploration
<ul class="org-ul">
<li>"HDFView for the browser"</li>
</ul></li>
<li><a href="https://github.com/silx-kit/h5web">GitHub</a></li>
<li>Supports HDF5 files in POSIX file systems &amp; HSDS</li>
<li>A JupyterHub plugin, <a href="https://github.com/silx-kit/jupyterlab-h5web">jupyterlab-h5web</a>, is available</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgdf13d34" class="outline-2">
<h2 id="orgdf13d34">Clinic 2022-01-25</h2>
<div class="outline-text-2" id="text-orgdf13d34">
</div>
<div id="outline-container-org872553d" class="outline-3">
<h3 id="org872553d">Your Questions</h3>
<div class="outline-text-3" id="text-org872553d">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
<dt>Q</dt><dd>Can a point selection be written to/read from a hypserslab selection?
Does this work in parallel?
<ul class="org-ul">
<li>It appears to work for simple examples in sequential mode</li>
<li>I have yet to try parallel mode</li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-orgd2c8d5a" class="outline-3">
<h3 id="orgd2c8d5a">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgd2c8d5a">
</div>
<ul class="org-ul">
<li><a id="org5c88e5a"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgdf26eb1"></a>Auth0 authentication issues (apologies&#x2026;)<br /></li>
<li><a id="org28d208f"></a><a href="https://forum.hdfgroup.org/t/tutorial-announcement-constructing-a-simple-terminal-vol-connector/9187">VOL tutorial postponed</a><br />
<div class="outline-text-5" id="text-org28d208f">
<ul class="org-ul">
<li>New date February 25th, 11:00 a.m. to 1:00 p.m. (Central)</li>
<li>You can still register</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org97897e6"></a>Forum<br />
<ul class="org-ul">
<li><a id="org68e8d35"></a><a href="https://forum.hdfgroup.org/t/does-the-mpi-driver-lock-the-file/9318">Does the MPI driver lock the file?</a><br />
<div class="outline-text-5" id="text-org68e8d35">
<ul class="org-ul">
<li>Yes, but I don't understand the user's description</li>
</ul>
<blockquote>
<p>
I implemented a stride which tells the generation script how much work is being
sent to each slave from the master. Now I have 4 datasets and each dataset has
something like 400k entries. Each slave rank will write to all 4 datasets.
</p>

<p>
Now if I set the stride to a low value (10), the generation is way faster than
if I set it to a big value (1024).
</p>

<p>
I wasnt able to find how parallelism is exactly implemented. From the above
behaviour it looks like the file is being locked which then blocks my whole
programm, especially if the stride is big (more time for the other ranks to run
into a lock and be idle inbetween). Is that really the case? I write data
continously, so theoretically there is no need for a lock. Is is possible to
tell the driver dont lock the file?
</p>
</blockquote>
<ul class="org-ul">
<li>What's a 'stride'? (not a hyperslab stride&#x2026;)</li>
<li>Parallelism is implemented through MPI-I/O</li>
<li>How does a file lock block the program?</li>
<li>File locks can be disabled programmatically or via environment variable</li>
</ul>
</div>
</li>
<li><a id="org06f69c6"></a><a href="https://forum.hdfgroup.org/t/h5datatype-with-variable-length-how-to-set-the-values/9162">H5Datatype with variable length: How to set the values?</a><br />
<div class="outline-text-5" id="text-org06f69c6">
<ul class="org-ul">
<li><p>
<a href="https://www.hdfql.com/">HDFql</a> is adding support for variable-length datatypes in JAVA
</p>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">declare Java class that "mimics" the HDF5 compound dataset</span>
<span style="color: #0000FF;">class</span> <span style="color: #6434A3;">Data</span>
{
    <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">myDimension</span>;
    <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">myShapeType</span>;
    <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">myInterpolationType</span>;
    <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">myIntegrationType</span>;
    <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">myNumberOfNormalComponents</span>;
    <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">myNumberOfShearComponents</span>;
    <span style="color: #6434A3;">ArrayList</span> <span style="color: #BA36A5;">myConnectivity</span>;
    <span style="color: #6434A3;">ArrayList</span> <span style="color: #BA36A5;">myFaceConnectivity</span>;
}

<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">declare variables</span>
<span style="color: #6434A3;">Data</span> <span style="color: #BA36A5;">write</span>[] = <span style="color: #0000FF;">new</span> <span style="color: #6434A3;">Data</span>[1];
<span style="color: #6434A3;">Data</span> <span style="color: #BA36A5;">read</span>[] = <span style="color: #0000FF;">new</span> <span style="color: #6434A3;">Data</span>[1];

<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">create HDF5 file 'myFile.h5' and use (i.e. open) it</span>
HDFql.execute(<span style="color: #008000;">"CREATE AND USE FILE myFile.h5"</span>);

<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">create compound dataset 'myDataset'</span>
HDFql.execute(<span style="color: #008000;">"CREATE DATASET myDataset AS COMPOUND(myDimension AS INT, myShapeT</span><span style="color: #008000; background-color: #ff0000;">y</span><span style="color: #008000;">pe AS INT, myInterpolationType AS INT, myIntegrationType AS INT, myNumberOfNormalComponents AS INT, myNumberOfShearComponents AS INT, myConnectivity AS VARINT, myFaceConnectivity AS VARINT)"</span>);

<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">populate variable 'write' with dummy values</span>
write[0] = <span style="color: #0000FF;">new</span> <span style="color: #6434A3;">Data</span>();
write[0].myDimension = 1;
write[0].myShapeType = 2;
write[0].myInterpolationType = 3;
write[0].myIntegrationType = 4;
write[0].myNumberOfNormalComponents = 5;
write[0].myNumberOfShearComponents = 6;
write[0].myConnectivity = <span style="color: #0000FF;">new</span> <span style="color: #6434A3;">ArrayList</span>();
write[0].myConnectivity.add(10);
write[0].myConnectivity.add(20);
write[0].myFaceConnectivity = <span style="color: #0000FF;">new</span> <span style="color: #6434A3;">ArrayList</span>();
write[0].myFaceConnectivity.add(30);
write[0].myFaceConnectivity.add(40);
write[0].myFaceConnectivity.add(50);

<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">write content of variable 'write' into dataset 'myDataset'</span>
HDFql.execute(<span style="color: #008000;">"INSERT INTO myDataset VALUES FROM MEMORY "</span> + HDFql.variableRegist<span style="background-color: #ff0000;">e</span>r(write));

<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">read content of dataset 'myDataset' and populate variable 'read' with it</span>
HDFql.execute(<span style="color: #008000;">"SELECT FROM myDataset INTO MEMORY "</span> + HDFql.variableRegister(read<span style="background-color: #ff0000;">)</span>);

<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">display content of variable 'read'</span>
System.out.println(<span style="color: #008000;">"myDimension: "</span> + read[0].myDimension);
System.out.println(<span style="color: #008000;">"myShapeType: "</span> + read[0].myShapeType);
System.out.println(<span style="color: #008000;">"myInterpolationType: "</span> + read[0].myInterpolationType);
System.out.println(<span style="color: #008000;">"myIntegrationType: "</span> + read[0].myIntegrationType);
System.out.println(<span style="color: #008000;">"myNumberOfNormalComponents: "</span> + read[0].myNumberOfNormalComp<span style="background-color: #ff0000;">o</span>nents);
System.out.println(<span style="color: #008000;">"myNumberOfShearComponents: "</span> + read[0].myNumberOfShearCompon<span style="background-color: #ff0000;">e</span>nts);
<span style="color: #0000FF;">for</span>(<span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">i</span> = 0; i &lt; <span style="color: #6434A3;">read</span>[0].myConnectivity.size(); i++)
    {
        System.out.println(<span style="color: #008000;">"myConnectivity: "</span> + read[0].myConnectivity.get(i));
    }
<span style="color: #0000FF;">for</span>(<span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">i</span> = 0; i &lt; <span style="color: #6434A3;">read</span>[0].myFaceConnectivity.size(); i++)
    {
        System.out.println(<span style="color: #008000;">"myFaceConnectivity: "</span> + read[0].myFaceConnectivity.g<span style="background-color: #ff0000;">e</span>t(i));
    }
</pre>
</div></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orge717292" class="outline-3">
<h3 id="orge717292">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orge717292">
</div>
<ul class="org-ul">
<li><a id="org9edaf66"></a>HDF5 - the better TXT format<br />
<div class="outline-text-4" id="text-org9edaf66">
<ul class="org-ul">
<li>Source in <a href="https://github.com/gheber/h5zip">GitHub repo</a></li>
<li>Basic idea (Joe Lee): Store text files as compressed byte streams in HDF5 files.</li>
<li><b>Pros:</b>
<ul class="org-ul">
<li>Passes the <code>diff</code> test</li>
<li>Size reduction</li>
<li>Portable metadata + rich annotation
<ul class="org-ul">
<li>Unicode encoding</li>
<li>Dataset region references</li>
</ul></li>
</ul></li>
<li><b>Cons:</b>
<ul class="org-ul">
<li>Not suitable as editor back-ends</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org91876b7" class="outline-2">
<h2 id="org91876b7">Clinic 2022-01-18</h2>
<div class="outline-text-2" id="text-org91876b7">
</div>
<div id="outline-container-org520be6f" class="outline-3">
<h3 id="org520be6f">Your Questions</h3>
<div class="outline-text-3" id="text-org520be6f">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
<dt>Q</dt><dd>Can a point selection be written to/read from a hypserslab selection?
Does this work in parallel?
<ul class="org-ul">
<li>It appears to work for simple examples in sequential mode</li>
<li>I have yet to try parallel mode</li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-orgd2b1ccb" class="outline-3">
<h3 id="orgd2b1ccb">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgd2b1ccb">
</div>
<ul class="org-ul">
<li><a id="org8d8218c"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org30f31cf"></a><a href="https://forum.hdfgroup.org/t/tutorial-announcement-constructing-a-simple-terminal-vol-connector/9187">VOL tutorial postponed</a><br />
<div class="outline-text-5" id="text-org30f31cf">
<ul class="org-ul">
<li>New date February 25th, 11:00 a.m. to 1:00 p.m. (Central)</li>
<li>You can still register</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org63be65a"></a>Forum<br />
<ul class="org-ul">
<li><a id="org4f000e6"></a><a href="https://forum.hdfgroup.org/t/is-hsds-self-hosted/9315">Is HSDS self-hosted?</a><br />
<div class="outline-text-5" id="text-org4f000e6">
<ul class="org-ul">
<li>Can I host it myself?
<ul class="org-ul">
<li>Yes, you can!</li>
</ul></li>
<li>References:
<ul class="org-ul">
<li><a href="https://github.com/HDFGroup/hsds">Quick Start</a></li>
<li><p>
Python: <a href="https://github.com/HDFGroup/h5pyd"><code>h5pyd</code></a> via <code>pip</code>.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">import</span> h5pyd <span style="color: #0000FF;">as</span> h5py
...
</pre>
</div></li>
<li><a href="https://www.youtube.com/watch?v=9b5TO7drqqE&amp;t=2161s">Learn about the open source Highly Scalable Data Service (HSDS) Webinar</a></li>
<li><a href="https://www.hdfgroup.org/hdfkitalab/">HDF Lab</a></li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orgeb89d44"></a><a href="https://forum.hdfgroup.org/t/convert-seismic-data-segy-format-to-hdf5-data/9337">convert seismic data (segy format) to HDF5 data?</a><br />
<div class="outline-text-5" id="text-orgeb89d44">
<ul class="org-ul">
<li>Not really a problem for "geeks"</li>
<li><a href="https://academic.oup.com/gji/article/207/2/1003/2583765">An Adaptable Seismic Data Format</a></li>
<li><a href="https://seismic-data.org/">Seismic Data</a></li>
</ul>
</div>
</li>
<li><a id="orgbb297d1"></a><a href="https://forum.hdfgroup.org/t/hdf5-doesnt-support-writing-vlens-with-parallel-i-o/4420">HDF5 doesnt support writing VLENs with parallel I/O?</a><br />
<div class="outline-text-5" id="text-orgbb297d1">
<ul class="org-ul">
<li>Current (internal) VL representation is rather inefficient</li>
<li>Fix/revise first, then parallelization</li>
</ul>
</div>
</li>
<li><a id="orgaa270d5"></a><a href="https://forum.hdfgroup.org/t/error-when-selecting-and-writing-an-element-dataset-hdf5-1-10-4/9330">Error when selecting and writing an element dataset hdf5 1.10.4</a><br />
<div class="outline-text-5" id="text-orgaa270d5">
<ul class="org-ul">
<li>(Bogus) Error message suggests that <code>H5T_NATIVE_DOUBLE</code> is not a valid datatype</li>
<li>Maybe shared library not found or multiple copies?</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org74d994e" class="outline-3">
<h3 id="org74d994e">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org74d994e">
</div>
<ul class="org-ul">
<li><a id="orgad753dd"></a>Highly Scalable Data Service (HSDS)<br />
<div class="outline-text-4" id="text-orgad753dd">
<ul class="org-ul">
<li>"HDF5 as a Service"</li>
<li>REpresentational State Transfer (<a href="https://en.wikipedia.org/wiki/Representational_state_transfer">REST</a>)</li>
<li><a href="https://www.hdfgroup.org/hdfkitalab/">HDF Lab</a> has a few examples</li>
<li>Let's do it! (from Emacs)</li>
<li>HDF5 file "=" HSDS domain</li>
<li><p>
Querying a domain
</p>
<div class="org-src-container">
<pre class="src src-restclient">
<span style="color: #0000FF;">GET</span> <span style="color: #006699;">http://hsdshdflab.hdfgroup.org/?domain=/shared/tall.h5</span>

</pre>
</div>

<div class="org-src-container">
<pre class="src src-js">{
  <span style="color: #008000;">"root"</span>: <span style="color: #008000;">"g-d38053ea-3418fe27-5b08-db62bc-9076af"</span>,
  <span style="color: #008000;">"class"</span>: <span style="color: #008000;">"domain"</span>,
  <span style="color: #008000;">"owner"</span>: <span style="color: #008000;">"admin"</span>,
  <span style="color: #008000;">"created"</span>: 1622930252.3698952,
  <span style="color: #008000;">"limits"</span>: {
    <span style="color: #008000;">"min_chunk_size"</span>: 1048576,
    <span style="color: #008000;">"max_chunk_size"</span>: 4194304,
    <span style="color: #008000;">"max_request_size"</span>: 104857600
  },
  <span style="color: #008000;">"compressors"</span>: [
    <span style="color: #008000;">"blosclz"</span>,
    <span style="color: #008000;">"lz4"</span>,
    <span style="color: #008000;">"lz4hc"</span>,
    <span style="color: #008000;">"gzip"</span>,
    <span style="color: #008000;">"zstd"</span>,
    <span style="color: #008000;">"deflate"</span>
  ],
  <span style="color: #008000;">"version"</span>: <span style="color: #008000;">"0.7.0beta"</span>,
  <span style="color: #008000;">"lastModified"</span>: 1623085764.3507726,
  <span style="color: #008000;">"hrefs"</span>: [
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"self"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/?domain=/shared/tall.h5"</span>
    },
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"database"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/datasets?domain=/shared/tall.h5"</span>
    },
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"groupbase"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/groups?domain=/shared/tall.h5"</span>
    },
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"typebase"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/datatypes?domain=/shared/tall.h5"</span>
    },
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"root"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/groups/g-d38053ea-3418fe27-5b08-db</span><span style="color: #008000; background-color: #ff0000;">6</span><span style="color: #008000;">2bc-9076af?domain=/shared/tall.h5"</span>
    },
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"acls"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/acls?domain=/shared/tall.h5"</span>
    },
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"parent"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/?domain=hdflab2/shared"</span>
    }
  ]
}
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">GET http://hsdshdflab.hdfgroup.org/?domain=/shared/tall.h5</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">HTTP/1.1 200 OK</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Content-Type: application/json; charset=utf-8</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Date: Tue, 19 Jul 2022 17:04:44 GMT</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Server: Python/3.9 aiohttp/3.8.1</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Content-Length: 1024</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Connection: keep-alive</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Request duration: 0.246628s</span>
</pre>
</div></li>

<li><p>
Querying the HDF5 root group w/ resource ID <code>g-d38053ea-3418fe27-5b08-db62bc-9076af</code>
</p>
<div class="org-src-container">
<pre class="src src-restclient">
<span style="color: #0000FF;">GET</span> <span style="color: #006699;">http://hsdshdflab.hdfgroup.org/groups/g-d38053ea-3418fe27-5b08-db62bc-9076af/links?domain=/shared/tall.h5</span>

</pre>
</div>

<div class="org-src-container">
<pre class="src src-js">{
  <span style="color: #008000;">"links"</span>: [
    {
      <span style="color: #008000;">"class"</span>: <span style="color: #008000;">"H5L_TYPE_HARD"</span>,
      <span style="color: #008000;">"id"</span>: <span style="color: #008000;">"g-d38053ea-3418fe27-3227-467313-8ebf63"</span>,
      <span style="color: #008000;">"created"</span>: 1622930252.985488,
      <span style="color: #008000;">"title"</span>: <span style="color: #008000;">"g1"</span>,
      <span style="color: #008000;">"collection"</span>: <span style="color: #008000;">"groups"</span>,
      <span style="color: #008000;">"target"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/groups/g-d38053ea-3418fe27-3227-</span><span style="color: #008000; background-color: #ff0000;">4</span><span style="color: #008000;">67313-8ebf63?domain=/shared/tall.h5"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/groups/g-d38053ea-3418fe27-5b08-db</span><span style="color: #008000; background-color: #ff0000;">6</span><span style="color: #008000;">2bc-9076af/links/g1?domain=/shared/tall.h5"</span>
    },
    {
      <span style="color: #008000;">"class"</span>: <span style="color: #008000;">"H5L_TYPE_HARD"</span>,
      <span style="color: #008000;">"id"</span>: <span style="color: #008000;">"g-d38053ea-3418fe27-96ba-7678c2-3d4bcb"</span>,
      <span style="color: #008000;">"created"</span>: 1622930252.5707703,
      <span style="color: #008000;">"title"</span>: <span style="color: #008000;">"g2"</span>,
      <span style="color: #008000;">"collection"</span>: <span style="color: #008000;">"groups"</span>,
      <span style="color: #008000;">"target"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/groups/g-d38053ea-3418fe27-96ba-</span><span style="color: #008000; background-color: #ff0000;">7</span><span style="color: #008000;">678c2-3d4bcb?domain=/shared/tall.h5"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/groups/g-d38053ea-3418fe27-5b08-db</span><span style="color: #008000; background-color: #ff0000;">6</span><span style="color: #008000;">2bc-9076af/links/g2?domain=/shared/tall.h5"</span>
    }
  ],
  <span style="color: #008000;">"hrefs"</span>: [
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"self"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/groups/g-d38053ea-3418fe27-5b08-db</span><span style="color: #008000; background-color: #ff0000;">6</span><span style="color: #008000;">2bc-9076af/links?domain=/shared/tall.h5"</span>
    },
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"home"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/?domain=/shared/tall.h5"</span>
    },
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"owner"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/groups/g-d38053ea-3418fe27-5b08-db</span><span style="color: #008000; background-color: #ff0000;">6</span><span style="color: #008000;">2bc-9076af?domain=/shared/tall.h5"</span>
    }
  ]
}
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">GET http://hsdshdflab.hdfgroup.org/groups/g-d38053ea-3418fe27-5b08-db62bc-907</span><span style="color: #8D8D84; background-color: #ff0000; font-style: italic;">6</span><span style="color: #8D8D84; font-style: italic;">af/links?domain=/shared/tall.h5</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">HTTP/1.1 200 OK</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Content-Type: application/json; charset=utf-8</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Date: Tue, 19 Jul 2022 17:04:44 GMT</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Server: Python/3.9 aiohttp/3.8.1</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Content-Length: 1125</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Connection: keep-alive</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Request duration: 0.079325s</span>
</pre>
</div></li>

<li><p>
Let's look at a dataset
</p>
<div class="org-src-container">
<pre class="src src-restclient">
<span style="color: #0000FF;">GET</span> <span style="color: #006699;">http://hsdshdflab.hdfgroup.org/datasets/d-d38053ea-3418fe27-cb7b-00379e-75d3e8?domain=/shared/tall.h5</span>

</pre>
</div>

<div class="org-src-container">
<pre class="src src-js">{
  <span style="color: #008000;">"id"</span>: <span style="color: #008000;">"d-d38053ea-3418fe27-cb7b-00379e-75d3e8"</span>,
  <span style="color: #008000;">"root"</span>: <span style="color: #008000;">"g-d38053ea-3418fe27-5b08-db62bc-9076af"</span>,
  <span style="color: #008000;">"shape"</span>: {
    <span style="color: #008000;">"class"</span>: <span style="color: #008000;">"H5S_SIMPLE"</span>,
    <span style="color: #008000;">"dims"</span>: [
      10
    ],
    <span style="color: #008000;">"maxdims"</span>: [
      10
    ]
  },
  <span style="color: #008000;">"type"</span>: {
    <span style="color: #008000;">"class"</span>: <span style="color: #008000;">"H5T_FLOAT"</span>,
    <span style="color: #008000;">"base"</span>: <span style="color: #008000;">"H5T_IEEE_F32BE"</span>
  },
  <span style="color: #008000;">"creationProperties"</span>: {
    <span style="color: #008000;">"layout"</span>: {
      <span style="color: #008000;">"class"</span>: <span style="color: #008000;">"H5D_CHUNKED"</span>,
      <span style="color: #008000;">"dims"</span>: [
        10
      ]
    },
    <span style="color: #008000;">"fillTime"</span>: <span style="color: #008000;">"H5D_FILL_TIME_ALLOC"</span>
  },
  <span style="color: #008000;">"layout"</span>: {
    <span style="color: #008000;">"class"</span>: <span style="color: #008000;">"H5D_CHUNKED"</span>,
    <span style="color: #008000;">"dims"</span>: [
      10
    ]
  },
  <span style="color: #008000;">"attributeCount"</span>: 0,
  <span style="color: #008000;">"created"</span>: 1622930252,
  <span style="color: #008000;">"lastModified"</span>: 1622930252,
  <span style="color: #008000;">"domain"</span>: <span style="color: #008000;">"/shared/tall.h5"</span>,
  <span style="color: #008000;">"hrefs"</span>: [
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"self"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/datasets/d-d38053ea-3418fe27-cb7b-</span><span style="color: #008000; background-color: #ff0000;">0</span><span style="color: #008000;">0379e-75d3e8?domain=/shared/tall.h5"</span>
    },
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"root"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/groups/g-d38053ea-3418fe27-5b08-db</span><span style="color: #008000; background-color: #ff0000;">6</span><span style="color: #008000;">2bc-9076af?domain=/shared/tall.h5"</span>
    },
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"home"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/?domain=/shared/tall.h5"</span>
    },
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"attributes"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/datasets/d-d38053ea-3418fe27-cb7b-</span><span style="color: #008000; background-color: #ff0000;">0</span><span style="color: #008000;">0379e-75d3e8/attributes?domain=/shared/tall.h5"</span>
    },
    {
      <span style="color: #008000;">"rel"</span>: <span style="color: #008000;">"data"</span>,
      <span style="color: #008000;">"href"</span>: <span style="color: #008000;">"http://hsdshdflab.hdfgroup.org/datasets/d-d38053ea-3418fe27-cb7b-</span><span style="color: #008000; background-color: #ff0000;">0</span><span style="color: #008000;">0379e-75d3e8/value?domain=/shared/tall.h5"</span>
    }
  ]
}
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">GET http://hsdshdflab.hdfgroup.org/datasets/d-d38053ea-3418fe27-cb7b-00379e-7</span><span style="color: #8D8D84; background-color: #ff0000; font-style: italic;">5</span><span style="color: #8D8D84; font-style: italic;">d3e8?domain=/shared/tall.h5</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">HTTP/1.1 200 OK</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Content-Type: application/json; charset=utf-8</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Date: Tue, 19 Jul 2022 17:04:45 GMT</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Server: Python/3.9 aiohttp/3.8.1</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Content-Length: 1116</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Connection: keep-alive</span>
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Request duration: 0.085401s</span>
</pre>
</div></li>

<li>Check it out with your favorite REST client!</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-orga1a3fd3" class="outline-2">
<h2 id="orga1a3fd3">Clinic 2022-01-11</h2>
<div class="outline-text-2" id="text-orga1a3fd3">
</div>
<div id="outline-container-orgfd80f17" class="outline-3">
<h3 id="orgfd80f17">Your Questions</h3>
<div class="outline-text-3" id="text-orgfd80f17">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
<dt>Q</dt><dd>Can a point selection be written to/read from a hypserslab selection?
Does this work in parallel?
<ul class="org-ul">
<li>It appears to work for simple examples in sequential mode</li>
<li>I have yet to try parallel mode</li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-org5631d6d" class="outline-3">
<h3 id="org5631d6d">Last week's highlights</h3>
<div class="outline-text-3" id="text-org5631d6d">
</div>
<ul class="org-ul">
<li><a id="org90d1e57"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org202142f"></a><a href="https://forum.hdfgroup.org/t/tutorial-announcement-constructing-a-simple-terminal-vol-connector/9187">VOL tutorial postponed</a><br />
<div class="outline-text-5" id="text-org202142f">
<ul class="org-ul">
<li>New date February 25th, 11:00 a.m. to 1:00 p.m. (Central)</li>
<li>You can still register</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="orgd851b1f"></a>Forum<br />
<ul class="org-ul">
<li><a id="org36755bc"></a><a href="https://forum.hdfgroup.org/t/select-hyperslab-of-vl-data/9300">select hyperslab of VL data</a><br />
<div class="outline-text-5" id="text-org36755bc">
<ul class="org-ul">
<li>Two issues:
<ol class="org-ol">
<li>Getting the selections right</li>
<li><p>
Dealing w/ VLEN data
</p>
<div class="org-src-container">
<pre class="src src-C">
<span style="color: #0000FF;">struct</span> <span style="color: #6434A3;">s_data</span> {
    <span style="color: #6434A3;">uint64_t</span> <span style="color: #BA36A5;">b</span>;
    <span style="color: #6434A3;">uint16_t</span> <span style="color: #BA36A5;">a</span>;
};

<span style="color: #0000FF;">struct</span> <span style="color: #6434A3;">ext_data3</span> {
    <span style="color: #6434A3;">uint64_t</span> <span style="color: #BA36A5;">a</span>;
    <span style="color: #6434A3;">uint32_t</span> <span style="color: #BA36A5;">b</span>;
    <span style="color: #6434A3;">int16_t</span> <span style="color: #BA36A5;">nelem</span>;
    <span style="color: #0000FF;">struct</span> <span style="color: #6434A3;">s_data</span> <span style="color: #BA36A5;">data</span>[3];  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">&lt;- ARRAY</span>
};

<span style="color: #0000FF;">struct</span> <span style="color: #6434A3;">ext_data</span> {
    <span style="color: #6434A3;">uint64_t</span> <span style="color: #BA36A5;">a</span>;
    <span style="color: #6434A3;">uint32_t</span> <span style="color: #BA36A5;">b</span>;
    <span style="color: #6434A3;">int16_t</span> <span style="color: #BA36A5;">nelem</span>;
    <span style="color: #0000FF;">struct</span> <span style="color: #6434A3;">s_data</span> <span style="color: #BA36A5;">data</span>[];   <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">&lt;- VLEN</span>
};

</pre>
</div>
<ul class="org-ul">
<li>Nested compound (surface) datatype</li>
<li>Attempted byte-stream representation as <code>\0</code>-terminated VLEN string</li>
</ul></li>
</ol></li>
</ul>
</div>
</li>
<li><a id="org16c341b"></a><a href="https://forum.hdfgroup.org/t/dynamically-change-the-file-access-property-list/9314">Dynamically change the File Access Property List</a><br />
<div class="outline-text-5" id="text-org16c341b">
<ul class="org-ul">
<li>File access properties
<ul class="org-ul">
<li>Vs. file creation properties</li>
</ul></li>
<li><p>
Set before file creation or file open
</p>
<div class="org-src-container">
<pre class="src src-C"><span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">fapl</span> = H5Pcreate(H5P_FILE_ACCESS);
<span style="color: #006699;">H5Pset_alignment</span>(<span style="color: #6434A3;">fapl</span>, <span style="color: #6434A3;">threshold</span>, <span style="color: #6434A3;">alignment</span>);
...
H5Fopen(..., fapl) <span style="color: #6434A3;">or</span>  <span style="color: #006699;">H5Fcreate</span>(..., <span style="color: #6434A3;">fapl</span>)
...
</pre>
</div></li>
<li>What is the use case for changing them dynamically?
<ul class="org-ul">
<li>Wouldn't make sense for some properties, e.g., VFD</li>
<li>Dynamic alignment changes, why?</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org88c15a9" class="outline-3">
<h3 id="org88c15a9">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org88c15a9">
</div>
<ul class="org-ul">
<li><a id="org48a139c"></a>HDF5 snippets<br />
<div class="outline-text-4" id="text-org48a139c">
<ul class="org-ul">
<li>Developer productivity
<ul class="org-ul">
<li>IntelliSense in VSCode</li>
<li><a href="https://github.com/Microsoft/language-server-protocol/">Language Server Protocol (LSP)</a></li>
<li>Emacs has support for LSP via <a href="https://emacs-lsp.github.io/lsp-mode/"><code>lsp-mode</code></a>
<ul class="org-ul">
<li>Resource-intensive</li>
<li>Not a templating mechanism</li>
</ul></li>
<li><a href="https://github.com/joaotavora/yasnippet">YASnippet</a> is a template system for Emacs</li>
<li><p>
Easy to install and configure
</p>
<div class="org-src-container">
<pre class="src src-elisp">
(<span style="color: #0000FF;">use-package</span> <span style="color: #D0372D;">yasnippet</span>
  <span style="color: #006FE0;">:custom</span>
  (yas-triggers-in-field t)
  <span style="color: #006FE0;">:config</span>
  (<span style="color: #0000FF;">setq</span> yas-snippet-dirs <span style="color: #008000;">"~/.emacs.d/snippets"</span>)
  (yas-global-mode 1))

</pre>
</div></li>
<li>A (growing) set of snippets can be found <a href="https://github.com/HDFGroup/emacs/tree/master/snippets">here</a></li>
<li>Demo</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org1ba9c4a" class="outline-2">
<h2 id="org1ba9c4a">Clinic 2022-01-04</h2>
<div class="outline-text-2" id="text-org1ba9c4a">
</div>
<div id="outline-container-org67a2431" class="outline-3">
<h3 id="org67a2431">Your Questions</h3>
<div class="outline-text-3" id="text-org67a2431">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
<dt>Q</dt><dd>Can a point selection be written to/read from a hypserslab selection?
Does this work in parallel?
<ul class="org-ul">
<li>It appears to work for simple examples in sequential mode</li>
<li>I have yet to try parallel mode</li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-org07d50a5" class="outline-3">
<h3 id="org07d50a5">Last week's highlights</h3>
<div class="outline-text-3" id="text-org07d50a5">
</div>
<ul class="org-ul">
<li><a id="org30063ca"></a>Announcements<br />
<div class="outline-text-4" id="text-org30063ca">
<p>
Happy New Year!
</p>
</div>
</li>
<li><a id="org9e62ebd"></a>Forum<br />
<ul class="org-ul">
<li><a id="orga919148"></a><a href="https://forum.hdfgroup.org/t/repair-corrupted-file/9288">Repair corrupted file</a><br />
<div class="outline-text-5" id="text-orga919148">
<ul class="org-ul">
<li>There's no general tool for that (yet)</li>
<li><p>
Rigorous error checking and resource handling goes a long way
</p>
<div class="org-src-container">
<pre class="src src-C">{
  <span style="color: #6434A3;">__label__</span> <span style="color: #BA36A5;">fail_file</span>;
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file</span>, <span style="color: #BA36A5;">group</span>;
  <span style="color: #6434A3;">char</span>  <span style="color: #BA36A5;">src_path</span>[] = <span style="color: #008000;">"/a/few/groups"</span>;

  <span style="color: #0000FF;">if</span> ((file = H5Fcreate(<span style="color: #008000;">"o1.h5"</span>, H5F_ACC_TRUNC, H5P_DEFAULTx2)) ==
       H5I_INVALID_HID) {
    ret_val = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">create a few groups</span>
  {
    <span style="color: #6434A3;">__label__</span> <span style="color: #BA36A5;">fail_group</span>, <span style="color: #BA36A5;">fail_lcpl</span>;
    <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">lcpl</span>;
    <span style="color: #0000FF;">if</span> ((lcpl = H5Pcreate(H5P_LINK_CREATE)) == H5I_INVALID_HID) {
      ret_val = EXIT_FAILURE;
      <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_lcpl</span>;
    }
    <span style="color: #0000FF;">if</span> (H5Pset_create_intermediate_group(lcpl, 1) &lt; 0) {
      ret_val = EXIT_FAILURE;
      <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_group</span>;
    }
    <span style="color: #0000FF;">if</span> ((group = H5Gcreate(file, src_path, lcpl, H5P_DEFAULTx2)) ==
         H5I_INVALID_HID) {
      ret_val = EXIT_FAILURE;
      <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_group</span>;
    }

    H5Gclose(group);
  <span style="color: #D0372D;">fail_group</span>:
    H5Pclose(lcpl);
  <span style="color: #D0372D;">fail_lcpl</span>:;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">create a copy</span>
  <span style="color: #0000FF;">if</span> (H5Ocopy(file, <span style="color: #008000;">"."</span>, file, <span style="color: #008000;">"copy of"</span>, H5P_DEFAULTx2) &lt; 0) {
    ret_val = EXIT_FAILURE;
  }

  H5Fclose(file);
<span style="color: #D0372D;">fail_file</span>:;
}
</pre>
</div></li>
<li>This looks pretty awkward, but there's some method to the madness&#x2026;</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orga69b812" class="outline-3">
<h3 id="orga69b812">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orga69b812">
</div>
<ul class="org-ul">
<li><a id="org9657ca2"></a><a href="https://forum.hdfgroup.org/t/hdfql-emacs-org-winning-combo/9241">A GUI for HDFql</a><br />
<div class="outline-text-4" id="text-org9657ca2">
<ul class="org-ul">
<li><a href="https://www.hdfql.com/">HDFql</a> is the <a href="https://en.wikipedia.org/wiki/La-Z-Boy">La-Z-Boy</a> of HDF5 interfaces
<ul class="org-ul">
<li>SQL is convenient and concise because we say what we want (declarative) rather
than how to do it (imperative).</li>
</ul></li>
<li><p>
Example (evaluate with <code>C-c C-c</code>):
</p>
<div class="org-src-container">
<pre class="src src-hdfql">
<span style="color: #0000FF;">CREATE</span> <span style="color: #0000FF;">TRUNCATE</span> <span style="color: #0000FF;">AND</span> <span style="color: #0000FF;">USE</span> <span style="color: #006699;">FILE</span> my_file.h5

<span style="color: #0000FF;">CREATE</span> <span style="color: #006699;">DATASET</span> my_group/my_dataset <span style="color: #0000FF;">AS</span> <span style="color: #6434A3;">double</span>(3) <span style="color: #0000FF;">ENABLE</span> zlib <span style="color: #0000FF;">LEVEL</span> 0 <span style="color: #0000FF;">VALUES</span>(4, 8,<span style="background-color: #ff0000;"> </span>6)

<span style="color: #0000FF;">SELECT</span> <span style="color: #0000FF;">FROM</span> <span style="color: #006699;">DATASET</span> my_group/my_dataset

</pre>
</div></li>

<li><p>
Really?
</p>
<div class="org-src-container">
<pre class="src src-shell">
h5dump -p my_file.h5

</pre>
</div></li>

<li><b>Homework:</b> What's the line count of an program written in C?</li>
<li><a href="https://www.gnu.org/software/emacs/">Emacs</a> supports the execution of source code blocks in <a href="https://orgmode.org/">Org mode</a></li>
<li>HDFql comes with a command line interface</li>
<li><p>
Combine the two w/ a snippet of <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/">Emacs Lisp</a> code
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">We assume that HDFqlCLI is in the path and that libHDFql.so is in</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">the LD_LIBRARY_PATH.</span>

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">org-babel-execute:hdfql</span> (body params)
  <span style="color: #036A07;">"Execute a block of HDFql code with org-babel."</span>
  (message <span style="color: #008000;">"executing HDFql source code block"</span>)
  (org-babel-eval
   (format <span style="color: #008000;">"HDFqlCLI --no-status --execute=\"%s\""</span> body) <span style="color: #008000;">""</span>))

(<span style="color: #0000FF;">push</span> '(<span style="color: #008000;">"hdfql"</span> . sql) org-src-lang-modes)

(add-to-list 'org-structure-template-alist '(<span style="color: #008000;">"hq"</span> . <span style="color: #008000;">"src hdfql"</span>))

</pre>
</div></li>
<li>The rest is cosmetics</li>
<li>See <a href="https://github.com/HDFGroup/emacs">this GitHub repo</a> for HDF5 support in Emacs</li>
<li>Fork and create a PR, if you are interested in pushing this forward!</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org5e4c291" class="outline-2">
<h2 id="org5e4c291">Clinic 2021-12-21</h2>
<div class="outline-text-2" id="text-org5e4c291">
</div>
<div id="outline-container-org13f2146" class="outline-3">
<h3 id="org13f2146">Your Questions</h3>
<div class="outline-text-3" id="text-org13f2146">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
<dt>Q</dt><dd>Can a point selection be written to/read from a hypserslab selection?
Does this work in parallel?
<ul class="org-ul">
<li>It appears to work for simple examples in sequential mode</li>
<li>I have yet to try parallel mode</li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-orgdcde0e5" class="outline-3">
<h3 id="orgdcde0e5">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgdcde0e5">
</div>
<ul class="org-ul">
<li><a id="org4ad2c8d"></a>Announcements<br />
<div class="outline-text-4" id="text-org4ad2c8d">
<p>
Nothing to report.
</p>
</div>
</li>
<li><a id="orgd751c68"></a>Forum<br />
<ul class="org-ul">
<li><a id="orge80819b"></a><a href="https://forum.hdfgroup.org/t/memory-management-in-conversions-of-variable-length-data-types/9250">Memory management in conversions of variable length data types</a><br />
<div class="outline-text-5" id="text-orge80819b">
<ul class="org-ul">
<li><p>
Reading data represented as HDF5 variable-length sequences. =&gt; <a href="https://docs.hdfgroup.org/hdf5/develop/structhvl__t.html"><code>hvl_t</code></a>
</p>
<div class="org-src-container">
<pre class="src src-C">
<span style="color: #0000FF;">typedef</span> <span style="color: #0000FF;">struct</span> {
    <span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">len</span>; <span style="color: #036A07;">/**&lt; Length of VL data (in base type units) */</span>
    <span style="color: #6434A3;">void</span> * <span style="color: #BA36A5;">p</span>;   <span style="color: #036A07;">/**&lt; Pointer to VL data */</span>
} <span style="color: #6434A3;">hvl_t</span>;

</pre>
</div></li>
<li>Who owns the memory attached to <code>p</code>?</li>
<li><b>The caller!</b> Clean up w/ <a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_d.html#ga222a2fd93868e2524b2e42c3c6146119"><code>H5Dvlen_reclaim</code></a> (pre-HDF5 1.12.x) or <a href="https://docs.hdfgroup.org/hdf5/develop/group___v_l_e_n.html#ga6851783a68a0f868c27300cb5622fbbe"><code>H5Treclaim</code></a>
(HDF5 1.12+)</li>
</ul>
</div>
</li>
<li><a id="orgd4e1217"></a><a href="https://forum.hdfgroup.org/t/read-write-compound-containing-std-string-using-native-c-hdf5-lib/9258">Read/write compound containing `std::string` using native C hdf5 lib</a><br />
<div class="outline-text-5" id="text-orgd4e1217">
<ul class="org-ul">
<li>Don't pass C++ objects as arguments to C library functions!
<ul class="org-ul">
<li>You might get lucky, but you are relying on compiler peculiarities.
<ul class="org-ul">
<li><i>Your luck will run out eventually.</i></li>
</ul></li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-C++">
<span style="color: #0000FF;">typedef</span> <span style="color: #0000FF;">struct</span> {
    <span style="color: #6434A3;">int</span>     <span style="color: #BA36A5;">serial_no</span>;
    <span style="color: #D0372D;">std</span>::<span style="color: #6434A3;">string</span> <span style="color: #BA36A5;">location</span>;  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">CHANGED FROM char* to std::string</span>
    <span style="color: #6434A3;">double</span>  <span style="color: #BA36A5;">temperature</span>;
    <span style="color: #6434A3;">double</span>  <span style="color: #BA36A5;">pressure</span>;
} <span style="color: #6434A3;">sensor_t</span>;

</pre>
</div>
<ul class="org-ul">
<li>Works with <code>H5Dwrite</code> for strings of a certain size, fails for <code>H5Dread</code></li>
<li>See <a href="https://joellaity.com/2020/01/31/string.html">libc++'s implementation of <code>std::string</code></a> by Joel Laity for details.</li>
</ul>
</div>
</li>
<li><a id="org775e04c"></a><a href="https://forum.hdfgroup.org/t/merge-2-groups-from-the-same-h5-file/9260">Merge 2 groups from the same h5 file</a><br />
<div class="outline-text-5" id="text-org775e04c">
<ul class="org-ul">
<li><p>
Simple example
</p>
<pre class="example" id="org4279d4c">

               ?
/G1/D + /G2/D ---&gt; /G3/(  = /G1/D + G2/D )

</pre></li>
<li>In this simple example, we want to "append" the elements of the dataset
<code>/G2/D</code> to the elements of the dataset <code>/G1/D</code></li>
<li>Question: Is copying dataset elements problematic?
<dl class="org-dl">
<dt>YES</dt><dd>Use virtual datasets! The also provides maximum flexibility in
defining  and mapping the constituent datasets.
<ul class="org-ul">
<li>If you are using an older version of HDF5, you could define a dataset of
region references to fake virtual datasets. This is much less convenient.</li>
</ul></dd>
<dt>NO</dt><dd>Pedestrian approach: create a new (joint) dataset which can accommodate
the constituent datasets and read and write the elements from the
constituents.
<ul class="org-ul">
<li><b>Wrinkle:</b> The constituent datasets are too large and to fit into memory.
<ul class="org-ul">
<li>Page your way through the constituents!</li>
</ul></li>
</ul></dd>
</dl></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org9754454" class="outline-3">
<h3 id="org9754454">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org9754454">
</div>
<ul class="org-ul">
<li><a id="org30d0f7b"></a><a href="https://forum.hdfgroup.org/t/hdfql-emacs-org-winning-combo/9241">A GUI for HDFql</a><br />
<div class="outline-text-4" id="text-org30d0f7b">
<ul class="org-ul">
<li><a href="https://www.hdfql.com/">HDFql</a> is the <a href="https://en.wikipedia.org/wiki/La-Z-Boy">La-Z-Boy</a> of HDF5 interfaces
<ul class="org-ul">
<li>SQL is convenient and concise because we say what we want (declarative) rather
than how to do it (imperative).</li>
</ul></li>
<li><p>
Example (evaluate with <code>C-c C-c</code>):
</p>
<div class="org-src-container">
<pre class="src src-hdfql">
<span style="color: #0000FF;">CREATE</span> <span style="color: #0000FF;">TRUNCATE</span> <span style="color: #0000FF;">AND</span> <span style="color: #0000FF;">USE</span> <span style="color: #006699;">FILE</span> my_file.h5

<span style="color: #0000FF;">CREATE</span> <span style="color: #006699;">DATASET</span> my_group/my_dataset <span style="color: #0000FF;">AS</span> <span style="color: #6434A3;">double</span>(3) <span style="color: #0000FF;">ENABLE</span> zlib <span style="color: #0000FF;">LEVEL</span> 0 <span style="color: #0000FF;">VALUES</span>(4, 8,<span style="background-color: #ff0000;"> </span>6)

<span style="color: #0000FF;">SELECT</span> <span style="color: #0000FF;">FROM</span> <span style="color: #006699;">DATASET</span> my_group/my_dataset

</pre>
</div></li>

<li><p>
Really?
</p>
<div class="org-src-container">
<pre class="src src-shell">
h5dump -p my_file.h5

</pre>
</div></li>

<li><b>Homework:</b> What's the line count of an program written in C?</li>
<li><a href="https://www.gnu.org/software/emacs/">Emacs</a> supports the execution of source code blocks in <a href="https://orgmode.org/">Org mode</a></li>
<li>HDFql comes with a command line interface</li>
<li><p>
Combine the two w/ a snippet of <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/">Emacs Lisp</a> code
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">We assume that HDFqlCLI is in the path and that libHDFql.so is in</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">the LD_LIBRARY_PATH.</span>

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">org-babel-execute:hdfql</span> (body params)
  <span style="color: #036A07;">"Execute a block of HDFql code with org-babel."</span>
  (message <span style="color: #008000;">"executing HDFql source code block"</span>)
  (org-babel-eval
   (format <span style="color: #008000;">"HDFqlCLI --no-status --execute=\"%s\""</span> body) <span style="color: #008000;">""</span>))

(<span style="color: #0000FF;">push</span> '(<span style="color: #008000;">"hdfql"</span> . sql) org-src-lang-modes)

(add-to-list 'org-structure-template-alist '(<span style="color: #008000;">"hq"</span> . <span style="color: #008000;">"src hdfql"</span>))

</pre>
</div></li>
<li>The rest is cosmetics:
<ul class="org-ul">
<li>Syntax highlighting ("font locking" in Emacs-speak)</li>
<li>Auto-indentation</li>
<li>Sessions</li>
<li>Ping me (<a href="mailto:gheber@hdfgroup.org">Gerd Heber</a>), if you are interested in pushing this forward!</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-org32a5726" class="outline-3">
<h3 id="org32a5726">On behalf of The HDF Group, I wish you a Merry Christmas and a Happy New Year!</h3>
<div class="outline-text-3" id="text-org32a5726">
<p>
Stay safe &amp; come back next year!
</p>
</div>
</div>
</div>

<div id="outline-container-org7bbd06d" class="outline-2">
<h2 id="org7bbd06d">Clinic 2021-12-07</h2>
<div class="outline-text-2" id="text-org7bbd06d">
</div>
<div id="outline-container-org4103ea0" class="outline-3">
<h3 id="org4103ea0">Your Questions</h3>
<div class="outline-text-3" id="text-org4103ea0">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
<dt>Q</dt><dd>Can a point selection be written to/read from a hypserslab selection?
Does this work in parallel?
<ul class="org-ul">
<li>It appears to work for simple examples in sequential mode</li>
<li>I have yet to try parallel mode</li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-org8e3c00d" class="outline-3">
<h3 id="org8e3c00d">Last week's highlights</h3>
<div class="outline-text-3" id="text-org8e3c00d">
</div>
<ul class="org-ul">
<li><a id="orgd971bd8"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgbbc6951"></a>We had a great webinar <a href="https://forum.hdfgroup.org/t/accelerate-i-o-operations-with-hermes/9142">Accelerate I/O operations with Hermes</a><br />
<div class="outline-text-5" id="text-orgbbc6951">
<ul class="org-ul">
<li>Stay tuned for the recording on YouTube</li>
<li>The Hermes project now has its <a href="https://forum.hdfgroup.org/c/Hermes">forum category</a>
<ul class="org-ul">
<li>Follow announcements, ask questions, participate!</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org24cf3eb"></a><a href="https://forum.hdfgroup.org/t/release-of-hdf5-1-13-0-newsletter-181-the-hdf-group/9224">Release of HDF5-1.13.0</a><br />
<div class="outline-text-5" id="text-org24cf3eb">
<ul class="org-ul">
<li>An <i>odd</i> release number?
<ul class="org-ul">
<li>Experimental vs. maintenance releases see <a href="https://www.hdfgroup.org/2021/12/hdf5-1-13-0-introducing-experimental-releases/">here</a></li>
<li>"Experimental" is not a fig leaf for "shoddy"</li>
<li>Experimental releases receive as much TLC as maintenance releases</li>
</ul></li>
<li>Highlights:
<ul class="org-ul">
<li>VOL layer updates (DAOS, pass-through, async.)</li>
<li>VFD layer updates
<ul class="org-ul">
<li>Dynamic loading</li>
<li>GPUDirect VFD</li>
</ul></li>
</ul></li>
<li>Performance improvements</li>
<li><p>
<a href="https://confluence.hdfgroup.org/download/attachments/74188083/2021-12-2-ParallelTools-Portal.pdf?version=1&amp;modificationDate=1638475023303&amp;api=v2"><code>h5dwalk</code></a> tool
</p>
<div class="org-src-container">
<pre class="src src-shell">
[ bin]$ mpiexec -n 4 ./h5dwalk -o show-h5dump-h5files.log -T ./h5dump
$<span style="color: #BA36A5;">HOME</span>/Sandbox/HDF5/GITHUB/hdf5/tools/testfiles
[ bin]$ more show-h5dump-h5files.log
---------
Command: ./h5dump -n /home/riwarren/Sandbox/HDF5/GITHUB/hdf5/tools/testfiles/tne<span style="background-color: #ff0000;">s</span>tedcmpddt.h5
HDF5 <span style="color: #008000;">"/home/riwarren/Sandbox/HDF5/GITHUB/hdf5/tools/testfiles/tnestedcmpddt.h5"</span> <span style="background-color: #ff0000;">{</span>
FILE_CONTENTS {
  group /
  dataset /dset1
  dataset /dset2
  dataset /dset4
  dataset /dset5
  datatype /enumtype
  group /group1
  dataset /group1/dset3
  datatype /type1
  }
}
...

</pre>
</div></li>
</ul>
</div>
</li>

<li><a id="org5e795a8"></a><a href="https://us06web.zoom.us/meeting/register/tZUtdemprjMsG9YmD5MINqn6VWh2VJnoUX7N">VOL tutorial</a> moved to January 14, 2022!<br />
<div class="outline-text-5" id="text-org5e795a8">
<ul class="org-ul">
<li>Covers the basics needed to construct a simple terminal VOL connector</li>
<li>Great New Year's resolution <code>;-)</code></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org4f09e7a"></a>Forum<br />
<ul class="org-ul">
<li><a id="org0e09e73"></a><a href="https://forum.hdfgroup.org/t/working-with-packed-12-bit-integers/9171">Working with packed 12-bit integers</a><br />
<div class="outline-text-5" id="text-org0e09e73">
<ul class="org-ul">
<li>Two basic approaches: packing or filtering</li>
<li><a href="https://github.com/berkeleysdm/H5TurboPFor">H5TurboPFor</a>
<ul class="org-ul">
<li>HDF5 frontend for <a href="https://github.com/powturbo/TurboPFor-Integer-Compression">TurboPFor: Fastest Integer Compression</a></li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orge56c9b1"></a><a href="https://forum.hdfgroup.org/t/h5datatype-with-variable-length-how-to-set-the-values/9162">H5Datatype with variable length: How to set the values?</a><br />
<div class="outline-text-5" id="text-orge56c9b1">
<ul class="org-ul">
<li>Too many half-baked HDF5 Java interfaces (including our own)</li>
<li>How can we better engage with that community?</li>
<li><a href="https://www.hdfql.com/">HDFql</a>?</li>
</ul>
</div>
</li>
<li><a id="orgb92e33e"></a><a href="https://forum.hdfgroup.org/t/which-layout-shall-i-use/9180">Which layout shall I use?</a><br />
<div class="outline-text-5" id="text-orgb92e33e">
<ul class="org-ul">
<li>Acquiring a lot of small (&lt; 8K) messages</li>
<li>Which (dataset) layout is best for performance?
<ul class="org-ul">
<li>What is layout?</li>
</ul></li>
<li>It depends&#x2026;
<ul class="org-ul">
<li>How is performance measured?</li>
<li>How will the messages be accessed?</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orgd6dbe38"></a><a href="https://forum.hdfgroup.org/t/controlling-btree-parameters-for-performance-reasons/9176">Controlling BTree parameters for performance reasons</a><br />
<div class="outline-text-5" id="text-orgd6dbe38">
<ul class="org-ul">
<li>Import large number of images (~5 million) as chunked datasets</li>
<li>~10-20 million groups for indexing</li>
<li>Can B-tree parameters do magic? (No)
<ul class="org-ul">
<li>Good <a href="https://courses.cs.washington.edu/courses/cse326/04su/lectures/BRank.pdf">intro to B-trees</a></li>
</ul></li>
<li><p>
Two kinds of B-trees, file-wide configuration via FCPL
</p>
<div class="org-src-container">
<pre class="src src-C">
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">group links</span>
<span style="color: #6434A3;">herr_t</span> <span style="color: #006699;">H5Pset_sym_k</span>(<span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">plist_id</span>, <span style="color: #6434A3;">unsigned</span> <span style="color: #BA36A5;">ik</span>, <span style="color: #6434A3;">unsigned</span> <span style="color: #BA36A5;">lk</span>);

<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">dataset chunk index</span>
herr_t <span style="color: #6434A3;">herr_t</span> <span style="color: #006699;">H5Pset_istore_k</span>(<span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">plist_id</span>, <span style="color: #6434A3;">unsigned</span> <span style="color: #BA36A5;">ik</span>);

</pre>
</div></li>
<li>Other potential remedies
<ul class="org-ul">
<li>File format improvements</li>
<li>Reduce the number of objects by stacking images, e.g., by resolution</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org6aac137"></a><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-1-release/8824">VFD SWMR beta 1 release</a><br />
<div class="outline-text-5" id="text-org6aac137">
<ul class="org-ul">
<li>Will the HDF5 SWMR VFD be a plugin?
<ul class="org-ul">
<li><del>I don't know for sure.</del>
<ul class="org-ul">
<li>No. See Dana's response.</li>
</ul></li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org15715e7"></a><a href="https://forum.hdfgroup.org/t/virtual-data-set/9206">Virtual Data Set</a><br />
<div class="outline-text-5" id="text-org15715e7">
<blockquote>
<p>
For our application, we need to return an error in case the caller tries to
read data from a VDS and some of the referenced files that store the requested
data are not available.
</p>
</blockquote>
<ul class="org-ul">
<li>Currently, users cannot change the error behavior of VDS functions</li>
<li>Pedestrian approach: parse the VDS metadata to detect missing files</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org4e7d6b7" class="outline-3">
<h3 id="org4e7d6b7">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org4e7d6b7">
<p>
No time for that, today.
</p>
</div>
</div>
</div>

<div id="outline-container-org72e910f" class="outline-2">
<h2 id="org72e910f">Clinic 2021-11-23</h2>
<div class="outline-text-2" id="text-org72e910f">
</div>
<div id="outline-container-orgfc2ab14" class="outline-3">
<h3 id="orgfc2ab14">Your Questions</h3>
<div class="outline-text-3" id="text-orgfc2ab14">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
<dt>Q</dt><dd><p>
Under <a href="https://portal.hdfgroup.org/display/HDF5/Software+Changes+from+Release+to+Release+for+HDF5-1.10">Compatibility and Performance Issues</a> we say
</p>
<blockquote>
<p>
Not all HDF5-1.10 releases are compatible.
</p>
</blockquote>
<p>
What does that mean and why?
</p>
<ul class="org-ul">
<li><b>API</b> incompatibility (not file format!) introduced in HDF5 1.10.3</li>
</ul></dd>
<dt>Q</dt><dd>Can a point selection be written to/read from a hypserslab selection?
Does this work in parallel?
<ul class="org-ul">
<li>It appears to work for simple examples in sequential mode:</li>
</ul></dd>
</dl>
<div class="org-src-container">
<pre class="src src-C">
<span style="color: #808080;">#include</span> <span style="color: #008000;">"hdf5.h"</span>

<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdlib.h&gt;</span>

<span style="color: #6434A3;">int</span> <span style="color: #006699;">main</span>()
{
  <span style="color: #6434A3;">__label__</span> <span style="color: #BA36A5;">fail_file</span>, <span style="color: #BA36A5;">fail_fspace</span>, <span style="color: #BA36A5;">fail_dset</span>;
  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">retval</span> = EXIT_SUCCESS;
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file</span>, <span style="color: #BA36A5;">fspace</span>, <span style="color: #BA36A5;">dset</span>, <span style="color: #BA36A5;">mspace</span>;
  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">data</span>[] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9};

  <span style="color: #0000FF;">if</span>((file = H5Fcreate(<span style="color: #008000;">"sel.h5"</span>, H5F_ACC_TRUNC, H5P_DEFAULT, H5P_DEFAULT)) ==
     H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }

  <span style="color: #0000FF;">if</span> ((fspace = H5Screate_simple(1, (<span style="color: #6434A3;">hsize_t</span>[]) {10}, <span style="color: #D0372D;">NULL</span>)) ==
      H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_fspace</span>;
  }

  <span style="color: #0000FF;">if</span> ((dset = H5Dcreate(file, <span style="color: #008000;">"ints"</span>, H5T_STD_I32LE, fspace, H5P_DEFAULT,
                        H5P_DEFAULT, H5P_DEFAULT)) == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dset</span>;
  }

  <span style="color: #0000FF;">if</span> ((mspace = H5Scopy(fspace)) == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_copy</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">1. Make a point selection in memory</span>
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">2. Make a hyperslab selection in the file</span>
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">3. Write</span>
  <span style="color: #0000FF;">if</span> (H5Sselect_elements(mspace, H5S_SELECT_SET, 3, (<span style="color: #6434A3;">hsize_t</span>[]){3, 1, 6}) &lt; 0 ||
      H5Sselect_hyperslab(fspace, H5S_SELECT_SET, (<span style="color: #6434A3;">hsize_t</span>[]){4}, <span style="color: #D0372D;">NULL</span>,
                          (<span style="color: #6434A3;">hsize_t</span>[]){1}, (<span style="color: #6434A3;">hsize_t</span>[]){3}) &lt; 0 ||
      H5Dwrite(dset, H5T_NATIVE_INT, mspace, fspace, H5P_DEFAULT, data) &lt; 0) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_write</span>;
  }

<span style="color: #D0372D;">fail_write</span>:
  H5Sclose(mspace);
<span style="color: #D0372D;">fail_copy</span>:
  H5Dclose(dset);
<span style="color: #D0372D;">fail_dset</span>:
  H5Sclose(fspace);
<span style="color: #D0372D;">fail_fspace</span>:
  H5Fclose(file);
<span style="color: #D0372D;">fail_file</span>:
  <span style="color: #0000FF;">return</span> retval;
}

</pre>
</div>

<ul class="org-ul">
<li>The ouput file produce looks like this:</li>
</ul>

<pre class="example" id="orgd87ec44">

HDF5 "sel.h5" {
GROUP "/" {
   DATASET "ints" {
      DATATYPE  H5T_STD_I32LE
      DATASPACE  SIMPLE { ( 10 ) / ( 10 ) }
      DATA {
      (0): 0, 0, 0, 0, 3, 1, 6, 0, 0, 0
      }
   }
}
}

</pre>

<ul class="org-ul">
<li>I have yet to try parallel mode</li>
</ul>
</div>
</div>

<div id="outline-container-orge149840" class="outline-3">
<h3 id="orge149840">Last week's highlights</h3>
<div class="outline-text-3" id="text-orge149840">
</div>
<ul class="org-ul">
<li><a id="org1be525d"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgb0f04d2"></a><a href="https://forum.hdfgroup.org/t/accelerate-i-o-operations-with-hermes/9142">Accelerate I/O operations with Hermes</a><br />
<div class="outline-text-5" id="text-orgb0f04d2">
<ul class="org-ul">
<li>Hermes 0.1.0-beta</li>
<li>Distributed I/O buffering for storage hierarchies</li>
<li><a href="https://github.com/HDFGroup/hermes">GitHub</a> &amp; <a href="https://github.com/HDFGroup/hermes/wiki/1.-Getting-Started">Getting Started Guide</a></li>
<li><a href="https://us06web.zoom.us/meeting/register/tZcpd-CspzgsH908R0eZ1rMZbA67KR8z1hnI">Register</a> for the webinar on December 1, 2021 11:00 AM (Central)!</li>
</ul>
</div>
</li>
<li><a id="org034b57f"></a>Try the HDF5 SWMR VFD Beta!<br />
<div class="outline-text-5" id="text-org034b57f">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-1-release/8824">Forum post</a></li>
<li><a href="https://github.com/HDFGroup/hdf5/tree/feature/vfd_swmr_beta_1">GitHub</a></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org8ca40de"></a>Forum<br />
<ul class="org-ul">
<li><a id="org461bffc"></a><a href="https://forum.hdfgroup.org/t/reference-manual-in-doxygen/8230">Reference Manual in Doxygen</a><br />
<div class="outline-text-5" id="text-org461bffc">
<ul class="org-ul">
<li>We've been experimenting with <a href="https://docs.hdfgroup.org/hdf5/develop/_f_t_s.html#gsc.tab=0">full-text search</a></li>
<li>Not a replacement for the Doxygen-native search</li>
<li>What do you think?</li>
</ul>
</div>
</li>
<li><a id="org25b01c9"></a><a href="https://forum.hdfgroup.org/t/working-with-packed-12-bit-integers/9171">Working with packed 12-bit integers</a><br />
<div class="outline-text-5" id="text-org25b01c9">
<ul class="org-ul">
<li>Two basic approaches: packing or filtering</li>
<li><a href="https://github.com/berkeleysdm/H5TurboPFor">H5TurboPFor</a>
<ul class="org-ul">
<li>HDF5 frontend for <a href="https://github.com/powturbo/TurboPFor-Integer-Compression">TurboPFor: Fastest Integer Compression</a></li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org7cfc8a3"></a><a href="https://forum.hdfgroup.org/t/h5datatype-with-variable-length-how-to-set-the-values/9162">H5Datatype with variable length: How to set the values?</a><br />
<div class="outline-text-5" id="text-org7cfc8a3">
<ul class="org-ul">
<li>Too many half-baked HDF5 Java interfaces (including our own)</li>
<li>How can we better engage with that community?</li>
<li><a href="https://www.hdfql.com/">HDFql</a>?</li>
</ul>
</div>
</li>
<li><a id="orga67143a"></a><a href="https://forum.hdfgroup.org/t/which-layout-shall-i-use/9180">Which layout shall I use?</a><br />
<div class="outline-text-5" id="text-orga67143a">
<ul class="org-ul">
<li>Acquiring a lot of small (&lt; 8K) messages</li>
<li>Which (dataset) layout is best for performance?</li>
<li>It depends&#x2026;
<ul class="org-ul">
<li>How is performance measured?</li>
<li>How will the messages be accessed?</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orge414399"></a><a href="https://forum.hdfgroup.org/t/controlling-btree-parameters-for-performance-reasons/9176">Controlling BTree parameters for performance reasons</a><br />
<div class="outline-text-5" id="text-orge414399">
<ul class="org-ul">
<li>Import large number of images (~5 million) as chunked datasets</li>
<li>~10-20 million groups for indexing</li>
<li>Can B-tree parameters do magic? (No)</li>
<li>Potential remedies
<ul class="org-ul">
<li>File format improvements</li>
<li>Reduce the number of objects by stacking images, e.g., by resolution</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orgb2d88d7"></a><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-1-release/8824">VFD SWMR beta 1 release</a><br />
<div class="outline-text-5" id="text-orgb2d88d7">
<ul class="org-ul">
<li>Will the HDF5 SWMR VFD be a plugin?
<ul class="org-ul">
<li>I don't know for sure.</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orge5f2481" class="outline-3">
<h3 id="orge5f2481">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orge5f2481">
<p>
No time for that, today.
</p>
</div>
</div>
</div>

<div id="outline-container-org6c9488d" class="outline-2">
<h2 id="org6c9488d">Clinic 2021-11-16</h2>
<div class="outline-text-2" id="text-org6c9488d">
</div>
<div id="outline-container-orge54498a" class="outline-3">
<h3 id="orge54498a">Your Questions</h3>
<div class="outline-text-3" id="text-orge54498a">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
<dt>Q</dt><dd><p>
Under <a href="https://portal.hdfgroup.org/display/HDF5/Software+Changes+from+Release+to+Release+for+HDF5-1.10">Compatibility and Performance Issues</a> we say
</p>
<blockquote>
<p>
Not all HDF5-1.10 releases are compatible.
</p>
</blockquote>
<p>
What does that mean and why?
</p></dd>
<dt>Q</dt><dd>Can a point selection be written to/read from a hypserslab selection?
Does this work in parallel?</dd>
</dl>
</div>
</div>

<div id="outline-container-org2a153e0" class="outline-3">
<h3 id="org2a153e0">Last week's highlights</h3>
<div class="outline-text-3" id="text-org2a153e0">
</div>
<ul class="org-ul">
<li><a id="orgf65c3d2"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org73de55b"></a><a href="https://forum.hdfgroup.org/t/accelerate-i-o-operations-with-hermes/9142">Accelerate I/O operations with Hermes</a><br />
<div class="outline-text-5" id="text-org73de55b">
<ul class="org-ul">
<li>Hermes 0.1.0-beta</li>
<li>Distributed I/O buffering for storage hierarchies</li>
<li><a href="https://github.com/HDFGroup/hermes">GitHub</a> &amp; <a href="https://github.com/HDFGroup/hermes/wiki/1.-Getting-Started">Getting Started Guide</a></li>
<li><a href="https://us06web.zoom.us/meeting/register/tZcpd-CspzgsH908R0eZ1rMZbA67KR8z1hnI">Register</a> for the webinar on December 1, 2021 11:00 AM (Central)!</li>
</ul>
</div>
</li>
<li><a id="orgb488bf4"></a>Try the HDF5 SWMR VFD Beta!<br />
<div class="outline-text-5" id="text-orgb488bf4">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-1-release/8824">Forum post</a></li>
<li><a href="https://github.com/HDFGroup/hdf5/tree/feature/vfd_swmr_beta_1">GitHub</a></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org5cc066f"></a>Forum<br />
<ul class="org-ul">
<li><a id="org146d777"></a><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-1-release/8824">VFD SWMR beta 1 release</a><br />
<div class="outline-text-5" id="text-org146d777">
<ul class="org-ul">
<li>Part of HDF5 1.13?</li>
<li>No and yes: de-coupling of VFDs and library releases</li>
</ul>
</div>
</li>
<li><a id="org2270211"></a><a href="https://forum.hdfgroup.org/t/hdf5functionargumentexception-inappropriate-type-for-datatype-class-array/9145">HDF5FunctionArgumentException: Inappropriate type for Datatype.CLASS<sub>ARRAY</sub></a><br />
<div class="outline-text-5" id="text-org2270211">
<ul class="org-ul">
<li>Drink responsibly &amp; don't go crazy with those datatypes!</li>
</ul>
</div>
</li>
<li><a id="orgde29fb3"></a><a href="https://forum.hdfgroup.org/t/dynamically-loaded-filters-on-mac-os/9159">Dynamically Loaded Filters on Mac OS</a><br />
<div class="outline-text-5" id="text-orgde29fb3">
<ul class="org-ul">
<li>The joy of being different</li>
</ul>
</div>
</li>
<li><a id="org6b1e733"></a><a href="https://forum.hdfgroup.org/t/h5datatype-with-variable-length-how-to-set-the-values/9162">H5Datatype with variable length: How to set the values?</a><br />
<div class="outline-text-5" id="text-org6b1e733">
<ul class="org-ul">
<li>The joy and frustration of language bindings to the HDF5 C-API</li>
</ul>
</div>
</li>
<li><a id="org6ec453f"></a><a href="https://forum.hdfgroup.org/t/open-hdf5-when-it-is-already-opened-in-hdfview/9104">Open HDF5 when it is already opened in HDFVIEW</a><br />
<div class="outline-text-5" id="text-org6ec453f">
<ul class="org-ul">
<li>Solution:</li>
</ul>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #006FE0;">export</span> <span style="color: #BA36A5;">HDF5_USE_FILE_LOCKING</span>=<span style="color: #008000;">"FALSE"</span>
</pre>
</div>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org14237ea" class="outline-3">
<h3 id="org14237ea">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org14237ea">
</div>
<ul class="org-ul">
<li><a id="org638b74f"></a>Mochi - 2021 R&amp;D100 Winner<br />
<div class="outline-text-4" id="text-org638b74f">
<ul class="org-ul">
<li><a href="https://www.mcs.anl.gov/research/projects/mochi/">Mochi project page</a></li>
<li>Collaboration between ANL, LANL, CMU, and The HDF Group</li>
<li>See Jerome Soumagne's <a href="https://www.youtube.com/watch?v=j0T51XHrJrY&amp;list=PLPyhR4PdEeGYdTX7SVM59LwoNJDgJSNdd&amp;index=17">HUG 2021 presentation</a></li>
<li>Changes in scientific workflows</li>
<li>Composable data services and building blocks</li>
<li>Micros-services rather than monoliths</li>
<li>A refined toolset for modern architectures and demanding applications</li>
</ul>
</div>
</li>

<li><a id="org1d500d2"></a>Who wants to share their favorite hack/trick?<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org7e042bf" class="outline-2">
<h2 id="org7e042bf">Clinic 2021-11-09</h2>
<div class="outline-text-2" id="text-org7e042bf">
</div>
<div id="outline-container-org1133f58" class="outline-3">
<h3 id="org1133f58">Your Questions</h3>
<div class="outline-text-3" id="text-org1133f58">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
<dt>Q</dt><dd><p>
Under <a href="https://portal.hdfgroup.org/display/HDF5/Software+Changes+from+Release+to+Release+for+HDF5-1.10">Compatibility and Performance Issues</a> we say
</p>
<blockquote>
<p>
Not all HDF5-1.10 releases are compatible.
</p>
</blockquote>
<p>
What does that mean and why?
</p></dd>
<dt>Q</dt><dd>Can a point selection be written to/read from a hypserslab selection?
Does this work in parallel?</dd>
</dl>
</div>
</div>

<div id="outline-container-org6e5b532" class="outline-3">
<h3 id="org6e5b532">Last week's highlights</h3>
<div class="outline-text-3" id="text-org6e5b532">
</div>
<ul class="org-ul">
<li><a id="org836f460"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org812962c"></a><a href="https://forum.hdfgroup.org/t/accelerate-i-o-operations-with-hermes/9142">Accelerate I/O operations with Hermes</a><br />
<div class="outline-text-5" id="text-org812962c">
<ul class="org-ul">
<li>Hermes 0.1.0-beta</li>
<li>Distributed I/O buffering for storage hierarchies</li>
<li><a href="https://github.com/HDFGroup/hermes">GitHub</a> &amp; <a href="https://github.com/HDFGroup/hermes/wiki/1.-Getting-Started">Getting Started Guide</a></li>
<li>Stay tuned for a webinar on December 1, 2021</li>
</ul>
</div>
</li>
<li><a id="org87dbb5b"></a>Try the HDF5 SWMR VFD Beta!<br />
<div class="outline-text-5" id="text-org87dbb5b">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-1-release/8824">Forum post</a></li>
<li><a href="https://github.com/HDFGroup/hdf5/tree/feature/vfd_swmr_beta_1">GitHub</a></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org7669da7"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgbc48abb"></a><a href="https://forum.hdfgroup.org/t/crash-when-writing-parallel-compressed-chunks/6186">Crash when writing parallel compressed chunks</a><br />
<div class="outline-text-5" id="text-orgbc48abb">
<ul class="org-ul">
<li>Jordan committed a fix for an old <code>MPI_ERR_TRUNCATE</code> issue/crash</li>
<li>Merging to development branches of HDF5 1.13, 1.12, 1.10</li>
<li>If you've been affected by this, give it a try!</li>
</ul>
</div>
</li>
<li><a id="org988b412"></a><a href="https://forum.hdfgroup.org/t/sorting-of-members-of-a-compound-type/9134">Sorting of members of a compound type</a><br />
<div class="outline-text-5" id="text-org988b412">
<ul class="org-ul">
<li>User has to write elements of a compound datatype one at a time</li>
<li>"Partial I/O gets in the way" - sorting fields by name or offset
<ul class="org-ul">
<li>Happens on each write call =&gt; overhead</li>
</ul></li>
<li>Can this be avoided? User might provide a patch&#x2026;</li>
</ul>
</div>
</li>
<li><a id="org0997020"></a><a href="https://forum.hdfgroup.org/t/read-write-specific-coordiantes-in-multi-dimensional-dataset/9137">Read/write specific coordiantes in multi-dimensional dataset?</a><br />
<div class="outline-text-5" id="text-org0997020">
<ul class="org-ul">
<li><p>
Thomas is looking for use cases from <code>h5py</code> users
</p>
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #BA36A5;">arr</span> = ds.points[[(0, 0), (1, 0), (2, 2)]]  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Read</span>

ds.points[[(0, 0), (1, 0), (2, 2)]] = [1, 2, 3]  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Write</span>

</pre>
</div></li>
<li>See his <a href="https://github.com/h5py/h5py/pull/1793">PR</a></li>
</ul>
</div>
</li>
<li><a id="org421c1bc"></a><a href="https://forum.hdfgroup.org/t/reading-variable-length-data-from-hdf5-file-c-api/9115">Reading variable length data from hdf5 file C++ API</a><br />
<div class="outline-text-5" id="text-org421c1bc">
<ul class="org-ul">
<li>The "curse" of variable-length sequence data = the loss of memory contiguity</li>
<li>C++20 <a href="https://en.cppreference.com/w/cpp/container/span"><code>std::span</code></a> seems to be the way to go, but how many codes are C++20?</li>
<li><b>Important:</b> The cleanup of buffers into which VLEN data is read is the
caller's responsibility! Use <code>H5Dvlen_reclaim</code> (HDF5 1.10-) or
<code>H5Treclaim</code> (HDF5 1.12+).</li>
<li>Got <del>milk</del> matching <code>H5Dread</code> and <code>H5Dwrite</code>?</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org6b34127" class="outline-3">
<h3 id="org6b34127">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org6b34127">
<p>
We didn't get to this last time&#x2026;
</p>
</div>

<ul class="org-ul">
<li><a id="org85046e1"></a><code>H5Dread</code> / <code>H5Dwrite</code> Symmetry<br />
<div class="outline-text-4" id="text-org85046e1">
<ul class="org-ul">
<li><p>
Syntax
</p>
<div class="org-src-container">
<pre class="src src-C">
<span style="color: #6434A3;">herr_t</span> <span style="color: #006699;">H5Dwrite</span>
(
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dset_id</span>,
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">mem_type_id</span>,  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">the library "knows" the in-file datatype</span>
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">mem_space_id</span>, <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file_space_id</span>,
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dxpl_id</span>, <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">void</span>* <span style="color: #BA36A5;">buf</span>
);

<span style="color: #6434A3;">herr_t</span> <span style="color: #006699;">H5Dread</span>
(
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dset_id</span>,
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">mem_type_id</span>,  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">the library "knows" the in-file datatype</span>
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">mem_space_id</span>,  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file_space_id</span>,
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dxpl_id</span>, <span style="color: #6434A3;">void</span>* <span style="color: #BA36A5;">buf</span>
);

</pre>
</div></li>
<li><i>Necessary</i> conditions for this to work out
<ol class="org-ol">
<li>The in-memory (element) datatype must be convertible to/from the in-file
datatype. (With the exception of VLEN strings, VLEN types a la <code>hvl_t</code> are
<b>not</b> convertible to ragged arrays!)</li>
<li>The dataspace selections in-memory and in the file must have the same
number of selected elements. (Be careful when using <code>H5S_ALL</code> for one of
<code>mem_space_id</code> or <code>file_space_id</code>!)</li>
<li>The buffer must be big enough to hold at least the number of selected
elements (in their native representation).
<ul class="org-ul">
<li>For parallel, the number of elements written/read by this MPI rank</li>
</ul></li>
</ol></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgbf57238" class="outline-2">
<h2 id="orgbf57238">Clinic 2021-11-02</h2>
<div class="outline-text-2" id="text-orgbf57238">
</div>
<div id="outline-container-orgdbec2f6" class="outline-3">
<h3 id="orgdbec2f6">Your Questions</h3>
<div class="outline-text-3" id="text-orgdbec2f6">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
<dt>Q</dt><dd><p>
Under <a href="https://portal.hdfgroup.org/display/HDF5/Software+Changes+from+Release+to+Release+for+HDF5-1.10">Compatibility and Performance Issues</a> we say
</p>
<blockquote>
<p>
Not all HDF5-1.10 releases are compatible.
</p>
</blockquote>
<p>
What does that mean and why?
</p></dd>
<dt>Q</dt><dd>Can a point selection be written to/read from a hypserslab selection?
Does this work in parallel?</dd>
</dl>
</div>
</div>

<div id="outline-container-org9f843e1" class="outline-3">
<h3 id="org9f843e1">Last week's highlights</h3>
<div class="outline-text-3" id="text-org9f843e1">
</div>
<ul class="org-ul">
<li><a id="org959b1e2"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgf28bb1a"></a><a href="https://forum.hdfgroup.org/t/release-of-hdf5-1-10-8-newsletter-180/9108">HDF5 1.10.8 Release</a><br />
<div class="outline-text-5" id="text-orgf28bb1a">
<ul class="org-ul">
<li><a href="https://support.hdfgroup.org/ftp/HDF5/releases/hdf5-1.10/hdf5-1.10.8/src/hdf5-1.10.8-RELEASE.txt">Release notes</a>
<ul class="org-ul">
<li>CMake no longer builds the C++ library by default</li>
<li>HDF5 now requires Visual Studio 2015 or greater</li>
<li>On macOS, Universal Binaries can now be built</li>
<li>CMake option to build the HDF filter plugins project as an external
project</li>
<li>Autotools and CMake target added to produce doxygen generated
documentation</li>
<li>CMake option to statically link gcc libs with MinGW</li>
<li>File locking now works on Windows</li>
<li>Improved performance of <code>H5Sget_select_elem_pointlist</code></li>
<li>Detection of simple data transform function <code>"x"</code></li>
</ul></li>
<li><a href="https://portal.hdfgroup.org/display/HDF5/Software+Changes+from+Release+to+Release+for+HDF5-1.10">Interesting figure</a></li>
<li>Under <b>Compatibility and Performance Issues</b> is</li>
</ul>
</div>
</li>
<li><a id="org4cfb5c4"></a>Try the HDF5 SWMR VFD Beta!<br />
<div class="outline-text-5" id="text-org4cfb5c4">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-1-release/8824">Forum post</a></li>
<li><a href="https://github.com/HDFGroup/hdf5/tree/feature/vfd_swmr_beta_1">GitHub</a></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="orge6129bb"></a>Forum<br />
<ul class="org-ul">
<li><a id="orge47ef10"></a><a href="https://forum.hdfgroup.org/t/h5dget-chunk-info-performance-for-many-chunks/9079"><code>H5Dget_chunk_info</code> performance for many chunks?</a><br />
<div class="outline-text-5" id="text-orge47ef10">
<ul class="org-ul">
<li><b>Task:</b> Get all of the chunk file offsets + sizes</li>
<li><b>Solution:</b> <a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_d.html#title6"><code>H5Dchunk_iter</code></a></li>
<li><b>Caveat:</b> Currently only available in the <code>development</code> branch</li>
<li><b>Note:</b> We covered this function and an example in our clinic on <span class="timestamp-wrapper"><span class="timestamp">[2021-08-03 Tue]</span></span></li>
</ul>
</div>
</li>

<li><a id="org446f901"></a><a href="https://forum.hdfgroup.org/t/open-hdf5-when-it-is-already-opened-in-hdfview/9104">Open HDF5 when it is already opened in HDFVIEW</a><br />
<div class="outline-text-5" id="text-org446f901">
<blockquote>
<p>
Is there a way (probably file access property) to open the file multiple times
(especially when it is opened in HdfView) and allow to read/write it? May the
problem be solved if I build hdf5 with multithreads option ON ?
</p>
</blockquote>
<ul class="org-ul">
<li>Except for specific use cases (SWMR), this is a bad idea</li>
<li>Why? Remember this figure?</li>
</ul>

<div id="org2ee5d9c" class="figure">
<p><img src="../img/hdf5-file-state.png" alt="hdf5-file-state.png" />
</p>
</div>
</div>
</li>

<li><a id="org10b07b8"></a><a href="https://forum.hdfgroup.org/t/append-hdf5-files-in-parallel/9098">Append HDF5 files in parallel</a><br />
<div class="outline-text-5" id="text-org10b07b8">
<blockquote>
<p>
I have thousands of HDF5 files that need to be merged into a single file.
Merging is simply to append all groups and datasets of one file after
another in a new output file. The group names of the input files are all
different from one another. In addition, all datasets are chunked and
compressed.
</p>

<p>
My question is how do I merge the files in parallel?
</p>

<p>
My implementation consists of the following steps:
&#x2026;
</p>
</blockquote>
<ul class="org-ul">
<li>That's a tough one</li>
<li>Two options
<ol class="org-ol">
<li>Don't copy any data, just reference existing data (via external links)</li>
<li>Copy data as fast as you can
<ul class="org-ul">
<li>(MPI) parallel make this more complicated</li>
</ul></li>
</ol></li>
</ul>
</div>
</li>

<li><a id="orgfec311e"></a><a href="https://forum.hdfgroup.org/t/reading-variable-length-data-from-hdf5-file-c-api/9115">Reading variable length data from hdf5 file C++ API</a><br />
<div class="outline-text-5" id="text-orgfec311e">
<ul class="org-ul">
<li>Got <del>milk</del> matching <code>H5Dread</code> and <code>H5Dwrite</code>?</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org7dabd8c" class="outline-3">
<h3 id="org7dabd8c">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org7dabd8c">
</div>
<ul class="org-ul">
<li><a id="org9c56f1f"></a><code>H5Dread</code> / <code>H5Dwrite</code> Symmetry<br />
<div class="outline-text-4" id="text-org9c56f1f">
<ul class="org-ul">
<li><p>
Syntax
</p>
<div class="org-src-container">
<pre class="src src-C">
<span style="color: #6434A3;">herr_t</span> <span style="color: #006699;">H5Dwrite</span>
(
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dset_id</span>,
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">mem_type_id</span>,
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">mem_space_id</span>, <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file_space_id</span>,
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dxpl_id</span>, <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">void</span>* <span style="color: #BA36A5;">buf</span>
);

<span style="color: #6434A3;">herr_t</span> <span style="color: #006699;">H5Dread</span>
(
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dset_id</span>,
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">mem_type_id</span>,
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">mem_space_id</span>,  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file_space_id</span>,
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dxpl_id</span>, <span style="color: #6434A3;">void</span>* <span style="color: #BA36A5;">buf</span>
);

</pre>
</div></li>
<li><i>Necessary</i> conditions for this to work out
<ol class="org-ol">
<li>The in-memory (element) datatype must be convertible to/from the in-file
datatype.</li>
<li>The dataspace selections in-memory and in the file must have the same
number of selected elements.</li>
<li>The buffer must be big enough to hold at least the number of selected
elements (in their native representation).
<ul class="org-ul">
<li>For parallel, the number of elements written/read by this MPI rank</li>
</ul></li>
</ol></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org5895b26" class="outline-2">
<h2 id="org5895b26">Clinic 2021-10-28</h2>
<div class="outline-text-2" id="text-org5895b26">
</div>
<div id="outline-container-org3228ff9" class="outline-3">
<h3 id="org3228ff9">Your Questions</h3>
<div class="outline-text-3" id="text-org3228ff9">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>
<div id="outline-container-org2913ffb" class="outline-3">
<h3 id="org2913ffb">Last week's highlights</h3>
<div class="outline-text-3" id="text-org2913ffb">
</div>
<ul class="org-ul">
<li><a id="org31fd2d1"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org161d2f0"></a><a href="https://www.youtube.com/playlist?list=PLPyhR4PdEeGYdTX7SVM59LwoNJDgJSNdd">HUG 2021 Videos are showing up on YouTube</a><br /></li>
<li><a id="orge6b6e89"></a>Submit comments/questions/criticisms to the <a href="mailto:hug@hdfgroup.org">organizing committee</a><br /></li>
</ul>
</li>
<li><a id="org358f749"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgfedc990"></a><a href="https://forum.hdfgroup.org/t/hdfview-3-1-0-error-displaying-dataset-with-np-float16-data/7974">HDFView 3.1.0 error displaying dataset with np.float16 data</a><br />
<div class="outline-text-5" id="text-orgfedc990">
<ul class="org-ul">
<li>HDF5 has supported user-defined floating-point types from day one</li>
<li>Good example of poor execution on our part!</li>
<li>GPUs have rekindled the interest in reduced floating-point representations</li>
</ul>
</div>
</li>
<li><a id="org7ce3f4f"></a><a href="https://forum.hdfgroup.org/t/announcing-development-of-the-enterprise-support-edition-of-hdf5/4374">Announcing development of the Enterprise Support Edition of HDF5</a><br />
<div class="outline-text-5" id="text-org7ce3f4f">
<ul class="org-ul">
<li>Good example of an own goal / publicity disaster</li>
<li>One more time: <b>There is no Enterprise Support Edition of HDF5!</b>
<ul class="org-ul">
<li>However, support and consulting agreements are available from The HDF Group
for enterprises and other organizations</li>
</ul></li>
<li>There is only one development line of HDF5 (data model, file format, library)
&amp; it is available on <a href="https://github.com/HDFGroup/hdf5">GitHub</a>
<ul class="org-ul">
<li>Hence, it is nonsensical to speak of 'HDF5 editions'</li>
</ul></li>
<li>End of story</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org54601ac" class="outline-3">
<h3 id="org54601ac">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org54601ac">
</div>
<ul class="org-ul">
<li><a id="orgc4ece0d"></a>Who is afraid of <code>h5debug</code>?<br />
<div class="outline-text-4" id="text-orgc4ece0d">
<ul class="org-ul">
<li>A useful tool to explore the "guts" of the HDF5 file format</li>
<li>There's even a nice <a href="https://docs.hdfgroup.org/hdf5/develop/_f_m_t_d_i_s_c.html">guided tour</a> by Quincey Koziol from 2003
<ul class="org-ul">
<li>HDF5 1.4.5 was released <span class="timestamp-wrapper"><span class="timestamp">[2003-02-02 Sun]</span></span></li>
<li>HDF5 1.6.0 was released <span class="timestamp-wrapper"><span class="timestamp">[2003-07-03 Thu]</span></span></li>
</ul></li>
<li><p>
Compiling and running <code>example1.c</code> produces this output:
</p>
<pre class="example" id="orgbe3f0cc">
%h5debug example1.h5

Reading signature at address 0 (rel)
File Super Block...
File name (as opened):                             example1.h5
File name (after resolving symlinks):              example1.h5
File access flags                                  0x00000000
File open reference count:                         1
Address of super block:                            0 (abs)
Size of userblock:                                 0 bytes
Superblock version number:                         0
Free list version number:                          0
Root group symbol table entry version number:      0
Shared header version number:                      0
Size of file offsets (haddr_t type):               8 bytes
Size of file lengths (hsize_t type):               8 bytes
Symbol table leaf node 1/2 rank:                   4
Symbol table internal node 1/2 rank:               16
Indexed storage internal node 1/2 rank:            32
File status flags:                                 0x00
Superblock extension address:                      18446744073709551615 (rel)
Shared object header message table address:        18446744073709551615 (rel)
Shared object header message version number:       0
Number of shared object header message indexes:    0
Address of driver information block:               18446744073709551615 (rel)
Root group symbol table entry:
   Name offset into private heap:                  0
   Object header address:                          96
   Cache info type:                                Symbol Table
   Cached entry information:
      B-tree address:                              136
      Heap address:                                680
</pre></li>
<li>It matches the output from 2003 except for
<ul class="org-ul">
<li>The root group's object header address is 96 (in 2021) vs. 928 (in 2003)</li>
<li>The root's B-tree is at 136 vs. 384</li>
<li>The root group's local heap is at 680 vs. 96</li>
</ul></li>
<li>Happy HDF5 exploring!</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org7d17c81" class="outline-2">
<h2 id="org7d17c81">Clinic 2021-10-19</h2>
<div class="outline-text-2" id="text-org7d17c81">
</div>
<div id="outline-container-orgf34076e" class="outline-3">
<h3 id="orgf34076e">Your Questions</h3>
<div class="outline-text-3" id="text-orgf34076e">
<dl class="org-dl">
<dt>Q</dt><dd>???</dd>
</dl>
</div>
</div>
<div id="outline-container-org804d518" class="outline-3">
<h3 id="org804d518">Last week's highlights</h3>
<div class="outline-text-3" id="text-org804d518">
</div>
<ul class="org-ul">
<li><a id="org5e224d4"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org3acf8e5"></a><a href="https://www.youtube.com/playlist?list=PLPyhR4PdEeGYdTX7SVM59LwoNJDgJSNdd">HUG 2021 Videos are showing up on YouTube</a><br /></li>
</ul>
</li>
<li><a id="org0edbf34"></a>Forum<br />
<ul class="org-ul">
<li><a id="org577d0aa"></a><a href="https://forum.hdfgroup.org/t/dataset-insert-vector-of-compound-type/9027">Dataset Insert Vector of Compound Type</a><br />
<div class="outline-text-5" id="text-org577d0aa">
<ul class="org-ul">
<li><p>
Memory-contiguous vs. non-contiguous layout
</p>
<div class="org-src-container">
<pre class="src src-C"><span style="color: #0000FF;">struct</span> <span style="color: #6434A3;">Instruction</span> {
  <span style="color: #6434A3;">float</span> <span style="color: #BA36A5;">timestamp</span>;
  <span style="color: #6434A3;">Key</span> <span style="color: #BA36A5;">keys</span>[MAX_KEYS]; <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">-&gt; H5T_ARRAY</span>
};

<span style="color: #0000FF;">struct</span> <span style="color: #6434A3;">Instruction</span> {
  <span style="color: #6434A3;">float</span> <span style="color: #BA36A5;">timestamp</span>;
  <span style="color: #6434A3;">Key</span>* <span style="color: #BA36A5;">keys</span>; <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">-&gt; H5T_VLEN</span>
};
</pre>
</div></li>
</ul>
</div>
</li>
<li><a id="org09f4936"></a><a href="https://forum.hdfgroup.org/t/memory-mapping-paging-via-hdf5-vfd/9052">Memory mapping / Paging via HDF5 &amp; VFD?</a><br />
<div class="outline-text-5" id="text-org09f4936">
<ul class="org-ul">
<li><code>hid_t H5Dread_mapped(..., void** buf);</code></li>
<li>Returns a pointer to  a memory-mapped region</li>
<li>If the region is writable, changes will be propagated to the file (instead of
calling <code>H5Dwrite</code>)</li>
</ul>
</div>
</li>
<li><a id="org4dfc5a6"></a><a href="https://forum.hdfgroup.org/t/external-links-vfds/9056">External links &amp; VFDs</a><br />
<div class="outline-text-5" id="text-org4dfc5a6">
<ul class="org-ul">
<li>What if an external link requires a different VFD for its resolution?</li>
<li>Current approach: set it manually via <code>H5Pset_elink_fapl()</code> after figuring out
that that's required. Yikes!</li>
<li>Add VFD-plugins and this gets out of hand quickly&#x2026;</li>
</ul>
</div>
</li>
<li><a id="org0d798dd"></a><a href="https://forum.hdfgroup.org/t/why-increasing-rdcc-nbytes-and-rdcc-nslots-will-result-in-a-decrease-in-indexing-performance/9062">Why increasing <code>rdcc_nbytes</code> and <code>rdcc_nslots</code> will result in a decrease in indexing performance?</a><br />
<div class="outline-text-5" id="text-org0d798dd">
<ul class="org-ul">
<li>See <a href="https://docs.hdfgroup.org/hdf5/rfc/RFC_chunk_cache_functions.pdf">RFC: Setting Raw Data Chunk Cache Parameters in HDF5</a> for guidance</li>
<li>Potential <code>h5py</code> issue</li>
</ul>
</div>
</li>
<li><a id="org69d1cce"></a><a href="https://forum.hdfgroup.org/t/fletcher32-filter-on-variable-length-string-datasets-not-suitable-for-filters/9038">Fletcher32 filter on variable length string datasets (not suitable for filters)</a><br />
<div class="outline-text-5" id="text-org69d1cce">
<ul class="org-ul">
<li>Triggered by change introduced in 1.12.1</li>
<li><b>Caution:</b> Filters and variable-length data</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org93f0183" class="outline-3">
<h3 id="org93f0183">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org93f0183">
<ul class="org-ul">
<li>Something's compressed:</li>
</ul>
<div class="org-src-container">
<pre class="src src-C">
<span style="color: #808080;">#include</span> <span style="color: #008000;">"hdf5.h"</span>

<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdio.h&gt;</span>
<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdlib.h&gt;</span>

<span style="color: #6434A3;">int</span> <span style="color: #006699;">main</span>()
{
  <span style="color: #6434A3;">__label__</span> <span style="color: #BA36A5;">fail_file</span>, <span style="color: #BA36A5;">fail_dtype</span>, <span style="color: #BA36A5;">fail_dspace</span>, <span style="color: #BA36A5;">fail_dcpl</span>, <span style="color: #BA36A5;">fail_dset</span>, <span style="color: #BA36A5;">fail_write</span><span style="background-color: #ff0000;">;</span>
  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">retval</span> = EXIT_SUCCESS;
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file</span>, <span style="color: #BA36A5;">dspace</span>, <span style="color: #BA36A5;">dtype</span>, <span style="color: #BA36A5;">dcpl</span>, <span style="color: #BA36A5;">dset</span>;


  <span style="color: #0000FF;">if</span> ((file = H5Fcreate(<span style="color: #008000;">"vlen.h5"</span>, H5F_ACC_TRUNC, H5P_DEFAULT, H5P_DEFAULT))
      == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }

  <span style="color: #0000FF;">if</span> ((dtype = H5Tvlen_create(H5T_STD_I32LE)) == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dtype</span>;
  }

  <span style="color: #0000FF;">if</span> ((dspace = H5Screate_simple(1, (<span style="color: #6434A3;">hsize_t</span>[]){2048},
                                 (<span style="color: #6434A3;">hsize_t</span>[]){H5S_UNLIMITED})) ==
      H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dspace</span>;
  }

  <span style="color: #0000FF;">if</span> ((dcpl = H5Pcreate(H5P_DATASET_CREATE)) == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dcpl</span>;
  }

  <span style="color: #0000FF;">if</span> (H5Pset_chunk(dcpl, 1, (<span style="color: #6434A3;">hsize_t</span>[]) {1024}) &lt; 0 ||
      H5Pset_deflate(dcpl, 1) &lt; 0
      <span style="color: #8D8D84;">//</span><span style="color: #8D8D84; font-style: italic;">H5Pset_fletcher32(dcpl) &lt; 0</span>
      ) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dset</span>;
  }

  <span style="color: #0000FF;">if</span> ((dset = H5Dcreate(file, <span style="color: #008000;">"dset"</span>, dtype, dspace, H5P_DEFAULT, dcpl,
                        H5P_DEFAULT)) == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dset</span>;
  }

  {
    <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">data</span>[] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9};
    <span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">offset</span>[] = {0, 1, 3, 6};
    <span style="color: #6434A3;">hvl_t</span> <span style="color: #BA36A5;">buf</span>[2048];
    <span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">i</span>;

    <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">create an array that looks like this:</span>
    <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">{ {0}, {1,2}, {3,4,5}, {6,7,8,9}, ...}</span>
    <span style="color: #0000FF;">for</span> (i = 0; i &lt; 2048; ++i)
      {
        <span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">rem</span> = i%4;
        buf[i].len = 1 + rem;
        buf[i].p = data + offset[rem];
      }

    <span style="color: #0000FF;">if</span> (H5Dwrite(dset, dtype, H5S_ALL, H5S_ALL, H5P_DEFAULT, buf) &lt; 0)
      {
        retval = EXIT_FAILURE;
        <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_write</span>;
      }
  }

 <span style="color: #D0372D;">fail_write</span>:
  H5Dclose(dset);

 <span style="color: #D0372D;">fail_dset</span>:
  H5Pclose(dcpl);

 <span style="color: #D0372D;">fail_dcpl</span>:
  H5Sclose(dspace);

 <span style="color: #D0372D;">fail_dspace</span>:
  H5Tclose(dtype);

 <span style="color: #D0372D;">fail_dtype</span>:
  H5Fclose(file);

 <span style="color: #D0372D;">fail_file</span>:
  <span style="color: #0000FF;">return</span> retval;
}

</pre>
</div>

<ul class="org-ul">
<li><code>h5dump -pBH vlen.h5</code></li>
</ul>

<pre class="example" id="orgf688ec2">

HDF5 "vlen.h5" {
SUPER_BLOCK {
   SUPERBLOCK_VERSION 0
   FREELIST_VERSION 0
   SYMBOLTABLE_VERSION 0
   OBJECTHEADER_VERSION 0
   OFFSET_SIZE 8
   LENGTH_SIZE 8
   BTREE_RANK 16
   BTREE_LEAF 4
   ISTORE_K 32
   FILE_SPACE_STRATEGY H5F_FSPACE_STRATEGY_FSM_AGGR
   FREE_SPACE_PERSIST FALSE
   FREE_SPACE_SECTION_THRESHOLD 1
   FILE_SPACE_PAGE_SIZE 4096
   USER_BLOCK {
      USERBLOCK_SIZE 0
   }
}
GROUP "/" {
   DATASET "dset" {
      DATATYPE  H5T_VLEN { H5T_STD_I32LE}
      DATASPACE  SIMPLE { ( 2048 ) / ( H5S_UNLIMITED ) }
      STORAGE_LAYOUT {
         CHUNKED ( 1024 )
         SIZE 5772 (5.677:1 COMPRESSION)
      }
      FILTERS {
         COMPRESSION DEFLATE { LEVEL 1 }
      }
      FILLVALUE {
         FILL_TIME H5D_FILL_TIME_ALLOC
         VALUE  H5D_FILL_VALUE_DEFAULT
      }
      ALLOCATION_TIME {
         H5D_ALLOC_TIME_INCR
      }
   }
}
}

</pre>
<ul class="org-ul">
<li><b>N.B.</b> What's compressed are the in-file counterparts of <code>hvl_t</code> structures, not the integer sequences!</li>
<li>Filtering fails, if we enable Fletcher32</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org34bf940" class="outline-2">
<h2 id="org34bf940">Clinic 2021-09-28</h2>
<div class="outline-text-2" id="text-org34bf940">
</div>
<div id="outline-container-org9e63dae" class="outline-3">
<h3 id="org9e63dae">Your Questions</h3>
<div class="outline-text-3" id="text-org9e63dae">
<dl class="org-dl">
<dt>Q</dt><dd>Will the HDF5 1.12.1 file locking changes be brought to 1.10.8?
<ul class="org-ul">
<li>Did Elena will answer that?</li>
</ul></dd>
</dl>
</div>
</div>
<div id="outline-container-org10e6b28" class="outline-3">
<h3 id="org10e6b28">Last week's highlights</h3>
<div class="outline-text-3" id="text-org10e6b28">
</div>
<ul class="org-ul">
<li><a id="org8e089f7"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org0ebc592"></a><a href="https://forum.hdfgroup.org/t/hdf5-user-group-meeting-october-12-15-2021/9003">HUG 2021 Agenda posted</a><br />
<div class="outline-text-5" id="text-org0ebc592">
<ul class="org-ul">
<li>October 12-15, 2021, 9:00 AM - 1:30 PM (CDT)</li>
</ul>
</div>
</li>
<li><a id="org4ee30e0"></a><a href="https://forum.hdfgroup.org/t/webinar-announcement-new-features-in-the-hdf5-1-13-0-release/8950">Webinar Announcement: New Features in the HDF5 1.13.0 Release</a><br />
<div class="outline-text-5" id="text-org4ee30e0">
<ul class="org-ul">
<li><a href="https://www.youtube.com/watch?v=14xrbKJ3wk4">Recording</a> and <a href="https://www.hdfgroup.org/wp-content/uploads/2021/09/New-Features-in-HDF5-1.13.0-VFD-and-VOL-Changes-Webinar-9-24-21.pdf">slides</a> available now!</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org86a4e16"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgf5de831"></a><a href="https://forum.hdfgroup.org/t/possible-to-change-email-address-here/6738">Possible to change email address here?</a><br />
<div class="outline-text-5" id="text-orgf5de831">
<ul class="org-ul">
<li>Lori?</li>
</ul>
</div>
</li>
<li><a id="org820c3a1"></a><a href="https://forum.hdfgroup.org/t/retrieve-property-list-from-object/8971">Retrieve property list from object</a><br />
<div class="outline-text-5" id="text-org820c3a1">
<ul class="org-ul">
<li>Property lists come in several flavors (access, creation, transfer)</li>
<li>Only creation property lists are store in the file</li>
</ul>
</div>
</li>
<li><a id="orgda7c5d1"></a><a href="https://forum.hdfgroup.org/t/dynamic-plugins-require-application-to-link-to-shared-library/8972">Dynamic Plugins require application to link to shared library</a><br />
<div class="outline-text-5" id="text-orgda7c5d1">
<ul class="org-ul">
<li><a href="https://github.com/HDFGroup/hdf5/issues/1009">GitHub issue</a></li>
<li>Plugin loading happens via <code>dlopen</code></li>
<li>Calling the HDF5 library from a plugin
<ul class="org-ul">
<li>Why would applications do that? Element type, chunk size, &#x2026;</li>
<li>API shortcomings?</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org40e5c34"></a><a href="https://forum.hdfgroup.org/t/object-timestamps-useful-or-not/8901">Object timestamps - useful or not?</a><br />
<div class="outline-text-5" id="text-org40e5c34">
<ul class="org-ul">
<li>Only a minority seems to care
<ul class="org-ul">
<li>Limited implementation</li>
</ul></li>
<li>Bit-for-bit reproducibility</li>
<li>Clear communication before changing defaults is crucial</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org4eb16c1" class="outline-3">
<h3 id="org4eb16c1">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org4eb16c1">
</div>
<ul class="org-ul">
<li><a id="orgb50ee9b"></a>HDF5 references<br />
<div class="outline-text-4" id="text-orgb50ee9b">
<ul class="org-ul">
<li>HDF5 datatype</li>
<li>Pre-HDF5 1.12.0 referents limited to dataset regions and objects</li>
<li>Starting w/ HDF5 1.12.0 referents can be HDF5 attributes
<ul class="org-ul">
<li>Support for querying and indexing</li>
<li>API clean-up</li>
</ul></li>
<li><a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_r.html">Basic life cycle examples in RM</a></li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgb231861" class="outline-2">
<h2 id="orgb231861">Clinic 2021-09-21</h2>
<div class="outline-text-2" id="text-orgb231861">
<ul class="org-ul">
<li>Elena's slides on <a href="./Chunking-compression.pdf">HDF5 Chunking and Compression - Performance issues</a></li>
</ul>
</div>
</div>
<div id="outline-container-org9e90357" class="outline-2">
<h2 id="org9e90357">Clinic 2021-08-31</h2>
<div class="outline-text-2" id="text-org9e90357">
</div>
<div id="outline-container-org6f8122b" class="outline-3">
<h3 id="org6f8122b">Your Questions</h3>
<div class="outline-text-3" id="text-org6f8122b">
<dl class="org-dl">
<dt>Q</dt><dd>Will the HDF5 1.12.1 file locking changes be brought to 1.10.8?
<ul class="org-ul">
<li>Elena will answer that next week!</li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-orgceacf2f" class="outline-3">
<h3 id="orgceacf2f">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgceacf2f">
</div>
<ul class="org-ul">
<li><a id="org183b1ef"></a>Announcements<br />
<div class="outline-text-4" id="text-org183b1ef">
<ul class="org-ul">
<li>I didn't see any</li>
</ul>
</div>
</li>

<li><a id="org8624fd7"></a>Forum<br />
<ul class="org-ul">
<li><a id="org221ed68"></a><a href="https://forum.hdfgroup.org/t/how-many-times-to-call-the-filter-in-writing-a-single-chunk/8906">How many times to call the filter in writing a single chunk</a><br />
<div class="outline-text-5" id="text-org221ed68">
<ul class="org-ul">
<li>Provide a <a href="https://en.wikipedia.org/wiki/Minimal_working_example">Minimal Working Example (MWE)</a>!</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org5adaa84" class="outline-3">
<h3 id="org5adaa84">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org5adaa84">
</div>
<ul class="org-ul">
<li><a id="org744da1d"></a>Using a custom filter<br />
<div class="outline-text-4" id="text-org744da1d">
<div class="org-src-container">
<pre class="src src-C">
<span style="color: #808080;">#include</span> <span style="color: #008000;">"hdf5.h"</span>

<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdio.h&gt;</span>
<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdlib.h&gt;</span>

<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">an identity filter function which just prints "helpful" messages</span>
<span style="color: #6434A3;">size_t</span> <span style="color: #006699;">filter</span>(<span style="color: #6434A3;">unsigned</span> <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">flags</span>, <span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">cd_nelmts</span>,
              <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">unsigned</span> <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">cd_values</span>[], <span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">nbytes</span>, <span style="color: #6434A3;">size_t</span> *<span style="color: #BA36A5;">buf_size</span>,
              <span style="color: #6434A3;">void</span> **<span style="color: #BA36A5;">buf</span>) {
  buf_size = 0;

  <span style="color: #0000FF;">if</span> (flags &amp; H5Z_FLAG_REVERSE) {
    <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">read data, e.g., decompress data</span>
    <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">...</span>
    printf(<span style="color: #008000;">"Decompressing...\n"</span>);
  } <span style="color: #0000FF;">else</span> {
    <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">write data, e.g., compress data</span>
    <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">...</span>
    printf(<span style="color: #008000;">"Compressing...\n"</span>);
  }

  <span style="color: #0000FF;">return</span> nbytes;
}

<span style="color: #6434A3;">int</span> <span style="color: #006699;">main</span>()
{
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">boilerplate</span>
  <span style="color: #6434A3;">__label__</span> <span style="color: #BA36A5;">fail_register</span>, <span style="color: #BA36A5;">fail_file</span>, <span style="color: #BA36A5;">fail_dspace</span>, <span style="color: #BA36A5;">fail_dcpl</span>, <span style="color: #BA36A5;">fail_dset</span>,
    <span style="color: #BA36A5;">fail_write</span>;
  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">retval</span> = EXIT_SUCCESS;
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file</span>, <span style="color: #BA36A5;">dspace</span>, <span style="color: #BA36A5;">dcpl</span>, <span style="color: #BA36A5;">dset</span>;

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">custom filter</span>
  <span style="color: #6434A3;">H5Z_class_t</span> <span style="color: #BA36A5;">cls</span>;
  cls.version = H5Z_CLASS_T_VERS;
  cls.id = 256;
  cls.encoder_present = 1;
  cls.decoder_present = 1;
  cls.name = <span style="color: #008000;">"Identity filter"</span>;
  cls.can_apply = <span style="color: #D0372D;">NULL</span>;
  cls.set_local = <span style="color: #D0372D;">NULL</span>;
  cls.filter = &amp;filter;

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">register the filter</span>
  <span style="color: #0000FF;">if</span> (H5Zregister(&amp;cls) &lt; 0) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_register</span>;
  }

  <span style="color: #0000FF;">if</span> ((file = H5Fcreate(<span style="color: #008000;">"filter.h5"</span>, H5F_ACC_TRUNC, H5P_DEFAULT, H5P_DEFAULT))
      == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }
  <span style="color: #0000FF;">if</span> ((dspace = H5Screate_simple(1, (<span style="color: #6434A3;">hsize_t</span>[]){2048},
                                 (<span style="color: #6434A3;">hsize_t</span>[]){H5S_UNLIMITED})) ==
      H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dspace</span>;
  }
  <span style="color: #0000FF;">if</span> ((dcpl = H5Pcreate(H5P_DATASET_CREATE)) == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dcpl</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">play with early chunk allocation and fill time</span>
  <span style="color: #0000FF;">if</span> (H5Pset_filter(dcpl, cls.id, 0|H5Z_FLAG_MANDATORY, 0, <span style="color: #D0372D;">NULL</span>) &lt; 0 ||
      <span style="color: #8D8D84;">//</span><span style="color: #8D8D84; font-style: italic;">H5Pset_alloc_time(dcpl, H5D_ALLOC_TIME_EARLY) &lt; 0 ||</span>
      <span style="color: #8D8D84;">//</span><span style="color: #8D8D84; font-style: italic;">H5Pset_fill_time(dcpl, H5D_FILL_TIME_NEVER) &lt; 0 ||</span>
      H5Pset_chunk(dcpl, 1, (<span style="color: #6434A3;">hsize_t</span>[]) {1024}) &lt; 0) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dset</span>;
  }

  <span style="color: #0000FF;">if</span> ((dset = H5Dcreate(file, <span style="color: #008000;">"dset"</span>, H5T_STD_I32LE, dspace, H5P_DEFAULT,
                        dcpl, H5P_DEFAULT)) == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dset</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">write something to trigger the "compression" of two chunks</span>
  {
    <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">data</span>[2048];

    <span style="color: #0000FF;">if</span> (H5Dwrite(dset, H5T_NATIVE_INT, H5S_ALL, H5S_ALL, H5P_DEFAULT, data)
        &lt; 0) {
      retval = EXIT_FAILURE;
      <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_write</span>;
    }
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">housekeeping</span>
 <span style="color: #D0372D;">fail_write</span>:
  H5Dclose(dset);
 <span style="color: #D0372D;">fail_dset</span>:
  H5Pclose(dcpl);
 <span style="color: #D0372D;">fail_dcpl</span>:
  H5Sclose(dspace);
 <span style="color: #D0372D;">fail_dspace</span>:
  H5Fclose(file);
 <span style="color: #D0372D;">fail_file</span>:
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">unregister the filter</span>
  <span style="color: #0000FF;">if</span> (H5Zunregister(cls.id) &lt; 0) {
    retval = EXIT_FAILURE;
  }
 <span style="color: #D0372D;">fail_register</span>:
  <span style="color: #0000FF;">return</span> retval;
}

</pre>
</div>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org05e1039" class="outline-2">
<h2 id="org05e1039">Clinic 2021-08-24</h2>
<div class="outline-text-2" id="text-org05e1039">
</div>
<div id="outline-container-org5a22b43" class="outline-3">
<h3 id="org5a22b43">Your Questions</h3>
<div class="outline-text-3" id="text-org5a22b43">
<dl class="org-dl">
<dt>Q</dt><dd>Will the HDF5 1.12.1 file locking changes be brought to 1.10.8?</dd>
</dl>
</div>
</div>

<div id="outline-container-org7959f42" class="outline-3">
<h3 id="org7959f42">Last week's highlights</h3>
<div class="outline-text-3" id="text-org7959f42">
</div>
<ul class="org-ul">
<li><a id="orgce3e6b1"></a>Announcements<br />
<div class="outline-text-4" id="text-orgce3e6b1">
<ul class="org-ul">
<li>I didn't see any</li>
</ul>
</div>
</li>

<li><a id="org59c01be"></a>Forum<br />
<ul class="org-ul">
<li><a id="org83878c1"></a><a href="https://forum.hdfgroup.org/t/append-to-compound-dataset/8885">Append to compound dataset</a><br />
<div class="outline-text-5" id="text-org83878c1">
<ul class="org-ul">
<li>It is tempting to think about 1D compound datasets as tables</li>
</ul>
</div>
</li>
<li><a id="org520d7d0"></a><a href="https://forum.hdfgroup.org/t/reference-manual-in-doxygen/8230">Reference Manual in Doxygen</a><br />
<div class="outline-text-5" id="text-org520d7d0">
<ul class="org-ul">
<li><a href="https://docs.hdfgroup.org/hdf5/develop/group___h5_z.html">RM H5Z</a></li>
<li>Don't let Word &amp; co. pollute your documentation!
<ul class="org-ul">
<li>It's  not someone else being evil, it's us acting like fools!</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orgb21382a" class="outline-3">
<h3 id="orgb21382a">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orgb21382a">
</div>
<ul class="org-ul">
<li><a id="org1d92495"></a>HDF5 Compound Datasets and (Relational) Tables: Don't be fooled!<br />
<div class="outline-text-4" id="text-org1d92495">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/append-to-compound-dataset/8885">Append to compound dataset</a></li>
<li>'Row' as in 'table row' or 'matrix row' share the same spelling, but that's
where the similarity ends!
<ul class="org-ul">
<li>HDF5 datasets are <b>not</b> tables</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-C">
<span style="color: #808080;">#include</span> <span style="color: #008000;">"hdf5.h"</span>

<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdlib.h&gt;</span>

<span style="color: #6434A3;">int</span> <span style="color: #006699;">main</span>()
{
  <span style="color: #6434A3;">__label__</span> <span style="color: #BA36A5;">fail_file</span>, <span style="color: #BA36A5;">fail_dspace</span>, <span style="color: #BA36A5;">fail_dset</span>, <span style="color: #BA36A5;">fail_extent</span>;

  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">retval</span> = EXIT_SUCCESS;

  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file</span>, <span style="color: #BA36A5;">dspace</span>, <span style="color: #BA36A5;">dcpl</span>, <span style="color: #BA36A5;">dset</span>;

  <span style="color: #0000FF;">if</span> ((file = H5Fcreate(<span style="color: #008000;">"foo.h5"</span>, H5F_ACC_TRUNC, H5P_DEFAULT, H5P_DEFAULT)) ==
      H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">create a 1D dataspace of indefinite extent, initial extent 0 (elements)</span>
  <span style="color: #0000FF;">if</span> ((dspace = H5Screate_simple(1, (<span style="color: #6434A3;">hsize_t</span>[]){0}, (<span style="color: #6434A3;">hsize_t</span>[]){H5S_UNLIMITED}))
      == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dspace</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">allocate space in the file in batches of 1024 dataset elements</span>
  <span style="color: #0000FF;">if</span> ((dcpl = H5Pcreate(H5P_DATASET_CREATE)) == H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dcpl</span>;
  }
  <span style="color: #0000FF;">if</span> (H5Pset_chunk(dcpl, 1, (<span style="color: #6434A3;">hsize_t</span>[]){1024}) &lt; 0) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dset</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">create the dataset</span>
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">(replace H5T_STD_I32LE with your favorite datatype)</span>
  <span style="color: #0000FF;">if</span> ((dset = H5Dcreate(file, <span style="color: #008000;">"(4-byte) integers"</span>, H5T_STD_I32LE, dspace,
                        H5P_DEFAULT, dcpl, H5P_DEFAULT)) ==
      H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dset</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">grow from here!</span>

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">"add one row"</span>
  <span style="color: #0000FF;">if</span> (H5Dset_extent(dset, (<span style="color: #6434A3;">hsize_t</span>[]){1}) &lt; 0) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_extent</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">"add 99 more rows"</span>
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">100 = 1 + 99</span>
  <span style="color: #0000FF;">if</span> (H5Dset_extent(dset, (<span style="color: #6434A3;">hsize_t</span>[]){100}) &lt; 0) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_extent</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">you can also shrink the dataset...</span>

 <span style="color: #D0372D;">fail_extent</span>:
  H5Dclose(dset);
 <span style="color: #D0372D;">fail_dset</span>:
  H5Pclose(dcpl);
 <span style="color: #D0372D;">fail_dcpl</span>:
  H5Sclose(dspace);
 <span style="color: #D0372D;">fail_dspace</span>:
  H5Fclose(file);
 <span style="color: #D0372D;">fail_file</span>:

  <span style="color: #0000FF;">return</span> retval;
}

</pre>
</div>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgb42397c" class="outline-2">
<h2 id="orgb42397c">Clinic 2021-08-17</h2>
<div class="outline-text-2" id="text-orgb42397c">
</div>
<div id="outline-container-orgc523e3c" class="outline-3">
<h3 id="orgc523e3c">Your Questions</h3>
<div class="outline-text-3" id="text-orgc523e3c">
<dl class="org-dl">
<dt>Q</dt><dd>Will the HDF5 1.12.1 file locking changes be brought to 1.10.8?</dd>
<dt>Q</dt><dd>Are there or should there be special considerations when preserving HDF-5
files for future use? I support a research data repository at University of
Michigan and we occasionally receive these files (also netCDF and HDF-5
created by MATLAB).
<ul class="org-ul">
<li>HDF5 feature use
<ul class="org-ul">
<li>Relative paths, hard-coded paths (e.g., in external links)</li>
<li>Dependencies such as plugins</li>
</ul></li>
<li>Metadata
<ul class="org-ul">
<li>Faceted search, catalog, digest</li>
<li>Check sums</li>
</ul></li>
<li><b>TODO:</b> Create some guidance!</li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-org91cbeff" class="outline-3">
<h3 id="org91cbeff">Last week's highlights</h3>
<div class="outline-text-3" id="text-org91cbeff">
</div>
<ul class="org-ul">
<li><a id="orgf7c641c"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org24dfe9f"></a><a href="https://forum.hdfgroup.org/t/new-compression-plugin-based-on-snappy-cuda/8848">New compression plugin based on Snappy-CUDA</a><br />
<div class="outline-text-5" id="text-org24dfe9f">
<ul class="org-ul">
<li>A new (de-)compression filter plugin using <a href="https://github.com/google/snappy">Google's Snappy</a> algorithm</li>
<li>It runs on GPUs</li>
<li>By Mr. HDF5-UDF (Lucas C. Villa Real)</li>
</ul>
</div>
</li>
</ul>
</li>

<li><a id="org7a4e587"></a>Forum<br />
<ul class="org-ul">
<li><a id="orge4fc251"></a><a href="https://forum.hdfgroup.org/t/alignment-of-direct-write-chunks/8851">Alignment of Direct Write Chunks</a><br />
<div class="outline-text-5" id="text-orge4fc251">
<ul class="org-ul">
<li>Store large 1D datasets across multiple HDF5 file</li>
<li>Receive compressed chunks w/ fixed number of samples/chunk</li>
<li>Want to use direct chunk write</li>
<li><b>Problem:</b> Chunks may contain <i>boundary chunks</i> containing samples that belong
to different datasets in different files</li>
<li><b>Sub-optimal solution:</b> Decompress the chunk, separate the samples, &amp; use some
kind of masking value on the next dataset</li>
<li>Better solution?</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org13c0f08" class="outline-3">
<h3 id="org13c0f08">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org13c0f08">
</div>
<ul class="org-ul">
<li><a id="orgb953c6d"></a>Virtual Datasets (VDS)<br />
<div class="outline-text-4" id="text-orgb953c6d">
<ul class="org-ul">
<li>Logically, HDF5 datasets have a shape (rank or dimensionality) and an element
type</li>
<li>Physically, HDF5 datasets have a layout (in a logical HDF5 file): contiguous,
chunked, compact, <i>virtual</i></li>
<li>A virtual dataset is an HDF5 dataset of virtual layout (- duh!)</li>
<li><b>Virtual layout:</b> some or all of the dataset's elements are stored in
constituent datasets in the same or other HDF5 files, including other virtual
datasets(!)</li>
<li>Like any HDF5 dataset, HDF5 datasets of virtual layout have a shape
(a.k.a. dataspace) and an element type (a.k.a datatype)</li>
<li>Virtual datasets are constructed by specifying how selections(!) on
constituent datasets <i>map</i> to regions in the virtual dataset's dataspace</li>
<li><p>
Main API call: <a href="https://docs.hdfgroup.org/hdf5/develop/group___d_c_p_l.html#gadec895092dbbedb94f85d9cacf8924f5"><code>H5Pset_virtual</code></a>
</p>
<div class="org-src-container">
<pre class="src src-C"><span class="linenr">1: </span>
<span class="linenr">2: </span><span style="color: #6434A3;">herr_t</span> <span style="color: #006699;">H5Pset_virtual</span>(<span style="color: #6434A3;">hid_t</span>       <span style="color: #BA36A5;">vds_dcpl_id</span>,   <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">VDS creation properties</span>
<span class="linenr">3: </span>                      <span style="color: #6434A3;">hid_t</span>       <span style="color: #BA36A5;">vds_dspace_id</span>, <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">VDS dataspace</span>
<span class="linenr">4: </span>                      <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">char</span>* <span style="color: #BA36A5;">src_file_name</span>, <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">source file path</span>
<span class="linenr">5: </span>                      <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">char</span>* <span style="color: #BA36A5;">src_dset_name</span>, <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">source dataset path</span>
<span class="linenr">6: </span>                      <span style="color: #6434A3;">hid_t</span>       <span style="color: #BA36A5;">src_space_id</span>); <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">source dataspace select.</span>
<span class="linenr">7: </span>
</pre>
</div></li>
<li>Sometimes multiple calls to <code>H5Pset_virtual</code> are necessary, but there's
support for <code>printf</code>-style format strings to describe multiple source files &amp; datasets</li>
<li>Typically, a VDS is just a piece of (HDF5-)metadata</li>
<li>How does that lead to a better solution? <i>Use VDS to correct for data
acquisition artifacts!</i></li>
<li>Two approaches
<ol class="org-ol">
<li>Write the "boundary chunk" to both datasets/files</li>
<li>Write the "boundary chunk" to only one dataset/file</li>
</ol></li>
<li>In either case, we use VDS as a mechanism to construct the correct
(time-delineated) datasets</li>
<li>Main practical differences between 1. and 2.:
<ul class="org-ul">
<li>Unless the data is WORM (write-once/read-many), there is a potential
coherence problem in 1. because we have two copies of the halo data</li>
<li>When accessing a dataset whose boundary chunk ended up in another file,
under 2., the HDF5 library has to open another file and dataset, and locate
the chunk</li>
</ul></li>
<li>The canonical VDS reference is <a href="https://docs.hdfgroup.org/hdf5/rfc/HDF5-VDS-requirements-use-cases-2014-12-10.pdf">RFC: HDF5 Virtual Dataset</a>
<ul class="org-ul">
<li>Good source of use cases and examples</li>
<li>Not everything described in the RFC was implemented, e.g., datatype
conversion</li>
<li><code>h5py</code> has a nice <a href="https://docs.h5py.org/en/stable/vds.html">interface for VDS</a></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgc9d25a9" class="outline-2">
<h2 id="orgc9d25a9">Clinic 2021-08-10</h2>
<div class="outline-text-2" id="text-orgc9d25a9">
</div>
<div id="outline-container-orgee9b2c7" class="outline-3">
<h3 id="orgee9b2c7">Your Questions</h3>
<div class="outline-text-3" id="text-orgee9b2c7">
<dl class="org-dl">
<dt>Q</dt><dd>Will the HDF5 1.12.1 file locking changes be brought to 1.10.8?</dd>
</dl>
</div>
</div>

<div id="outline-container-orgac7785f" class="outline-3">
<h3 id="orgac7785f">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgac7785f">
</div>
<ul class="org-ul">
<li><a id="org44101d9"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org8e94a96"></a><a href="https://forum.hdfgroup.org/t/the-highly-scalable-data-service-hsds-is-now-available-on-microsoft-azure/8830">The Highly Scalable Data Service (HSDS) is now available on Microsoft Azure</a><br />
<div class="outline-text-5" id="text-org8e94a96">
<ul class="org-ul">
<li>Get started in the <a href="https://azuremarketplace.microsoft.com/en-us/marketplace/apps/thehdfgroup1616725197741.hsdsazurevm?tab=overview">Azure Marketplace</a></li>
</ul>
</div>
</li>
<li><a id="org03ccc89"></a><a href="https://forum.hdfgroup.org/t/vfd-swmr-beta-1-release/8824">VFD SWMR beta 1 release</a><br />
<div class="outline-text-5" id="text-org03ccc89">
<ul class="org-ul">
<li><a href="https://github.com/HDFGroup/hdf5/tree/feature/vfd_swmr_beta_1">GitHub branch</a></li>
<li><a href="https://www.youtube.com/watch?v=QDoKuJojkGI">The movie</a></li>
<li><a href="https://docs.hdfgroup.org/hdf5/rfc/VFD_SWMR_RFC_191027.pdf">The VFD SWMR RFC</a></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="orgc1b03e8"></a>Forum<br />
<div class="outline-text-4" id="text-orgc1b03e8">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/problem-compiling-hdf5-using-cmake-with-hdf5-enable-parallel/8823">Problem compiling HDF5 using CMake with <code>HDF5_ENABLE_PARALLEL</code></a>
<ul class="org-ul">
<li>Affects HDF5 1.12.1</li>
<li>Discovered by Jan-Willem Blokland &amp; turns out to be a goof-up in our CMake
files</li>
<li>Fixed in <a href="https://github.com/HDFGroup/hdf5/pull/843">PR #843</a></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
<div id="outline-container-org75d6ec2" class="outline-3">
<h3 id="org75d6ec2">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org75d6ec2">
</div>
<ul class="org-ul">
<li><a id="orgb7b5f34"></a>What is SWMR &amp; what's new w/ VFD SWMR?<br />
<div class="outline-text-4" id="text-orgb7b5f34">
<ul class="org-ul">
<li>SWMR = Single Writer Multiple Readers</li>
<li>Use case: "Process collaboration w/o communication"
<ul class="org-ul">
<li>Read from an HDF5 file that is actively being written</li>
<li>"w/o communication"  = no inter-process communication (IPC) required</li>
</ul></li>
<li>That's a big ask!
<ul class="org-ul">
<li>How do we ensure that the readers don't read invalid, inconsistent, or corrupt data?</li>
<li>How do we ensure that readers eventually see updates?
<ul class="org-ul">
<li>Can we bound that delay?</li>
</ul></li>
<li>Does this require any special HW/SW support?</li>
</ul></li>
<li>Initial release in HDF5 1.10.0 (March 30 2016)</li>
</ul>
</div>

<ul class="org-ul">
<li><a id="org42e032d"></a>Limitations of the first implementation<br />
<div class="outline-text-5" id="text-org42e032d">
<ul class="org-ul">
<li>No support for new items, e.g., objects, attributes, etc., no deletion
<ul class="org-ul">
<li>Dataset append only</li>
</ul></li>
<li>Reliance on strict write ordering and atomic write guarantee as per POSIX semantics
<ul class="org-ul">
<li>Many file systems don't do that, e.g., NFS</li>
</ul></li>
<li>Implementation touches most parts of the HDF5 library: high maintenance cost</li>
</ul>
</div>
</li>

<li><a id="org7ddd13c"></a>What VFD SWMR brings<br />
<div class="outline-text-5" id="text-org7ddd13c">
<ul class="org-ul">
<li>Arbitrary item and object creation/deletion</li>
<li>Configurable bound (maximum time) between write and read</li>
<li>Easier to maintain because of VFD-level implementation</li>
<li>Relaxed storage requirements, i.e., the implementation can be modified to support NFS or object stores</li>
</ul>
</div>
</li>

<li><a id="org70157d6"></a>How is it done?<br />
<div class="outline-text-5" id="text-org70157d6">
<ul class="org-ul">
<li>Writer generates periodic snapshots of metadata at points when it's known to be in a consistent state
<ul class="org-ul">
<li>These snapshot live outside the HDF5 file proper</li>
</ul></li>
<li>Readers' MD requests are satisfied from snapshots or unchanged MD in the HDF5 file</li>
<li>Devil's in the detail, e.g., to guarantee time between write and read, we need to bound the maximum size of MD changes and use page buffering
<ul class="org-ul">
<li>See the <a href="https://docs.hdfgroup.org/hdf5/rfc/VFD_SWMR_RFC_191027.pdf">RFC</a> for the details</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org4485e8f" class="outline-2">
<h2 id="org4485e8f">Clinic 2021-08-03</h2>
<div class="outline-text-2" id="text-org4485e8f">
</div>
<div id="outline-container-orge73cfea" class="outline-3">
<h3 id="orge73cfea">Your Questions</h3>
<div class="outline-text-3" id="text-orge73cfea">
<dl class="org-dl">
<dt>Q</dt><dd>Will the HDF5 1.12.1 file locking changes be brought to 1.10.8?</dd>

<dt>Q</dt><dd>Im interested in PyDarshan and its analysis of HDF5 Darshan Logs. The current resource that I have is <a href="https://nbviewer.jupyter.org/github/HDFGroup/hdf5-iotest/blob/master/examples/pydarshan-hdf5-tutorial.ipynb">this</a>. Any other reference or documentation that you could point out? Thank you (Marta Garcia, ANL)</dd>
</dl>
</div>
</div>

<div id="outline-container-org536f7d8" class="outline-3">
<h3 id="org536f7d8">Last week's highlights</h3>
<div class="outline-text-3" id="text-org536f7d8">
</div>
<ul class="org-ul">
<li><a id="orgbec7690"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org607999e"></a><a href="https://forum.hdfgroup.org/t/release-of-hdfview-3-1-3-newsletter-179-the-hdf-group/8789">HDFView 3.1.3</a> was released<br /></li>
</ul>
</li>
<li><a id="orga4eb9f4"></a>Forum<br />
<ul class="org-ul">
<li><a id="org90f0ad4"></a><a href="https://forum.hdfgroup.org/t/check-all-members-of-compound-datatype-are-present/8795">Check all members of compound datatype are present?</a><br />
<div class="outline-text-5" id="text-org90f0ad4">
<ul class="org-ul">
<li>Error is in the eye of the beholder</li>
<li><code>H5Tequal</code> is of limited use</li>
<li>Provide or modify symbolic information in a single place</li>
<li>Use named datatypes for documentation</li>
</ul>
</div>
</li>
<li><a id="orgcfb6bb5"></a><a href="https://forum.hdfgroup.org/t/phdf5-1-12-data-transform-in-combination-with-compression-filter/8799">pHDF5 1.12: data transform in combination with compression filter</a><br />
<div class="outline-text-5" id="text-orgcfb6bb5">
<ul class="org-ul">
<li>Poor documentation (on our part)
<ul class="org-ul">
<li>Who reads release notes?</li>
</ul></li>
<li>Dropped feature in "rush to the release"</li>
<li>Will add a note to <code>H5Pset_compressionX</code> calls</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orgea34148" class="outline-3">
<h3 id="orgea34148">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orgea34148">
</div>
<ul class="org-ul">
<li><a id="chunk_analyzer.c"></a>New function <code>H5Dchunk_iter</code><br />
<div class="outline-text-4" id="text-chunk_analyzer.c">
<ul class="org-ul">
<li>Lets you iterate over dataset chunks, for example, to explore variability in
compression</li>
<li>Currently in the <code>develop</code> branch</li>
</ul>

<p>
<i>Let's write a simple "chunk analyzer!"</i>
</p>
</div>

<ul class="org-ul">
<li><a id="org94cee81"></a>Basic idea<br />
<div class="outline-text-5" id="text-org94cee81">
<p>
Provide an HDF5 file name as the single argument.
</p>

<div class="org-src-container">
<pre class="src src-C">
<span style="color: #808080;">#include</span> <span style="color: #008000;">"hdf5.h"</span>

<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdlib.h&gt;</span>
<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdio.h&gt;</span>

<span style="color: #0000FF;">static</span> <span style="color: #6434A3;">herr_t</span> <span style="color: #006699;">visit_cb</span>(<span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">obj</span>, <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">char</span> *<span style="color: #BA36A5;">name</span>, <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">H5O_info2_t</span> *<span style="color: #BA36A5;">info</span>,
                       <span style="color: #6434A3;">void</span> *<span style="color: #BA36A5;">op_data</span>);

<span style="color: #6434A3;">int</span> <span style="color: #006699;">main</span>(<span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">argc</span>, <span style="color: #6434A3;">char</span> **<span style="color: #BA36A5;">argv</span>)
{
  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">retval</span> = EXIT_SUCCESS;
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file</span>;
  <span style="color: #6434A3;">char</span> <span style="color: #BA36A5;">path</span>[] = {<span style="color: #008000;">"/"</span>};

  <span style="color: #0000FF;">if</span> (argc &lt; 2) {
    printf(<span style="color: #008000;">"HDF5 file name required!"</span>);
    <span style="color: #0000FF;">return</span> EXIT_FAILURE;
  }

  <span style="color: #0000FF;">if</span> ((file = H5Fopen(argv[1], H5F_ACC_RDONLY, H5P_DEFAULT)) ==
      H5I_INVALID_HID) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">let's visit all objects in the file</span>
  <span style="color: #0000FF;">if</span> (H5Ovisit(file, H5_INDEX_NAME , H5_ITER_NATIVE , &amp;visit_cb, path,
               H5O_INFO_BASIC) &lt; 0) {
    retval = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_visit</span>;
  }

 <span style="color: #D0372D;">fail_visit</span>:
  H5Fclose(file);
 <span style="color: #D0372D;">fail_file</span>:
  <span style="color: #0000FF;">return</span> retval;
}

</pre>
</div>
</div>
</li>

<li><a id="org0b548e8"></a>Callback for <code>H5Ovisit</code><br />
<div class="outline-text-5" id="text-org0b548e8">
<div class="org-src-container">
<pre class="src src-C">
<span style="color: #0000FF;">static</span> <span style="color: #6434A3;">int</span> <span style="color: #006699;">chunk_cb</span>(<span style="color: #0000FF;">const</span> <span style="color: #6434A3;">hsize_t</span> *<span style="color: #BA36A5;">offset</span>, <span style="color: #6434A3;">uint32_t</span> <span style="color: #BA36A5;">filter_mask</span>, <span style="color: #6434A3;">haddr_t</span> <span style="color: #BA36A5;">addr</span>,
                    <span style="color: #6434A3;">uint32_t</span> <span style="color: #BA36A5;">nbytes</span>, <span style="color: #6434A3;">void</span> *<span style="color: #BA36A5;">op_data</span>);

<span style="color: #6434A3;">herr_t</span> <span style="color: #006699;">visit_cb</span>(<span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">obj</span>, <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">char</span> *<span style="color: #BA36A5;">name</span>, <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">H5O_info2_t</span> *<span style="color: #BA36A5;">info</span>,
                <span style="color: #6434A3;">void</span> *<span style="color: #BA36A5;">op_data</span>)
{
  <span style="color: #6434A3;">herr_t</span> <span style="color: #BA36A5;">retval</span> = 0;
  <span style="color: #6434A3;">char</span>* <span style="color: #BA36A5;">base_path</span> = (<span style="color: #6434A3;">char</span>*) op_data;

  <span style="color: #0000FF;">if</span> (info-&gt;type == H5O_TYPE_DATASET)  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">current object is a dataset</span>
    {
      <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dset</span>, <span style="color: #BA36A5;">dcpl</span>;
      <span style="color: #0000FF;">if</span> ((dset = H5Dopen(obj, name, H5P_DEFAULT)) == H5I_INVALID_HID) {
        retval = -1;
        <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">func_leave</span>;
      }
      <span style="color: #0000FF;">if</span> ((dcpl = H5Dget_create_plist(dset)) == H5I_INVALID_HID) {
        retval = -1;
        <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dcpl</span>;
      }
      <span style="color: #0000FF;">if</span> (H5Pget_layout(dcpl) == H5D_CHUNKED) <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">dataset is chunked</span>
        {
          <span style="color: #6434A3;">__label__</span> <span style="color: #BA36A5;">fail_dtype</span>, <span style="color: #BA36A5;">fail_dspace</span>, <span style="color: #BA36A5;">fail_fig</span>;
          <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">dspace</span>, <span style="color: #BA36A5;">dtype</span>;
          <span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">size</span>, <span style="color: #BA36A5;">i</span>;
          <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">rank</span>;
          <span style="color: #6434A3;">hsize_t</span> <span style="color: #BA36A5;">cdims</span>[H5S_MAX_RANK];

          <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">get resources</span>
          <span style="color: #0000FF;">if</span> ((dtype = H5Dget_type(dset)) &lt; 0) {
            retval = -1;
            <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dtype</span>;
          }
          <span style="color: #0000FF;">if</span> ((dspace = H5Dget_space(dset)) &lt; 0) {
            retval = -1;
            <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dspace</span>;
          }
          <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">get the figures</span>
          <span style="color: #0000FF;">if</span> ((size = H5Tget_size(dtype)) == 0 ||
              (rank = H5Sget_simple_extent_ndims(dspace)) &lt; 0 ||
              H5Pget_chunk(dcpl, H5S_MAX_RANK, cdims) &lt; 0) {
            retval = -1;
            <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_fig</span>;
          }
          <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">calculate the nominal chunk size</span>
          size = 1;
          <span style="color: #0000FF;">for</span> (i = 0; i &lt; (<span style="color: #6434A3;">size_t</span>) rank; ++i)
            size *= cdims[i];
          <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">print dataset info</span>
          printf(<span style="color: #008000;">"%s%s : nominal chunk size %lu [B] \n"</span>, base_path, name,
                 size);
          <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">get the allocated chunk sizes</span>
          <span style="color: #0000FF;">if</span> (H5Dchunk_iter(dset, H5P_DEFAULT, &amp;chunk_cb, <span style="color: #D0372D;">NULL</span>) &lt; 0) {
            retval = -1;
            <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_fig</span>;
          }

        <span style="color: #D0372D;">fail_fig</span>:
          H5Sclose(dspace);
        <span style="color: #D0372D;">fail_dspace</span>:
          H5Tclose(dtype);
        <span style="color: #D0372D;">fail_dtype</span>:;
        }

      H5Pclose(dcpl);
    <span style="color: #D0372D;">fail_dcpl</span>:
      H5Dclose(dset);
    }

 <span style="color: #D0372D;">func_leave</span>:
  <span style="color: #0000FF;">return</span> retval;
}

</pre>
</div>
</div>
</li>

<li><a id="org5fc1e59"></a>Callback for <code>H5Dchunk_iter</code><br />
<div class="outline-text-5" id="text-org5fc1e59">
<div class="org-src-container">
<pre class="src src-C">
<span style="color: #6434A3;">int</span> <span style="color: #006699;">chunk_cb</span>(<span style="color: #0000FF;">const</span> <span style="color: #6434A3;">hsize_t</span> *<span style="color: #BA36A5;">offset</span>, <span style="color: #6434A3;">uint32_t</span> <span style="color: #BA36A5;">filter_mask</span>, <span style="color: #6434A3;">haddr_t</span> <span style="color: #BA36A5;">addr</span>,
             <span style="color: #6434A3;">uint32_t</span> <span style="color: #BA36A5;">nbytes</span>, <span style="color: #6434A3;">void</span> *<span style="color: #BA36A5;">op_data</span>)
{
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">for now we care only about the allocated chunk size</span>
  printf(<span style="color: #008000;">"%d\n"</span>, nbytes);
  <span style="color: #0000FF;">return</span> EXIT_SUCCESS;
}

</pre>
</div>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org129281a" class="outline-2">
<h2 id="org129281a">Clinic 2021-07-27</h2>
<div class="outline-text-2" id="text-org129281a">
</div>
<div id="outline-container-orgab7d8c5" class="outline-3">
<h3 id="orgab7d8c5">Your Questions</h3>
<div class="outline-text-3" id="text-orgab7d8c5">
<dl class="org-dl">
<dt>Q</dt><dd>Will the HDF5 1.12.1 file locking changes be brought to 1.10.8?</dd>

<dt>Q</dt><dd>Is there any experience using HDF5 for MPI output with compression on a
progressively striped Lustre system? Were seeing some file corruption and we
are wondering where the problem lies. - Sean Freeman</dd>
<dt>A</dt><dd>Nothing comes to mind that's related to that, but it might be good to
see what MPI and MPI I/O backend the user is using, since we've had issues
with ROMIO in the past for example. - <a href="mailto:jhenderson@hdfgroup.org">Jordan Henderson</a>
<ul class="org-ul">
<li>HPE MPT from SGI, not using ROMIO</li>
<li>Maybe an MVE?</li>
</ul></dd>
</dl>
</div>
</div>
<div id="outline-container-org74dec1a" class="outline-3">
<h3 id="org74dec1a">Last week's highlights</h3>
<div class="outline-text-3" id="text-org74dec1a">
</div>
<ul class="org-ul">
<li><a id="org1fdeb95"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org765b6f4"></a><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a><br />
<div class="outline-text-5" id="text-org765b6f4">
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for presentation abstracts: <span class="timestamp-wrapper"><span class="timestamp">[2021-08-01 Sun]</span></span></li>
<li>Event: 12-15 October 2021</li>
</ul>
</div>
</li>
<li><a id="orgf69016a"></a><a href="https://docs.hdfgroup.org/hdf5/develop/_r_f_c.html">HDF5 RFCs</a><br />
<div class="outline-text-5" id="text-orgf69016a">
<ul class="org-ul">
<li>All RFCs in one place</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org7462383"></a>Forum<br />
<ul class="org-ul">
<li><a id="org51108bb"></a><a href="https://forum.hdfgroup.org/t/h5i-dec-ref-hangs/8104">H5i<sub>dec</sub><sub>ref</sub> hangs</a><br />
<div class="outline-text-5" id="text-org51108bb">
<ul class="org-ul">
<li>Parallel HDF5 "misbehavior" can be subtle</li>
<li><a href="https://portal.hdfgroup.org/display/HDF5/Collective+Calling+Requirements+in+Parallel+HDF5+Applications">Collective Calling Requirements in Parallel HDF5 Applications</a>
<ul class="org-ul">
<li>Allocation time, fill behavior, etc., are less visible, but included</li>
<li>Always ask if an operation has the potential to create any "metadata
disparity?"</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orgd2b6a90"></a><a href="https://forum.hdfgroup.org/t/how-to-read-a-utf-8-string/6125">How to read a UTF-8 string</a><br />
<div class="outline-text-5" id="text-orgd2b6a90">
<ul class="org-ul">
<li><code>H5T_CSET_UTF8</code> for character encoding</li>
<li>The is currently a subtle bug in string handling <a href="https://github.com/HDFGroup/hdf5/issues/544">Inconsistent behaviour with variable-length strings and character encoding #544</a>
<ul class="org-ul">
<li>ASCII is a proper subset of UTF-8 with byte-identical encodings</li>
<li>The HDF5 library is blissfully ignorant about that&#x2026;</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org6cab0eb"></a><a href="https://forum.hdfgroup.org/t/when-should-mpi-barrier-be-used-when-using-parallel-hdf5/8761">When should MPI barrier be used when using Parallel HDF5?</a><br />
<div class="outline-text-5" id="text-org6cab0eb">
<ul class="org-ul">
<li>Only if you want to achieve a certain consistency semantics ("processes
communicating through a file")
<ul class="org-ul">
<li>See <a href="https://docs.hdfgroup.org/hdf5/rfc/RFC%20PHDF5%20Consistency%20Semantics%20MC%20120328.docx.pdf">Enabling a Strict Consistency Semantics Model in Parallel HDF5</a></li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orga4cdcd6"></a><a href="https://forum.hdfgroup.org/t/hug-2021-hdf5-wishlist/8545">Make a wish!</a><br />
<div class="outline-text-5" id="text-orga4cdcd6">
<ul class="org-ul">
<li>What small changes would make a big difference in your HDF5 workflow?</li>
<li>Chime in!</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org178bfb4" class="outline-3">
<h3 id="org178bfb4">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org178bfb4">
</div>
<ul class="org-ul">
<li><a id="org3c39ceb"></a>User-defined Properties<br />
<div class="outline-text-4" id="text-org3c39ceb">
<ul class="org-ul">
<li><b>Use case:</b> You want to pass property list-like things (dictionaries) around,
your language doesn't have dictionaries, and you don't want to re-invent the
wheel
<ul class="org-ul">
<li>You want to stay close to the "HDF5 way of doing things"</li>
</ul></li>
<li>See <a href="https://docs.hdfgroup.org/hdf5/develop/group___g_p_l_o_a.html">General Property List Operations (Advanced)</a></li>
<li>You can define your own property list classes w/ pre-defined or "permanent"
properties</li>
<li>You can insert "temporary" (= non-permanent) properties into any property list</li>
<li><b>WARNING:</b> Permanent or temporary, <i>none</i> of this is persisted in the HDF5
file!
<ul class="org-ul">
<li>These property lists (and properties) get copied between APIs provided
you've implemented the necessary callbacks</li>
<li>Depending on the property value types, make sure you implement proper
resource management, or memory leaks might occur</li>
</ul></li>
<li>It's an esoteric/advanced/infrequently used feature, but might be just what
you need in certain circumstances</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgebe778b" class="outline-2">
<h2 id="orgebe778b">Clinic 2021-07-20</h2>
<div class="outline-text-2" id="text-orgebe778b">
</div>
<div id="outline-container-orge148c68" class="outline-3">
<h3 id="orge148c68">Your Questions</h3>
<div class="outline-text-3" id="text-orge148c68">
<dl class="org-dl">
<dt>Q</dt><dd>Will the HDF5 1.12.1 file locking changes be brought to 1.10.8?</dd>

<dt>Q</dt><dd>Named types, what are the benefits?
<dl class="org-dl">
<dt>A</dt><dd>Documentation and convenience. You don't have to (re-)create the
datatype over and over. Just open it and pass the handle to attribute and
dataset creations!</dd>
</dl></dd>
</dl>
</div>
</div>

<div id="outline-container-org93dac6f" class="outline-3">
<h3 id="org93dac6f">Last week's highlights</h3>
<div class="outline-text-3" id="text-org93dac6f">
</div>
<ul class="org-ul">
<li><a id="orgfe8290c"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org47b1d90"></a><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a><br />
<div class="outline-text-5" id="text-org47b1d90">
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for presentation abstracts: <span class="timestamp-wrapper"><span class="timestamp">[2021-08-01 Sun]</span></span></li>
<li>Event: 12-15 October 2021</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org72320be"></a>Forum<br />
<ul class="org-ul">
<li><a id="org789269d"></a><a href="https://forum.hdfgroup.org/t/migrating-pandas-and-local-hf5-to-hsds/8721">Migrating pandas and local HF5 to HSDS </a><br />
<div class="outline-text-5" id="text-org789269d">
<ul class="org-ul">
<li>John Readey posted a nice comment referencing an article that shows how to map
pandas dataframes to HDF5 via <code>h5py</code></li>
<li>The same will also work w/ <code>h5pyd</code></li>
</ul>
</div>
</li>
<li><a id="orgdefd47a"></a><a href="https://forum.hdfgroup.org/t/local-hsds-performance-vs-local-hdf5-files/8652">Local HSDS performance vs local HDF5 files</a><br />
<div class="outline-text-5" id="text-orgdefd47a">
<ul class="org-ul">
<li>Interesting exchange of benchmark results</li>
<li>Data (response) preparation in HSDS seems to be slow</li>
<li>The big question is why HSDS is sending data at a 10x lower rate than a
vanilla REST API (339 MB/s versus 4,384 MB/s)</li>
</ul>
</div>
</li>
<li><a id="org5351cf8"></a><a href="https://forum.hdfgroup.org/t/mpi-io-file-info-actually-used/8751">MPI-IO file info actually used</a><br />
<div class="outline-text-5" id="text-org5351cf8">
<ul class="org-ul">
<li>The <code>MPI_Info</code> object returned by <code>H5Pget_fapl_mpio</code> does not return the full
set of hints seen by MPI</li>
</ul>
</div>
</li>
<li><a id="orgbdbde13"></a><a href="https://forum.hdfgroup.org/t/hug-2021-hdf5-wishlist/8545">Make a wish!</a><br />
<div class="outline-text-5" id="text-orgbdbde13">
<ul class="org-ul">
<li>What small changes would make a big difference in your HDF5 workflow?</li>
<li>Chime in!</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orge2e1a2b" class="outline-3">
<h3 id="orge2e1a2b">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orge2e1a2b">
</div>
<ul class="org-ul">
<li><a id="org3732f17"></a>HDF5 File Images<br />
<div class="outline-text-4" id="text-org3732f17">
<ul class="org-ul">
<li>Use cases
<ul class="org-ul">
<li>In-memory I/O</li>
<li>Share HDF5 data between processes w/o a file system</li>
<li>Transmit HDF5 data packets over a network</li>
</ul></li>
<li>See also Vijay Kartik's (DESY) <a href="https://youtu.be/E3bIeFw02dc">presentation</a> and <a href="https://www.hdfgroup.org/wp-content/uploads/2021/07/VijayKartik_HDF5_Serialization.pdf">slides</a> from HUG 2021 Europe</li>
<li>Starting point: HDF5 core VFD
<ul class="org-ul">
<li>Replace the file (logical byte sequence) with a memory buffer</li>
<li><code>read</code>, <code>write</code> -&gt; <code>memcpy</code></li>
</ul></li>
<li>HDF5 file images generalize that concept
<ul class="org-ul">
<li>Memory buffer + management interface (callbacks)</li>
<li>Reference: <a href="https://docs.hdfgroup.org/hdf5/rfc/HDF5FileImageOperations.pdf">HDF5 File Image Operations</a></li>
</ul></li>
<li>HDF5 file images can be exchanged between processes via IPC (shared memory
segment) or a TCP connection</li>
<li><p>
See section 4 (Examples) in the reference
</p>

<pre class="example" id="orgedfb9d5">
+++ Process A +++                          +++ Process B +++

&lt;Open and construct the desired file       hid_t file_;
with the Core file driver&gt;

H5Fflush(fid);
size = H5Fget_file_image(fid, NULL, 0);
buffer_ptr = malloc(size);
H5Fget_file_image(fid, buffer_ptr, size);

&lt;transmit size&gt;                           &lt;receive size&gt;
                                          buffer_ptr = malloc(size)
&lt;transmit *buffer_ptr&gt;                    &lt;receive image in *buffer_ptr&gt;
free(buffer_ptr);
&lt;close core file&gt;                         file_id = H5LTopen_file_image
                                                    (
                                                     buf,
                                                     buf_len,
                                                     H5LT_FILE_IMAGE_DONT_COPY
                                                    );

                                          &lt;read data from file, then close.
                                           note that the Core file driver
                                           will discard the buffer on close&gt;
</pre></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org1a7c210" class="outline-2">
<h2 id="org1a7c210">Clinic 2021-07-13</h2>
<div class="outline-text-2" id="text-org1a7c210">
</div>
<div id="outline-container-orgb721519" class="outline-3">
<h3 id="orgb721519">Your Questions</h3>
<div class="outline-text-3" id="text-orgb721519">
<dl class="org-dl">
<dt>Q</dt><dd>Will the HDF5 1.12.1 file locking changes be brought to 1.10.8?</dd>
</dl>
</div>
</div>

<div id="outline-container-orgdbd8ca8" class="outline-3">
<h3 id="orgdbd8ca8">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgdbd8ca8">
</div>
<ul class="org-ul">
<li><a id="orgdb9e69f"></a>HUG 2021 Europe<br />
<div class="outline-text-4" id="text-orgdb9e69f">
<ul class="org-ul">
<li>The presentations from the European HUG 2021 event are now available on <a href="https://www.youtube.com/watch?v=NRS8oV7T9BE&amp;list=PLPyhR4PdEeGbiXGJ4ykBf3JEw6to8rmB3">YouTube</a></li>
</ul>
</div>
</li>
<li><a id="orgec3a3ce"></a>Announcements<br />
<ul class="org-ul">
<li><a id="orgc4395fb"></a><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a><br />
<div class="outline-text-5" id="text-orgc4395fb">
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for presentation abstracts: <span class="timestamp-wrapper"><span class="timestamp">[2021-08-01 Sun]</span></span></li>
<li>Event: 12-15 October 2021</li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="orga0d6239"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgbd9f4fe"></a><a href="https://forum.hdfgroup.org/t/hdf5-specs-unclear-b-tree-v2-and-fractal-heap/8723">HDF5 specs unclear: B-tree v2 and fractal heap </a><br />
<div class="outline-text-5" id="text-orgbd9f4fe">
<ul class="org-ul">
<li>There was a lot of interest in accessing HDF5 files directly, i.e., w/o the
HDF5 library</li>
<li>Good clarity test for the <a href="https://docs.hdfgroup.org/hdf5/develop/_f_m_t3.html">file format spec</a>.</li>
<li>Someone is extending the <a href="https://github.com/jjhelmus/pyfive"><code>pyfive</code></a> pure Python HDF5 reader and asked for heap
ID clarification</li>
</ul>
</div>
</li>

<li><a id="orgfe87cc6"></a><a href="https://forum.hdfgroup.org/t/building-rest-vol-on-windows-10/8654">Building REST VOL on Windows 10</a><br />
<div class="outline-text-5" id="text-orgfe87cc6">
<ul class="org-ul">
<li>REST VOL = access HSDS via the HDF5 library, converts HDF5 library calls into
RESTful requests (and back)</li>
<li>Requires <code>libcurl</code> and massaging the linker flags</li>
</ul>
</div>
</li>

<li><a id="org65bbaa2"></a><a href="https://forum.hdfgroup.org/t/file-storage-on-aws-s3/8715">File storage on AWS S3</a><br />
<div class="outline-text-5" id="text-org65bbaa2">
<ul class="org-ul">
<li>Where did the data go?</li>
<li>The documentation can be found <a href="https://github.com/HDFGroup/hsds/blob/master/docs/design/obj_store_schema/obj_store_schema_v2.md">here</a></li>
</ul>
</div>
</li>

<li><a id="orgc94a30e"></a><a href="https://forum.hdfgroup.org/t/migrating-pandas-and-local-hf5-to-hsds/8721">Migrating pandas and local HF5 to HSDS </a><br />
<div class="outline-text-5" id="text-orgc94a30e">
<ul class="org-ul">
<li>Using <a href="https://www.digitalocean.com/products/spaces/">DigitalOcean and spaces</a> instead of AWS S3</li>
<li>Using <a href="https://pandas.pydata.org/"><code>pandas</code></a>
<ul class="org-ul">
<li>Will that work?</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="org5cbe842"></a><a href="https://forum.hdfgroup.org/t/local-hsds-performance-vs-local-hdf5-files/8652">Local HSDS performance vs local HDF5 files</a><br />
<div class="outline-text-5" id="text-org5cbe842">
<ul class="org-ul">
<li>User observed a 10x slowdown for reads</li>
<li>What to expect?
<ul class="org-ul">
<li>Several sources for slowdown (e.g., compression, IPC)</li>
</ul></li>
<li>John Ready is working on a comprehensive performance test suite</li>
</ul>
</div>
</li>

<li><a id="org7bbaffb"></a><a href="https://forum.hdfgroup.org/t/start-list-of-vol-plugins/8714">Start list of VOL plugins?</a><br />
<div class="outline-text-5" id="text-org7bbaffb">
<ul class="org-ul">
<li><a href="https://portal.hdfgroup.org/display/support/Registered+VOL+Connectors">List of VOL Connectors Registered with The HDF Group</a></li>
</ul>
</div>
</li>

<li><a id="org74b257d"></a><a href="https://forum.hdfgroup.org/t/h5diff-and-ignoring-attributes/8553">h5diff and ignoring attributes</a><br />
<div class="outline-text-5" id="text-org74b257d">
<ul class="org-ul">
<li>Now in HDF5 <code>develop</code> as <code>--exclude-attribute</code> option for <code>h5diff</code></li>
</ul>
</div>
</li>

<li><a id="org8515e49"></a><a href="https://forum.hdfgroup.org/t/hug-2021-hdf5-wishlist/8545">Make a wish!</a><br />
<div class="outline-text-5" id="text-org8515e49">
<ul class="org-ul">
<li>What small changes would make a big difference in your HDF5 workflow?</li>
<li>Chime in!</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org0af9ecc" class="outline-3">
<h3 id="org0af9ecc">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org0af9ecc">
</div>
<ul class="org-ul">
<li><a id="org9eef5f7"></a>HDF5 documentation updates<br />
<div class="outline-text-4" id="text-org9eef5f7">
<ul class="org-ul">
<li><a href="http://docs.hdfgroup.org.s3-website.us-east-2.amazonaws.com/hdf5/develop/index.html">docs.hdfgroup.org/hdf5/develop/</a></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgae6b50e" class="outline-2">
<h2 id="orgae6b50e">Clinic 2021-07-06</h2>
<div class="outline-text-2" id="text-orgae6b50e">
</div>
<div id="outline-container-orgda9f2d8" class="outline-3">
<h3 id="orgda9f2d8">Your Questions</h3>
<div class="outline-text-3" id="text-orgda9f2d8">
<dl class="org-dl">
<dt>Q</dt><dd>Will the HDF5 1.12.1 file locking changes be brought to 1.10.8?</dd>
</dl>
</div>
</div>

<div id="outline-container-org9fc8e04" class="outline-3">
<h3 id="org9fc8e04">Last week's highlights</h3>
<div class="outline-text-3" id="text-org9fc8e04">
</div>
<ul class="org-ul">
<li><a id="orga1ce2d6"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org5e0de03"></a><a href="https://forum.hdfgroup.org/t/european-hdf-users-group-hug-summer-2021-july-7-8-2021/8632">European HDF Users Group (HUG) Summer 2021 July 7-8, 2021</a><br />
<div class="outline-text-5" id="text-org5e0de03">
<ul class="org-ul">
<li><a href="https://zoom.us/meeting/register/tJUpde6srTwqGtPry8kfJthku8Eg2JZDrv28">Register for tomorrow's event!</a></li>
</ul>
</div>
</li>
<li><a id="org5a8ce77"></a><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a><br />
<div class="outline-text-5" id="text-org5a8ce77">
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for presentation abstracts: <span class="timestamp-wrapper"><span class="timestamp">[2021-08-01 Sun]</span></span></li>
<li>Event: 12-15 October 2021</li>
</ul>
</div>
</li>
<li><a id="orgf464141"></a><a href="https://forum.hdfgroup.org/t/reference-manual-in-doxygen/8230">Reference Manual in Doxygen</a><br />
<div class="outline-text-5" id="text-orgf464141">
<ul class="org-ul">
<li>New permanent home for HDF5 documentation</li>
<li><a href="https://docs.hdfgroup.org/hdf5/develop/">https://docs.hdfgroup.org/hdf5/develop/</a></li>
<li><a href="https://docs.hdfgroup.org/hdf5/v1_12/">https://docs.hdfgroup.org/hdf5/v1<sub>12</sub>/</a></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="orgfd3e381"></a>Forum<br />
<ul class="org-ul">
<li><a id="org367df9e"></a><a href="https://forum.hdfgroup.org/t/hug-2021-hdf5-wishlist/8545">Make a wish!</a><br />
<div class="outline-text-5" id="text-org367df9e">
<ul class="org-ul">
<li>What small changes would make a big difference in your HDF5 workflow?</li>
<li>Chime in!</li>
</ul>
</div>
</li>
<li><a id="org4c441d3"></a><a href="https://forum.hdfgroup.org/t/problems-with-hdf5-and-swmr-on-nfs-mounted-network-disk/8672">Problems with HDF5 and SWMR on NFS mounted network disk</a><br />
<div class="outline-text-5" id="text-org4c441d3">
<ul class="org-ul">
<li>Current SWMR implementation depends on POSIX write semantics (esp. order
preservation)</li>
<li>NFS &amp; co. don't do that</li>
<li>VFD SWMR might change that</li>
</ul>
</div>
</li>
<li><a id="org7ed92a0"></a><a href="https://forum.hdfgroup.org/t/save-related-data/8680">Save related data</a><br /></li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org7778b46" class="outline-3">
<h3 id="org7778b46">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org7778b46">
</div>
<ul class="org-ul">
<li><a id="org531d18e"></a>HDF5 ecosystem: HDFql<br />
<div class="outline-text-4" id="text-org531d18e">
<ul class="org-ul">
<li>HDFql = Hierarchical Data Format query language</li>
<li>High-level and <i>declarative</i></li>
<li>SQL is the gold standard for simplicity and power
<ul class="org-ul">
<li>Adapted to HDF5</li>
</ul></li>
<li>A single <i>guest</i> language (HDFql) for multiple <i>host</i> languages (C, C++, Java,
Python, C#, Fortran, R)</li>
<li>Seamless parallelism (multiple cores, MPI)</li>
</ul>
</div>
<ul class="org-ul">
<li><a id="orgfb28e4e"></a>Example<br />
<div class="outline-text-5" id="text-orgfb28e4e">
<ul class="org-ul">
<li>Host language: Fortran</li>
<li>Find all datasets existing in an HDF5 file named <code>data.h5</code> that start with
<code>temperature</code> and are of data type <code>float</code></li>
<li>For each dataset found, print its name and read its data</li>
<li>Write the data into a file named <code>output.txt</code> in an ascending order</li>
<li>Each value (belonging to the data) is written in a new line using a UNIX-based
end of line (EOL) terminator</li>
</ul>

<div class="org-src-container">
<pre class="src src-fortran">
      <span style="color: #0000FF;">PROGRAM</span> <span style="color: #006699;">Example</span>
      USE HDFql
      <span style="color: #6434A3;">INTEGER</span> :: state
      state = hdfql_execute(<span style="color: #008000;">"USE FILE data.h5"</span>)
      state = hdfql_execute(
      <span style="color: #008000;">"SHOW DATASET LIKE **/^temperature WHERE DATA TYPE == FLOAT"</span>)
<span style="color: #8D8D84;">D     </span><span style="color: #8D8D84; font-style: italic;">O WHILE(hdfql_cursor_next() .EQ. HDFQL_SUCCESS)</span>
      <span style="color: #0000FF;">WRITE</span>(*, *) <span style="color: #008000;">"Dataset found: "</span>, hdfql_cursor_get_char()
      state = hdfql_execute(
      <span style="color: #008000;">"SELECT FROM "</span> // hdfql_cursor_get_char() //
      <span style="color: #008000;">" ORDER ASC INTO UNIX FILE output.txt SPLIT 1"</span>)
      <span style="color: #0000FF;">END</span> <span style="color: #0000FF;">DO</span>
      state = hdfql_execute(<span style="color: #008000;">"CLOSE FILE"</span>)
      <span style="color: #0000FF;">END</span> <span style="color: #0000FF;">PROGRAM</span>

</pre>
</div>

<div class="org-src-container">
<pre class="src src-sql">
<span style="color: #0000FF;">CREATE</span> <span style="color: #006699;">FILE</span> my_file.h5

<span style="color: #0000FF;">CREATE</span> <span style="color: #006699;">FILE</span> experiment.h5 <span style="color: #0000FF;">IN</span> PARALLEL

<span style="color: #0000FF;">CREATE</span> <span style="color: #006699;">GROUP</span> countries

<span style="color: #0000FF;">CREATE</span> <span style="color: #006699;">DATASET</span> <span style="color: #0000FF;">values</span> <span style="color: #0000FF;">AS</span> <span style="color: #6434A3;">FLOAT</span>(20, 40) <span style="color: #0000FF;">ENABLE</span> ZLIB

<span style="color: #0000FF;">INSERT</span> <span style="color: #0000FF;">INTO</span> measurements <span style="color: #0000FF;">VALUES</span> <span style="color: #0000FF;">FROM</span> EXCEL <span style="color: #006699;">FILE</span> <span style="color: #0000FF;">values</span>.xlsx

<span style="color: #0000FF;">INSERT</span> <span style="color: #0000FF;">INTO</span> dset(0:::1) <span style="color: #0000FF;">VALUES</span> <span style="color: #0000FF;">FROM</span> MEMORY 0

SHOW <span style="color: #006699;">ATTRIBUTE</span> group2 <span style="color: #0000FF;">LIKE</span> **/1|3

</pre>
</div>

<ul class="org-ul">
<li>Links
<ul class="org-ul">
<li><a href="https://www.hdfql.com/">HDFql home</a>
<ul class="org-ul">
<li>Binaries for Linux, Windows, and macOS</li>
</ul></li>
<li><a href="https://www.hdfql.com/examples/">HDFql examples</a></li>
<li><a href="https://www.hdfql.com/resources/LICENSE.txt">HDFql license</a></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org75a0252" class="outline-3">
<h3 id="org75a0252">Coming soon</h3>
<div class="outline-text-3" id="text-org75a0252">
</div>
<ul class="org-ul">
<li><a id="org45e1576"></a>What happens to open HDF5 handles/IDs when your program ends?<br />
<div class="outline-text-4" id="text-org45e1576">
<ul class="org-ul">
<li>Suggested by Quincey Koziol (LBNL)</li>
<li>We'll take it in pieces
<ul class="org-ul">
<li>Current behavior</li>
<li>How async I/O changes  that picture</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orgb620807"></a>Other topics of interest?<br /></li>
</ul>
</div>
</div>
<div id="outline-container-org1e293c6" class="outline-2">
<h2 id="org1e293c6">Clinic 2021-06-29</h2>
<div class="outline-text-2" id="text-org1e293c6">
</div>
<div id="outline-container-org2053078" class="outline-3">
<h3 id="org2053078">Your Questions</h3>
<div class="outline-text-3" id="text-org2053078">
<dl class="org-dl">
<dt>Q</dt><dd>Will the HDF5 1.12.1 file locking changes be brought to 1.10.8?</dd>
</dl>
</div>
</div>

<div id="outline-container-org5c09fce" class="outline-3">
<h3 id="org5c09fce">Last week's highlights</h3>
<div class="outline-text-3" id="text-org5c09fce">
</div>
<ul class="org-ul">
<li><a id="org625be4f"></a>Announcements<br />
<div class="outline-text-4" id="text-org625be4f">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/european-hdf-users-group-hug-summer-2021-july-7-8-2021/8632">European HDF Users Group (HUG) Summer 2021 July 7-8, 2021</a>
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/hug/europeanhug21/propose-a-presentation/">Propose a presentation</a>let us know youre interested as soon as possible.</li>
<li><a href="https://www.hdfgroup.org/hug/europeanhug21/submit-your-abstract/">Finalize your presentation</a> by sending in your abstract by June 30</li>
<li><a href="https://www.hdfgroup.org/hug/europeanhug21/submit-your-slide-deck-and-other-materials/">Submit your PPT</a> and other materials by July 6</li>
<li><a href="https://zoom.us/meeting/register/tJUpde6srTwqGtPry8kfJthku8Eg2JZDrv28">Attendee and Speaker Registration</a></li>
</ul></li>

<li><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a>
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for presentation abstracts: <span class="timestamp-wrapper"><span class="timestamp">[2021-08-01 Sun]</span></span></li>
<li>Event: 12-15 October 2021</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orgafb86f5"></a>Forum<br />
<ul class="org-ul">
<li><a id="org05074a1"></a><a href="https://forum.hdfgroup.org/t/hug-2021-hdf5-wishlist/8545">Make a wish!</a><br />
<div class="outline-text-5" id="text-org05074a1">
<ul class="org-ul">
<li>What small changes would make a big difference in your HDF5 workflow?</li>
<li>Chime in!</li>
</ul>
</div>
</li>
<li><a id="org91b091c"></a><a href="https://forum.hdfgroup.org/t/hdf5-performance/8622">HDF5 Performance</a><br />
<div class="outline-text-5" id="text-org91b091c">
<ul class="org-ul">
<li>User is seeing decent performance w/ packet tables <code>H5PT</code></li>
<li>Issue w/ deleting links (?)</li>
</ul>
</div>
</li>
<li><a id="orged0dfc0"></a><a href="https://forum.hdfgroup.org/t/local-hsds-performance-vs-local-hdf5-files/8652">Local HSDS performance vs local HDF5 files</a><br /></li>
<li><a id="org7a70f3b"></a><a href="https://forum.hdfgroup.org/t/hdfview-should-default-to-read-only-open/4584">HDFView should default to read-only open</a><br />
<div class="outline-text-5" id="text-org7a70f3b">
<ul class="org-ul">
<li>Yes!</li>
<li>Too many options? Sloppy testing?</li>
</ul>
</div>
</li>
<li><a id="org08941c6"></a><a href="https://forum.hdfgroup.org/t/hdf-port-to-rust/8639">HDF - port to Rust</a><br />
<div class="outline-text-5" id="text-org08941c6">
<ul class="org-ul">
<li>Not a bad idea: a BIG job</li>
<li>Perhaps not a replacement for the C implementation (How many systems have a
Rust compiler?)</li>
<li>I understand that that's not the point, but there are reasonably mature <a href="https://github.com/aldanor/hdf5-rust">Rust
language bindings for HDF5</a></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org59cd9b5" class="outline-3">
<h3 id="org59cd9b5">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org59cd9b5">
</div>
<ul class="org-ul">
<li><a id="orge8ce90d"></a>How do I delete an HDF5 item?<br />
<div class="outline-text-4" id="text-orge8ce90d">
<ul class="org-ul">
<li>HDF5 item = something a user created and that gets stored in an HDF5 file</li>
</ul>
</div>
<ul class="org-ul">
<li><a id="orga571bce"></a>High-level view<br />
<div class="outline-text-5" id="text-orga571bce">
<ul class="org-ul">
<li>Attributes - <a href="https://portal.hdfgroup.org/display/HDF5/H5A_DELETE"><code>H5Adelete*</code></a></li>
<li>Objects (groups, datasets, named datatypes) - <a href="https://portal.hdfgroup.org/display/HDF5/H5L_DELETE"><code>H5Ldelete*</code></a></li>
</ul>
</div>
</li>
<li><a id="orga470f06"></a>Low-level view<br />
<div class="outline-text-5" id="text-orga470f06">
<ul class="org-ul">
<li>Objects are <i>reference-counted</i> (in the object OHDR in the file!)</li>
<li>A positive reference count means the object is considered <i>in-use</i> or
referenced</li>
<li>A zero reference count signals to the HDF5 library free space availability</li>
<li>If that free space can be used or reclaimed depends on several factors
<ul class="org-ul">
<li>Position of the gap (middle of the file, end of the file)</li>
<li>Intervening file closure</li>
<li>Library version free-space management and tracking support</li>
<li>Virtual File Driver support</li>
</ul></li>
<li>A detailed description of file space management (including free space) can be
found in <a href="https://support.hdfgroup.org/HDF5/docNewFeatures/FileSpace/RFC-Paged_Aggregation.pdf">this RFC</a></li>
<li>Highlights:
<ul class="org-ul">
<li>Pre-HDF5 1.10.x
<ul class="org-ul">
<li>Free space info is <b>not</b> persisted across file open/close epochs
<ul class="org-ul">
<li>Typical symptom: deleting an object in another epoch will not reduce
file size</li>
</ul></li>
<li>Use <code>h5stat</code> to discover the amount of free-/unused space</li>
<li><code>h5repack</code> is the cheapest way to recover unused space
<ul class="org-ul">
<li>May not be practical for large files</li>
</ul></li>
</ul></li>
<li>HDF5 1.10.x+
<ul class="org-ul">
<li>Free space info can be persisted across file open/close epochs
<ul class="org-ul">
<li>Needs to be enabled in file creation property list</li>
<li>Set threshold on smallest quanta to be tracked</li>
<li>Combine with paged allocation!</li>
</ul></li>
</ul></li>
</ul></li>
<li>The story too involved for most users</li>
<li>Summary
<ul class="org-ul">
<li>Don't create (in the file) what you don't need</li>
<li>Use <code>h5stat</code> to assess and <code>h5repack</code> to reclaim free space: don't obsess
over a few KB!</li>
<li>If you really want to get into file space management, use HDF5 1.10.x+ and
come back next time with a <span class="underline">question</span>!</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org3049fc7" class="outline-3">
<h3 id="org3049fc7">Coming soon</h3>
<div class="outline-text-3" id="text-org3049fc7">
</div>
<ul class="org-ul">
<li><a id="orga17c657"></a>What happens to open HDF5 handles/IDs when your program ends?<br />
<div class="outline-text-4" id="text-orga17c657">
<ul class="org-ul">
<li>Suggested by Quincey Koziol (LBNL)</li>
<li>We'll take it in pieces
<ul class="org-ul">
<li>Current behavior</li>
<li>How async I/O changes  that picture</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org25776ff"></a>Other topics of interest?<br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgc8c965c" class="outline-2">
<h2 id="orgc8c965c">Clinic 2021-06-22</h2>
<div class="outline-text-2" id="text-orgc8c965c">
</div>
<div id="outline-container-orgd28d12c" class="outline-3">
<h3 id="orgd28d12c">Your Questions</h3>
<div class="outline-text-3" id="text-orgd28d12c">
<dl class="org-dl">
<dt>Q</dt><dd>What is the CacheVOL and what can I do with it? How can I use node-local
storage on an HPC system?
<ul class="org-ul">
<li>Complexity is hidden from users</li>
<li>Use in conjunction w/ Async VOL</li>
<li>Data migration to and from the remote storage is performed in the background</li>
<li>Developed by NERSC w/ Huihuo Zheng as the lead developer</li>
<li>No official release yet</li>
<li>See this <a href="https://www.exascaleproject.org/wp-content/uploads/2021/01/ECP-HDF5-Comm-BOF-All-Slides.pdf">ECP BoF presentation</a> (around slide 29)</li>
<li><a href="https://github.com/hpc-io/vol-cache">GitHub</a></li>
<li><a href="https://github.com/HDFGroup/hdf-spack">Spack integration</a></li>
</ul></dd>
<dt>Q</dt><dd>Will the HDF5 1.12.1 file locking changes be brought to 1.10.8?</dd>
</dl>
</div>
</div>
<div id="outline-container-orgc7571b2" class="outline-3">
<h3 id="orgc7571b2">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgc7571b2">
</div>
<ul class="org-ul">
<li><a id="orgc8c7b57"></a>Announcements<br />
<div class="outline-text-4" id="text-orgc8c7b57">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/european-hdf-users-group-hug-summer-2021-july-7-8-2021/8632">European HDF Users Group (HUG) Summer 2021 July 7-8, 2021</a>
<ul class="org-ul">
<li><a href="https://www.hdfgroup.org/hug/europeanhug21/propose-a-presentation/">Propose a presentation</a>let us know youre interested as soon as possible.</li>
<li><a href="https://www.hdfgroup.org/hug/europeanhug21/submit-your-abstract/">Finalize your presentation</a> by sending in your abstract by June 30</li>
<li><a href="https://www.hdfgroup.org/hug/europeanhug21/submit-your-slide-deck-and-other-materials/">Submit your PPT</a> and other materials by July 6</li>
<li><a href="https://zoom.us/meeting/register/tJUpde6srTwqGtPry8kfJthku8Eg2JZDrv28">Attendee and Speaker Registration</a></li>
</ul></li>

<li><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a>
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for presentation abstracts: <span class="timestamp-wrapper"><span class="timestamp">[2021-08-01 Sun]</span></span></li>
<li>Event: 12-15 October 2021</li>
</ul></li>
<li><a href="https://forum.hdfgroup.org/t/hdf5-udf-2-1-released-with-support-for-windows-and-macos/8631">HDF5-UDF 2.1 released  with support for Windows and macOS!</a></li>
</ul>
</div>
</li>
<li><a id="org746dd52"></a>Forum<br />
<ul class="org-ul">
<li><a id="org8f5990e"></a><a href="https://forum.hdfgroup.org/t/hug-2021-hdf5-wishlist/8545">Make a wish!</a><br />
<div class="outline-text-5" id="text-org8f5990e">
<ul class="org-ul">
<li>What small changes would make a big difference in your HDF5 workflow?</li>
<li>Chime in!</li>
</ul>
</div>
</li>
<li><a id="org5961b40"></a><a href="https://forum.hdfgroup.org/t/hdf5-performance/8622">HDF5 Performance</a><br />
<div class="outline-text-5" id="text-org5961b40">
<ul class="org-ul">
<li>Slowdown w/ a lot of attributes (10K, 100K, &#x2026;)</li>
<li>Slight improvement w/ a low-level fix (see below)</li>
<li>The customer is always right, but maybe this is not such a good idea</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orgb64fd5d" class="outline-3">
<h3 id="orgb64fd5d">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orgb64fd5d">
</div>
<ul class="org-ul">
<li><a id="orgfdd9f79"></a>How do I use a newer HDF5 file format?<br />
<div class="outline-text-4" id="text-orgfdd9f79">
<ul class="org-ul">
<li>Versions
<ul class="org-ul">
<li>HDF5 library</li>
<li>File format specification</li>
</ul></li>
<li>HDF5 library <i>forward- and backward-compatibility</i>
<dl class="org-dl">
<dt>Backward</dt><dd>The latest version of the library can read HDF5 files created
with all earlier library versions</dd>
<dt>Forward</dt><dd>A given version of the library can read all (objects in) HDF5
files created by later versions as long as they are compatible with this
version.</dd>
</dl></li>
<li>By default, newer HDF5 library versions use settings compatible with the
earliest library version</li>
</ul>

<div class="org-src-container">
<pre class="src src-C">
<span style="color: #808080;">#include</span> <span style="color: #008000;">"hdf5.h"</span>

<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdio.h&gt;</span>
<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdlib.h&gt;</span>

<span style="color: #6434A3;">int</span> <span style="color: #006699;">main</span>()
{
  <span style="color: #6434A3;">__label__</span> <span style="color: #BA36A5;">fail_fapl</span>, <span style="color: #BA36A5;">fail_file</span>;
  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">ret_val</span> = EXIT_SUCCESS;
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">fapl</span>, <span style="color: #BA36A5;">file</span>;

  {
    <span style="color: #6434A3;">unsigned</span> <span style="color: #BA36A5;">maj</span>, <span style="color: #BA36A5;">min</span>, <span style="color: #BA36A5;">rel</span>;
    <span style="color: #0000FF;">if</span> (H5get_libversion(&amp;maj, &amp;min, &amp;rel) &lt; 0) {
      ret_val = EXIT_FAILURE;
      <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_fapl</span>;
    }
    printf(<span style="color: #008000;">"Welcome to HDF5 %d.%d.%d!\n"</span>, maj, min, rel);
  }

  <span style="color: #0000FF;">if</span> ((fapl = H5Pcreate(H5P_FILE_ACCESS)) &lt; 0) {
    ret_val = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_fapl</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">bracket the range of LIBRARY VERSIONS for object creation and access,</span>
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">e.g., min. vers. 1.8, max. version current</span>
  <span style="color: #0000FF;">if</span> (H5Pset_libver_bounds(fapl, H5F_LIBVER_V18, H5F_LIBVER_LATEST) &lt; 0) {
    ret_val = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }

  <span style="color: #0000FF;">if</span> ((file = H5Fcreate(<span style="color: #008000;">"my.h5"</span>, H5F_ACC_TRUNC, H5P_DEFAULT, fapl)) &lt; 0) {
    ret_val = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">do something useful w/ FILE</span>

  H5Fclose(file);

 <span style="color: #D0372D;">fail_file</span>:
  H5Pclose(fapl);
 <span style="color: #D0372D;">fail_fapl</span>:;

  <span style="color: #0000FF;">return</span> ret_val;
}

</pre>
</div>
</div>
</li>
</ul>
</div>

<div id="outline-container-org757ec33" class="outline-3">
<h3 id="org757ec33">Coming soon</h3>
<div class="outline-text-3" id="text-org757ec33">
</div>
<ul class="org-ul">
<li><a id="orgeb5aebc"></a>What happens to open HDF5 handles/IDs when your program ends?<br />
<div class="outline-text-4" id="text-orgeb5aebc">
<ul class="org-ul">
<li>Suggested by Quincey Koziol (LBNL)</li>
<li>We'll take it in pieces
<ul class="org-ul">
<li>Current behavior</li>
<li>How async I/O changes  that picture</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org3298733"></a>Other topics of interest?<br /></li>
</ul>
</div>
</div>
<div id="outline-container-org3eb8847" class="outline-2">
<h2 id="org3eb8847">Clinic 2021-06-15</h2>
<div class="outline-text-2" id="text-org3eb8847">
</div>
<div id="outline-container-org09f30bc" class="outline-3">
<h3 id="org09f30bc">Your Questions</h3>
<div class="outline-text-3" id="text-org09f30bc">
<ul class="org-ul">
<li>CacheVOL
<ul class="org-ul">
<li>How to use local storage?</li>
<li><a href="https://www.youtube.com/watch?v=KJdXMqfRmS4">Hermes webinar</a></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgae4b648" class="outline-3">
<h3 id="orgae4b648">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgae4b648">
</div>
<ul class="org-ul">
<li><a id="org30f6c89"></a>Announcements<br />
<div class="outline-text-4" id="text-org30f6c89">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a>
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for presentation abstracts: <span class="timestamp-wrapper"><span class="timestamp">[2021-08-01 Sun]</span></span></li>
<li>Event: 12-15 October 2021</li>
</ul></li>
<li><a href="https://forum.hdfgroup.org/t/hdf5-1-12-1-6-rc2-source-available-for-testing/8583">HDF5 1.12.1-6-rc2 source available for testing</a>
<ul class="org-ul">
<li>You can help!</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org5b02abd"></a>Forum<br />
<ul class="org-ul">
<li><a id="org931e871"></a><a href="https://forum.hdfgroup.org/t/hug-2021-hdf5-wishlist/8545">Make a wish!</a><br />
<div class="outline-text-5" id="text-org931e871">
<ul class="org-ul">
<li>What small changes would make a big difference in your HDF5 workflow?</li>
<li>Chime in!</li>
</ul>
</div>
</li>
<li><a id="org2559bf8"></a><a href="https://forum.hdfgroup.org/t/issue-unlocking-hdf5-file/8552">Issue unlocking HDF5 file?</a><br /></li>
<li><a id="orgec08c96"></a><a href="https://forum.hdfgroup.org/t/access-to-miscellaneous-dataset-information-get-size-of-compressed-dataset/8582">Access to miscellaneous dataset information/get size of compressed dataset</a><br />
<div class="outline-text-5" id="text-orgec08c96">
<ul class="org-ul">
<li><p>
Aleksandar's <code>h5py</code> example:
</p>
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #0000FF;">import</span> h5py

<span style="color: #0000FF;">def</span> <span style="color: #006699;">comp_ratio</span>(name, obj):
    <span style="color: #0000FF;">if</span> <span style="color: #006FE0;">isinstance</span>(obj, h5py.Dataset) <span style="color: #0000FF;">and</span> obj.chunks <span style="color: #0000FF;">is</span> <span style="color: #0000FF;">not</span> <span style="color: #D0372D;">None</span>:
        dcpl = obj.<span style="color: #006FE0;">id</span>.get_create_plist()
        <span style="color: #0000FF;">if</span> dcpl.get_nfilters():
            <span style="color: #BA36A5;">stor_size</span> = obj.<span style="color: #006FE0;">id</span>.get_storage_size()
            <span style="color: #0000FF;">if</span> stor_size != 0:
                <span style="color: #BA36A5;">ratio</span> = <span style="color: #006FE0;">float</span>(obj.nbytes) / <span style="color: #006FE0;">float</span>(stor_size)
                <span style="color: #006FE0;">print</span>(f<span style="color: #008000;">'Compression ratio for "</span>{obj.name}<span style="color: #008000;">": </span>{ratio}<span style="color: #008000;">'</span>)


<span style="color: #BA36A5;">fname</span> = <span style="color: #008000;">'example.h5'</span>
<span style="color: #0000FF;">with</span> h5py.File(fname, mode=<span style="color: #008000;">'r'</span>) <span style="color: #0000FF;">as</span> h5f:
    h5f.visititems(comp_ratio)

</pre>
</div></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orga58ad24" class="outline-3">
<h3 id="orga58ad24">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orga58ad24">
</div>
<ul class="org-ul">
<li><a id="org1aae89f"></a>File Locking (Dana Robinson)<br />
<ul class="org-ul">
<li><a id="org35d458b"></a>Outline<br />
<div class="outline-text-5" id="text-org35d458b">
<p>
The basic file locking algorithm is simple:
</p>
<ul class="org-ul">
<li>On opening the file, we place the lock as described below. This is true for
<i>all</i> file opens, not just SWMR (Single Write Multiple Readers).</li>
<li>For SWMR writers, this lock is removed after we flush the file's superblock.</li>
<li>All other processes will hold the lock until the file is closed or
<code>H5Fstart_swmr_write()</code> is called.</li>
</ul>
</div>
</li>

<li><a id="orgd5c78c2"></a>Architecture<br />
<div class="outline-text-5" id="text-orgd5c78c2">
<p>
File locking is handled in the native HDF5 virtual object layer (VOL) connector,
so other VOL connectors (REST, etc.) don't do any locking.
</p>

<p>
File locking is handled at the library level, not the virtual file level
(VFL). Virtual file drivers (VFDs) do have to provide an implementation of the
lock and unlock VFD operations for file locking to work, though. If a VFD
doesn't provide a lock operation, file locking will be ignored when using that
VFD. Most of the VFDs provided with the library are based on the POSIX SEC2 VFD
(the default on all platforms, including Windows) and provide the locking I've
described.
</p>

<p>
The stdio VFD only uses <code>flock(2)</code> when it's available, it ignores file locking
when it's not (e.g., on Windows). This is because the stdio VFD is a demo VFD
that uses very little of the library's helper functions and macros and that's
where the flock/fcntl/fail code lies.
</p>

<p>
The MPI-IO VFD, as you might expect, ignores file locking.
</p>
</div>
</li>

<li><a id="org8e6d7aa"></a>SWMR<br />
<div class="outline-text-5" id="text-org8e6d7aa">
<p>
The <code>H5Fstart_swmr_write()</code> API call will unlock the file after it flushes
everything in memory.
</p>

<p>
Related to the OS-level locking algorithm, if the file was opened by a SWMR
writer (either by using the <code>H5F_ACC_SWMR_WRITE</code> flag at create/open or via
<code>H5Fstart_swmr_write()</code>) it will have its superblock marked as such. This mark
will prevent readers from opening the file unless they open it with the
<code>H5F_ACC_SWMR_READ</code> flag.
</p>

<p>
HDF5 1.8.x and earlier do not understand this version of the superblock and will
return an error code when trying to open the file. This mark is cleared when the
file is closed. If the writer crashes, you can remove the mark using the
<code>h5clear</code> tool provided with the library.
</p>
</div>
</li>

<li><a id="orge17cbed"></a>UNIX/Linux, Non-Windows<br />
<div class="outline-text-5" id="text-orge17cbed">
<p>
Compile time option:
</p>

<pre class="example" id="org3f64343">
--enable-file-locking=(yes|no|best-effort)
                        Sets the default for whether or not to use file
                        locking when opening files. Can be overridden with
                        the HDF5_USE_FILE_LOCKING environment variable and
                        the H5Pset_file_locking() API call. best-effort
                        attempts to use file locking but does not fail when
                        file locks have been disabled on the file system
                        (useful with Lustre). [default=best-effort]
</pre>

<p>
You can disable all file locking at runtime by setting an environment variable
named <code>HDF5_USE_FILE_LOCKING</code> to the string <code>"FALSE"</code>.
</p>

<p>
We preferentially use <code>flock(2)</code> in POSIX-like environments where it's
available. If that is not available, we fall back on <code>fcntl(2)</code>. If that is not
found and not best effort, the lock operation uses an internal function that
simply <b>fails</b>.
</p>

<p>
With <code>flock(2)</code>, we use <code>LOCK_EX</code> with read/write permissions and <code>LOCK_SH</code> with
read-only. Both are combined with <code>LOCK_NB</code> to create non-blocking locks.
</p>

<p>
With <code>fcntl(2)</code>, we lock the entire file. We use <code>F_WRLCK</code> with read/write
permissions and <code>F_RDLCK</code> with read-only.
</p>
</div>
</li>

<li><a id="orgcc99cda"></a>Windows<br />
<div class="outline-text-5" id="text-orgcc99cda">
<p>
There is no locking on Windows systems since the Windows POSIX layer doesn't
support that. File locking on Windows is just a no-op (as opposed to failing, as
we do when neither <code>flock(2)</code> nor <code>fcntl(2)</code> are found). We'd need a a virtual
file driver based on Win32 API calls to handle file locking on Windows.
</p>

<p>
Windows uses the POSIX VFD as the default driver. We do not (yet) have a VFD
that uses Win32 API calls like <code>CreateFile()</code>. The POSIX layer in Windows is
incomplete, however, and does not include <code>flock(2)</code> or <code>fcntl(2)</code> so we simply
skip file locking there for the time being.
</p>

<p>
See below for an update!
</p>
</div>
</li>

<li><a id="orgf1d0be3"></a>Summary<br />
<div class="outline-text-5" id="text-orgf1d0be3">
<p>
File locking is only implemented to help prevent users from accessing files when
SWMR write ordering is not turned on (or when we're doing the superblock
marking). It's not inherent to the SWMR algorithm, which is lock-free and
instead based on write ordering.
</p>
</div>
</li>

<li><a id="orge60ec23"></a>Hot off the press<br />
<div class="outline-text-5" id="text-orge60ec23">
<p>
In the 1.12.1-6-rc2 release notes, we find this entry:
</p>

<pre class="example" id="org0e67741">

 File locking updates:

File locks now work on Windows
Adds BEST_EFFORT value to HDF5_USE_FILE_LOCKING environment variable
Adds H5Pset/get_file_locking() API calls
Adds --enable-file-locking=(yes|no|best-effort) option to Autotools
Adds HDF5_USE_FILE_LOCKING and HDF5_IGNORE_DISABLED_FILE_LOCKS to CMake

</pre>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org0faa436" class="outline-3">
<h3 id="org0faa436">Coming soon</h3>
<div class="outline-text-3" id="text-org0faa436">
</div>
<ul class="org-ul">
<li><a id="org3f2fb7f"></a>What happens to open HDF5 handles/IDs when your program ends?<br />
<div class="outline-text-4" id="text-org3f2fb7f">
<ul class="org-ul">
<li>Suggested by Quincey Koziol (LBNL)</li>
<li>We'll take it in pieces
<ul class="org-ul">
<li>Current behavior</li>
<li>How async I/O changes  that picture</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org5d4e803"></a>Other topics of interest?<br /></li>
</ul>
</div>
</div>
<div id="outline-container-orge7e76f7" class="outline-2">
<h2 id="orge7e76f7">Clinic 2021-06-08</h2>
<div class="outline-text-2" id="text-orge7e76f7">
</div>
<div id="outline-container-orge4f73c2" class="outline-3">
<h3 id="orge4f73c2">Your Questions</h3>
<div class="outline-text-3" id="text-orge4f73c2">
<p>
???
</p>
</div>
</div>
<div id="outline-container-org5431f40" class="outline-3">
<h3 id="org5431f40">Last week's highlights</h3>
<div class="outline-text-3" id="text-org5431f40">
</div>
<ul class="org-ul">
<li><a id="org71d76aa"></a>Announcements<br />
<div class="outline-text-4" id="text-org71d76aa">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a>
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for presentation abstracts: <span class="timestamp-wrapper"><span class="timestamp">[2021-08-01 Sun]</span></span></li>
<li>Event: 12-15 October 2021</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orgd6068f6"></a>Forum<br />
<ul class="org-ul">
<li><a id="org103ba23"></a><a href="https://forum.hdfgroup.org/t/hug-2021-hdf5-wishlist/8545">Make a wish!</a><br />
<div class="outline-text-5" id="text-org103ba23">
<ul class="org-ul">
<li>What small changes would make a big difference in your HDF5 workflow?</li>
<li>Great comments already
<ul class="org-ul">
<li>Revised filter interface</li>
<li>Updates to <code>HDF5_PLUGIN_PATH</code></li>
<li>Amalgamated source</li>
<li>Modern language bindings for Fortran</li>
</ul></li>
<li>Chime in!</li>
</ul>
</div>
</li>
<li><a id="org5b2e05a"></a><a href="https://forum.hdfgroup.org/t/issue-unlocking-hdf5-file/8552">Issue unlocking HDF5 file?</a><br />
<div class="outline-text-5" id="text-org5b2e05a">
<ul class="org-ul">
<li>Case of poor documentation &amp; flip-flopping on our part?</li>
</ul>
</div>
</li>
<li><a id="orgf3ec097"></a><a href="https://forum.hdfgroup.org/t/h5i-dec-ref-hangs/8104"><code>H5I_dec_ref</code> hangs</a><br /></li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org59e290b" class="outline-3">
<h3 id="org59e290b">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org59e290b">
</div>
<ul class="org-ul">
<li><a id="orge841430"></a>Jam-packed HDF5 Files - The HDF5 User Block<br />
<div class="outline-text-4" id="text-orge841430">
<ul class="org-ul">
<li>"Keeping things together." - mantra
<ul class="org-ul">
<li>Metadata and data</li>
<li>Stuff - a zip file of ancillary (non-HDF5) data, documentation, etc.</li>
<li>"HDF5 can be on the inside or the outside"</li>
</ul></li>
<li id="User block">Reserved space at the beginning of an HDF5 file
<ul class="org-ul">
<li>Fixed size 2<sup>N</sup>  bytes, min. size 512 KiB</li>
<li>Ignored by the HDF5 library</li>
</ul></li>
<li><p>
Tooling <a href="https://portal.hdfgroup.org/display/HDF5/h5jam+-+h5unjam"><code>h5jam</code>, <code>h5unjam</code></a>
</p>

<pre class="example" id="orgc092ff3">

  usage: h5jam -i &lt;in_file.h5&gt; -u &lt;in_user_file&gt; [-o &lt;out_file.h5&gt;] [--clobber]

Adds user block to front of an HDF5 file and creates a new concatenated file.

OPTIONS
  -i in_file.h5    Specifies the input HDF5 file.
  -u in_user_file  Specifies the file to be inserted into the user block.
                   Can be any file format except an HDF5 format.
  -o out_file.h5   Specifies the output HDF5 file.
                   If not specified, the user block will be concatenated in
                   place to the input HDF5 file.
  --clobber        Wipes out any existing user block before concatenating
                   the given user block.
                   The size of the new user block will be the larger of;
                    - the size of existing user block in the input HDF5 file
                    - the size of user block required by new input user file
                   (size = 512 x 2N,  N is positive integer.)

  -h               Prints a usage message and exits.
  -V               Prints the HDF5 library version and exits.

Exit Status:
   0   Succeeded.
   &gt;0  An error occurred.

</pre>

<pre class="example" id="org7e3113a">

usage: h5unjam -i &lt;in_file.h5&gt;  [-o &lt;out_file.h5&gt; ] [-u &lt;out_user_file&gt; | --delete]

Splits user file and HDF5 file into two files: user block data and HDF5 data.

OPTIONS
  -i in_file.h5   Specifies the HDF5 as input.  If the input HDF5 file
                  contains no user block, exit with an error message.
  -o out_file.h5  Specifies output HDF5 file without a user block.
                  If not specified, the user block will be removed from the
                  input HDF5 file.
  -u out_user_file
                  Specifies the output file containing the data from the
                  user block.
                  Cannot be used with --delete option.
  --delete        Remove the user block from the input HDF5 file. The content
                  of the user block is discarded.
                  Cannot be used with the -u option.

  -h              Prints a usage message and exits.
  -V              Prints the HDF5 library version and exits.

  If neither --delete nor -u is specified, the user block from the input file
  will be displayed to stdout.

Exit Status:
  0      Succeeded.
  &gt;0    An error occurred.

</pre></li>

<li>Let's try this!</li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-org2b2332e" class="outline-3">
<h3 id="org2b2332e">Coming soon</h3>
<div class="outline-text-3" id="text-org2b2332e">
</div>
<ul class="org-ul">
<li><a id="org202d4cd"></a>What happens to open HDF5 handles/IDs when your program ends?<br />
<div class="outline-text-4" id="text-org202d4cd">
<ul class="org-ul">
<li>Suggested by Quincey Koziol (LBNL)</li>
<li>We'll take it in pieces
<ul class="org-ul">
<li>Current behavior</li>
<li>How async I/O changes  that picture</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org1a3770b"></a>Other topics of interest?<br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgdf2c450" class="outline-2">
<h2 id="orgdf2c450">Clinic 2021-06-01</h2>
<div class="outline-text-2" id="text-orgdf2c450">
</div>
<div id="outline-container-orgf367d6f" class="outline-3">
<h3 id="orgf367d6f">Your Questions</h3>
<div class="outline-text-3" id="text-orgf367d6f">
<ul class="org-ul">
<li>Does <code>h5repack</code> have any impact on reading?
<ul class="org-ul">
<li>What can <code>h5repack</code> do for you?
<ul class="org-ul">
<li>Reclaim unused file space</li>
<li>(Down-)Upgrade file format features</li>
<li>Change dataset layout</li>
<li>(Un-)Compress  datasets</li>
<li>&#x2026;  (incomplete list! - Run <code>h5dump --help</code>!)</li>
</ul></li>
<li>Yes, the read performance of a re-packed HDF5 file could be better or worse
(or about the same).</li>
</ul></li>

<li>Is there any difference in reading a variable/field if it is compressed or
un-compressed? (This question came in at the end of our May 18 session.)
<ul class="org-ul">
<li>Assuming loss-less compression, no, in terms of value</li>
<li>Yes, most likely, because (de-)compression requires CPU-cycles
<ul class="org-ul">
<li>Potential reduction in I/O bandwidth</li>
<li>Pathology: the data size increases as a result of compression</li>
</ul></li>
<li><a href="https://portal.hdfgroup.org/display/HDF5/HDF5+Data+Flow+Pipeline+for+H5Dread">HDF5 Data Flow Pipeline for <code>H5Dread</code> </a></li>
</ul></li>

<li>Do you have recommendations for setting Figure of Merit (FOM) to
measure/capture I/O improvements? Any consideration based on current
supercomputers/hybrid systems, # of files used, kind of I/O (e.g. different
for read than for write), HDF5 versions, HDF5 features, if using SSDs/Burst
buffers, etc. What would be a good sample of FOM to follow?
<ul class="org-ul">
<li>Baseline, metric (file size, throughput, IOPs)</li>
<li>Large number of combinations? Perhaps polar diagrams? See <a href="https://www.youtube.com/watch?v=JEnYLWpBjso">this webinar</a>
around 15:18.</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgc7c2a10" class="outline-3">
<h3 id="orgc7c2a10">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgc7c2a10">
</div>
<ul class="org-ul">
<li><a id="org654cc2b"></a>Announcements<br />
<div class="outline-text-4" id="text-org654cc2b">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a>
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for abstracts: 1 June 2021</li>
<li>Event: 12-15 October 2021</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orgef8e97e"></a>Forum<br />
<ul class="org-ul">
<li><a id="org97df7ef"></a><a href="https://forum.hdfgroup.org/t/hdf5-udf-runs-on-macos/8527">HDF5-UDF runs on macOS!</a><br />
<div class="outline-text-5" id="text-org97df7ef">
<ul class="org-ul">
<li><b>Caveat:</b> <a href="https://www.gnu.org/proprietary/malware-apple.en.html">Apple's Operating Systems Are Malware</a> says <a href="https://www.gnu.org/">FSF</a></li>
</ul>
</div>
</li>
<li><a id="org37a1230"></a><a href="https://forum.hdfgroup.org/t/hug-2021-hdf5-wishlist/8545">Make a wish!</a><br />
<div class="outline-text-5" id="text-org37a1230">
<ul class="org-ul">
<li>What small changes would make a big difference in your HDF5 workflow?</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org60d5b7e" class="outline-3">
<h3 id="org60d5b7e">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org60d5b7e">
</div>
<ul class="org-ul">
<li><a id="org745ee51"></a>Jam-packed HDF5 Files - The HDF5 User Block<br />
<div class="outline-text-4" id="text-org745ee51">
<ul class="org-ul">
<li>"Keeping things together." - mantra
<ul class="org-ul">
<li>Metadata and data</li>
<li>Stuff - a zip file of ancillary (non-HDF5) data, documentation, etc.</li>
<li>"HDF5 can be on the inside or the outside"</li>
</ul></li>
<li id="User block">Reserved space at the beginning of an HDF5 file
<ul class="org-ul">
<li>Fixed size 2<sup>N</sup>  bytes, min. size 512 KiB</li>
<li>Ignored by the HDF5 library</li>
</ul></li>
<li><p>
Tooling <a href="https://portal.hdfgroup.org/display/HDF5/h5jam+-+h5unjam"><code>h5jam</code>, <code>h5unjam</code></a>
</p>

<pre class="example" id="org1e60db1">

  usage: h5jam -i &lt;in_file.h5&gt; -u &lt;in_user_file&gt; [-o &lt;out_file.h5&gt;] [--clobber]

Adds user block to front of an HDF5 file and creates a new concatenated file.

OPTIONS
  -i in_file.h5    Specifies the input HDF5 file.
  -u in_user_file  Specifies the file to be inserted into the user block.
                   Can be any file format except an HDF5 format.
  -o out_file.h5   Specifies the output HDF5 file.
                   If not specified, the user block will be concatenated in
                   place to the input HDF5 file.
  --clobber        Wipes out any existing user block before concatenating
                   the given user block.
                   The size of the new user block will be the larger of;
                    - the size of existing user block in the input HDF5 file
                    - the size of user block required by new input user file
                   (size = 512 x 2N,  N is positive integer.)

  -h               Prints a usage message and exits.
  -V               Prints the HDF5 library version and exits.

Exit Status:
   0   Succeeded.
   &gt;0  An error occurred.

</pre>

<pre class="example" id="org1853367">

usage: h5unjam -i &lt;in_file.h5&gt;  [-o &lt;out_file.h5&gt; ] [-u &lt;out_user_file&gt; | --delete]

Splits user file and HDF5 file into two files: user block data and HDF5 data.

OPTIONS
  -i in_file.h5   Specifies the HDF5 as input.  If the input HDF5 file
                  contains no user block, exit with an error message.
  -o out_file.h5  Specifies output HDF5 file without a user block.
                  If not specified, the user block will be removed from the
                  input HDF5 file.
  -u out_user_file
                  Specifies the output file containing the data from the
                  user block.
                  Cannot be used with --delete option.
  --delete        Remove the user block from the input HDF5 file. The content
                  of the user block is discarded.
                  Cannot be used with the -u option.

  -h              Prints a usage message and exits.
  -V              Prints the HDF5 library version and exits.

  If neither --delete nor -u is specified, the user block from the input file
  will be displayed to stdout.

Exit Status:
  0      Succeeded.
  &gt;0    An error occurred.

</pre></li>

<li>Let's try this!</li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-org2a3f217" class="outline-3">
<h3 id="org2a3f217">Coming soon</h3>
<div class="outline-text-3" id="text-org2a3f217">
</div>
<ul class="org-ul">
<li><a id="orgfe634de"></a>What happens to open HDF5 handles/IDs when your program ends?<br />
<div class="outline-text-4" id="text-orgfe634de">
<ul class="org-ul">
<li>Suggested by Quincey Koziol (LBNL)</li>
<li>We'll take it in pieces
<ul class="org-ul">
<li>Current behavior</li>
<li>How async I/O changes  that picture</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orge9fd15f"></a>Other topics of interest?<br /></li>
</ul>
</div>
</div>
<div id="outline-container-org0d0f74f" class="outline-2">
<h2 id="org0d0f74f">Clinic 2021-05-25</h2>
<div class="outline-text-2" id="text-org0d0f74f">
</div>
<div id="outline-container-orgb2c25fc" class="outline-3">
<h3 id="orgb2c25fc">Your Questions</h3>
<div class="outline-text-3" id="text-orgb2c25fc">
<ul class="org-ul">
<li>Does <code>h5repack</code> have any impact on reading?
<ul class="org-ul">
<li>Yes, the read performance of a re-packed HDF5 file could be better or worse
(or about the same).</li>
</ul></li>
<li>Is there any difference in reading a variable/field if it is compressed or
un-compressed? (This question came in at the end of our May 18 session.)
<ul class="org-ul">
<li>Yes</li>
<li><a href="https://portal.hdfgroup.org/display/HDF5/HDF5+Data+Flow+Pipeline+for+H5Dread">HDF5 Data Flow Pipeline for <code>H5Dread</code> </a></li>
</ul></li>
<li>Do you have recommendations for setting Figure of Merit (FOM) to
measure/capture I/O improvements? Any consideration based on current
supercomputers/hybrid systems, # of files used, kind of I/O (e.g. different
for read than for write), HDF5 versions, HDF5 features, if using SSDs/Burst
buffers, etc. What would be a good sample of FOM to follow?
<ul class="org-ul">
<li>Baseline, metric</li>
<li>Large number of combinations? Perhaps polar diagrams? See <a href="https://www.youtube.com/watch?v=JEnYLWpBjso">this webinar</a>
around 15:18.</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orga0b1b48" class="outline-3">
<h3 id="orga0b1b48">Last week's highlights</h3>
<div class="outline-text-3" id="text-orga0b1b48">
</div>
<ul class="org-ul">
<li><a id="orgee1388f"></a>Announcements<br />
<div class="outline-text-4" id="text-orgee1388f">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/webinar-announcement-the-hermes-buffering-system-take-two/8493">The Hermes Buffering System - Take Two</a> was <b>POSTPONED</b>
<ul class="org-ul">
<li>Stay tuned for a re-announcement</li>
</ul></li>
<li><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a>
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for abstracts: 1 June 2021</li>
<li>Event: 12-15 October 2021</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org5db278a"></a>Forum<br />
<ul class="org-ul">
<li><a id="org2044e2c"></a><a href="https://forum.hdfgroup.org/t/zstd-filter-plugin-dictionary-training/8401">Zstd filter plugin &amp; dictionary training</a><br />
<div class="outline-text-5" id="text-org2044e2c">
<ul class="org-ul">
<li><a href="http://develop.hdf5.info/group___h5_z.html">H5Z life cycle</a></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org5588e32" class="outline-3">
<h3 id="org5588e32">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org5588e32">
</div>
<ul class="org-ul">
<li><a id="org299e961"></a><code>h5repack</code> - Getting stuff done w/o writing a lot of code<br />
<div class="outline-text-4" id="text-org299e961">
<p>
Sanity check:
</p>
<div class="org-src-container">
<pre class="src src-sh">h5repack --help
</pre>
</div>
<p>
The output should look like this:
</p>
<pre class="example" id="org5183551">
usage: h5repack [OPTIONS] file1 file2
  file1                    Input HDF5 File
  file2                    Output HDF5 File
  OPTIONS
   -h, --help              Print a usage message and exit
   -v, --verbose           Verbose mode, print object information
   -V, --version           Print version number and exit
   -n, --native            Use a native HDF5 type when repacking
   --enable-error-stack    Prints messages from the HDF5 error stack as they
                           occur
   -L, --latest            Use latest version of file format
                           This option will take precedence over the options
                           --low and --high
   --low=BOUND             The low bound for library release versions to use
                           when creating objects in the file
                           (default is H5F_LIBVER_EARLIEST)
   --high=BOUND            The high bound for library release versions to use
                           when creating objects in the file
                           (default is H5F_LIBVER_LATEST)
   --merge                 Follow external soft link recursively and merge data
   --prune                 Do not follow external soft links and remove link
   --merge --prune         Follow external link, merge data and remove dangling link
   -c L1, --compact=L1     Maximum number of links in header messages
   -d L2, --indexed=L2     Minimum number of links in the indexed format
   -s S[:F], --ssize=S[:F] Shared object header message minimum size
   -m M, --minimum=M       Do not apply the filter to datasets smaller than M
   -e E, --file=E          Name of file E with the -f and -l options
   -u U, --ublock=U        Name of file U with user block data to be added
   -b B, --block=B         Size of user block to be added
   -M A, --metadata_block_size=A  Metadata block size for H5Pset_meta_block_size
   -t T, --threshold=T     Threshold value for H5Pset_alignment
   -a A, --alignment=A     Alignment value for H5Pset_alignment
   -q Q, --sort_by=Q       Sort groups and attributes by index Q
   -z Z, --sort_order=Z    Sort groups and attributes by order Z
   -f FILT, --filter=FILT  Filter type
   -l LAYT, --layout=LAYT  Layout type
   -S FS_STRATEGY, --fs_strategy=FS_STRATEGY  File space management strategy for
                           H5Pset_file_space_strategy
   -P FS_PERSIST, --fs_persist=FS_PERSIST  Persisting or not persisting free-
                           space for H5Pset_file_space_strategy
   -T FS_THRESHOLD, --fs_threshold=FS_THRESHOLD   Free-space section threshold
                           for H5Pset_file_space_strategy
   -G FS_PAGESIZE, --fs_pagesize=FS_PAGESIZE   File space page size for
                           H5Pset_file_space_page_size
...
</pre>
<p>
There's a lot of stuff to chew over, but let's focus on the examples:
</p>
<pre class="example" id="org29c8b3f">
...

Examples of use:

1) h5repack -v -f GZIP=1 file1 file2

   GZIP compression with level 1 to all objects

2) h5repack -v -f dset1:SZIP=8,NN file1 file2

   SZIP compression with 8 pixels per block and NN coding method to object dset1

3) h5repack -v -l dset1,dset2:CHUNK=20x10 -f dset3,dset4,dset5:NONE file1 file2

   Chunked layout, with a layout size of 20x10, to objects dset1 and dset2
   and remove filters to objects dset3, dset4, dset5

4) h5repack -L -c 10 -s 20:dtype file1 file2

   Using latest file format with maximum compact group size of 10 and
   minimum shared datatype size of 20

5) h5repack -f SHUF -f GZIP=1 file1 file2

   Add both filters SHUF and GZIP in this order to all datasets

6) h5repack -f UD=307,0,1,9 file1 file2

   Add bzip2 filter to all datasets

7) h5repack --low=0 --high=1 file1 file2

   Set low=H5F_LIBVER_EARLIEST and high=H5F_LIBVER_V18 via
   H5Pset_libver_bounds() when creating the repacked file, file2
</pre>

<p>
Let's create some test data and play!
</p>

<div class="org-src-container">
<pre class="src src-C">
<span style="color: #808080;">#include</span> <span style="color: #008000;">"hdf5.h"</span>

<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;assert.h&gt;</span>
<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;stdlib.h&gt;</span>

<span style="color: #808080;">#define</span> <span style="color: #BA36A5;">SIZE</span> 1024*1024

<span style="color: #6434A3;">int</span> <span style="color: #006699;">main</span>()
{
  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">ret_val</span> = EXIT_SUCCESS;

  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file</span>, <span style="color: #BA36A5;">fspace</span>, <span style="color: #BA36A5;">dset</span>;

  <span style="color: #6434A3;">double</span>* <span style="color: #BA36A5;">data</span> = (<span style="color: #6434A3;">double</span>*) malloc(SIZE*<span style="color: #0000FF;">sizeof</span>(<span style="color: #6434A3;">double</span>));

  <span style="color: #0000FF;">if</span> ((file = H5Fcreate(<span style="color: #008000;">"foo.h5"</span>, H5F_ACC_TRUNC, H5P_DEFAULT, H5P_DEFAULT)) ==
      H5I_INVALID_HID) {
    ret_val = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }

  <span style="color: #0000FF;">if</span> ((fspace = H5Screate_simple(1, (<span style="color: #6434A3;">hsize_t</span>[]){ SIZE }, <span style="color: #D0372D;">NULL</span>)) ==
      H5I_INVALID_HID) {
    ret_val = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_fspace</span>;
  }

  <span style="color: #0000FF;">if</span> ((dset = H5Dcreate(file, <span style="color: #008000;">"sequential"</span>, H5T_IEEE_F64LE, fspace,
                        H5P_DEFAULT, H5P_DEFAULT, H5P_DEFAULT)) ==
      H5I_INVALID_HID) {
    ret_val = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dset</span>;
  }

  <span style="color: #0000FF;">for</span> (<span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">i</span> = 0; i &lt; SIZE; ++i)
    data[i] = (<span style="color: #6434A3;">double</span>)i;

  <span style="color: #0000FF;">if</span> (H5Dwrite(dset, H5T_NATIVE_DOUBLE, H5S_ALL, H5S_ALL, H5P_DEFAULT, data)
      &lt; 0)
    ret_val = EXIT_FAILURE;

  H5Dclose(dset);

  <span style="color: #0000FF;">if</span> ((dset = H5Dcreate(file, <span style="color: #008000;">"random"</span>, H5T_IEEE_F64LE, fspace, H5P_DEFAULT,
                        H5P_DEFAULT, H5P_DEFAULT)) == H5I_INVALID_HID) {
    ret_val = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dset</span>;
  }
  <span style="color: #0000FF;">for</span> (<span style="color: #6434A3;">size_t</span> <span style="color: #BA36A5;">i</span> = 0; i &lt; SIZE; ++i)
    data[i] = (<span style="color: #6434A3;">double</span>)rand()/(<span style="color: #6434A3;">double</span>)RAND_MAX;

  <span style="color: #0000FF;">if</span> (H5Dwrite(dset, H5T_NATIVE_DOUBLE, H5S_ALL, H5S_ALL, H5P_DEFAULT, data)
      &lt; 0)
    ret_val = EXIT_FAILURE;

  H5Dclose(dset);

 <span style="color: #D0372D;">fail_dset</span>:
  H5Sclose(fspace);
 <span style="color: #D0372D;">fail_fspace</span>:
  H5Fclose(file);
 <span style="color: #D0372D;">fail_file</span>:
  free(data);

  assert(ret_val == EXIT_SUCCESS);

  <span style="color: #0000FF;">return</span> ret_val;
}

</pre>
</div>
</div>
</li>
</ul>
</div>

<div id="outline-container-org8e0c35c" class="outline-3">
<h3 id="org8e0c35c">Coming soon</h3>
<div class="outline-text-3" id="text-org8e0c35c">
</div>
<ul class="org-ul">
<li><a id="org27354c9"></a>What happens to open HDF5 handles/IDs when your program ends?<br />
<div class="outline-text-4" id="text-org27354c9">
<ul class="org-ul">
<li>Suggested by Quincey Koziol (LBNL)</li>
<li>We'll take it in pieces
<ul class="org-ul">
<li>Current behavior</li>
<li>How async I/O changes  that picture</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org22296d5"></a>Other topics of interest?<br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgc55d8bf" class="outline-2">
<h2 id="orgc55d8bf">Clinic 2021-05-18</h2>
<div class="outline-text-2" id="text-orgc55d8bf">
</div>
<div id="outline-container-org9e0f0b0" class="outline-3">
<h3 id="org9e0f0b0">Your Questions</h3>
<div class="outline-text-3" id="text-org9e0f0b0">
<p>
???
</p>
</div>
</div>

<div id="outline-container-orge7bdc82" class="outline-3">
<h3 id="orge7bdc82">Last week's highlights</h3>
<div class="outline-text-3" id="text-orge7bdc82">
</div>
<ul class="org-ul">
<li><a id="org8b4cec6"></a>Announcements<br />
<div class="outline-text-4" id="text-org8b4cec6">
<ul class="org-ul">
<li>Recording of <a href="https://www.youtube.com/watch?v=RuBKDW4TNO4">H5Coro: The HDF5 Cloud-Optimized Read-Only Library</a> is available now</li>
<li><a href="https://forum.hdfgroup.org/t/webinar-announcement-the-hermes-buffering-system-take-two/8493">The Hermes Buffering System - Take Two</a>
<ul class="org-ul">
<li>May 28, 2021 11:00 a.m. CDT</li>
<li><a href="https://zoom.us/meeting/register/tJEtcuivqT4iH9CLyprQ23WhuZWjwIjslfoy">Registration</a></li>
<li><a href="https://www.youtube.com/watch?v=KJdXMqfRmS4">Previous Webinar Recording</a></li>
<li><a href="https://github.com/HDFGroup/hermes">Hermes on GitHub</a></li>
</ul></li>
<li><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a>
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for abstracts: 1 June 2021</li>
<li>Event: 12-15 October 2021</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org3c30b04"></a>Forum<br />
<ul class="org-ul">
<li><a id="org59dc8fc"></a><a href="https://forum.hdfgroup.org/t/hdf5-udf-2-0-released-udf-signing-trust-profiles-python-bindings-and-more/8486">HDF5-UDF 2.0 released: UDF signing, trust profiles, Python bindings, and more! </a><br />
<div class="outline-text-5" id="text-org59dc8fc">
<ul class="org-ul">
<li>UDF signing</li>
<li>Library API
<ul class="org-ul">
<li>Python bindings (i.e., manageable from Jupyter notebook)</li>
</ul></li>
<li>Source code storage</li>
<li><a href="https://github.com/lucasvr/hdf5-udf">GitHub</a></li>
</ul>
</div>
</li>
<li><a id="orgd83cb74"></a><a href="https://forum.hdfgroup.org/t/zlib-ng-works-with-hdf5/8477">Zlib-ng works with HDF5</a><br />
<div class="outline-text-5" id="text-orgd83cb74">
<ul class="org-ul">
<li>More anecdotal evidence of performance improvements</li>
<li>Begs a maintenance question: Should we/ can we support multiple
implementations of the same filter?</li>
</ul>
</div>
</li>
<li><a id="org99ae135"></a><a href="https://forum.hdfgroup.org/t/reference-manual-in-doxygen/8230">Reference Manual in Doxygen</a><br />
<div class="outline-text-5" id="text-org99ae135">
<ul class="org-ul">
<li><a href="http://doxygen.hdf5.s3-website.us-east-2.amazonaws.com/_r_m.html">Current version</a></li>
<li>Life cycle entries - are they helpful?</li>
<li>To be included in HDF5 1.12.1</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orgca97b51" class="outline-3">
<h3 id="orgca97b51">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orgca97b51">
</div>
<ul class="org-ul">
<li><a id="orgf6fba6d"></a>When should you consider using chunked layout for a dataset?<br />
<div class="outline-text-4" id="text-orgf6fba6d">
<p>
"Consider" means that you should also consider <i>alternatives</i>. None of the items
listed below mandates chunked layout.
</p>
</div>
<ul class="org-ul">
<li><a id="org4b9c949"></a>Considerations<br />
<div class="outline-text-5" id="text-org4b9c949">
<ul class="org-ul">
<li>I would like to use a compression or other filter w/ my data</li>
<li>I cannot know/estimate the data size in advance</li>
<li>I need the ability to append data indefinitely</li>
<li>My read/write pattern is such that contiguous layout would reduce performance</li>
</ul>
</div>
</li>
<li><a id="org121179b"></a>Caveats<br />
<div class="outline-text-5" id="text-org121179b">
<ul class="org-ul">
<li>What's a good chunk size?</li>
<li>Is my chunk cache the right size?</li>
<li>Compound types?</li>
<li>Variable-length datatypes?</li>
<li>Are there edge chunks?</li>
</ul>
</div>
</li>
<li><a id="orgd906e9c"></a>Experimentation<br />
<div class="outline-text-5" id="text-orgd906e9c">
<ul class="org-ul">
<li><b>Don't waste your time writing a lot of code!</b>
<ul class="org-ul">
<li>Use a tool such as <code>h5repack</code></li>
<li>Use intuitive and boilerplate-free language bindings for Python, Julia, or
C++ that exist thanks to the HDF community</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orgab7e85a" class="outline-3">
<h3 id="orgab7e85a">Coming soon</h3>
<div class="outline-text-3" id="text-orgab7e85a">
</div>
<ul class="org-ul">
<li><a id="org91dcce1"></a>What happens to open HDF5 handles/IDs when your program ends?<br />
<div class="outline-text-4" id="text-org91dcce1">
<ul class="org-ul">
<li>Suggested by Quincey Koziol (LBNL)</li>
<li>We'll take it in pieces
<ul class="org-ul">
<li>Current behavior</li>
<li>How async I/O changes  that picture</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org4e8bad2"></a>Other topics of interest?<br /></li>
</ul>
</div>
</div>
<div id="outline-container-org4f1a9c1" class="outline-2">
<h2 id="org4f1a9c1">Clinic 2021-05-11</h2>
<div class="outline-text-2" id="text-org4f1a9c1">
</div>
<div id="outline-container-org144db28" class="outline-3">
<h3 id="org144db28">Your Questions</h3>
<div class="outline-text-3" id="text-org144db28">
<ul class="org-ul">
<li>Where is the page that I'm showing?</li>
<li>How did we prepare the webinar radial diagrams?
<ul class="org-ul">
<li>Using Python's <code>plotly</code> module</li>
<li><a href="https://medium.com/@abhishekdas.nitc/nightingale-plots-in-python-using-plotly-da42bc18d15d">Here's a nice article</a> to get you started.</li>
<li>We'll include a few scripts w/ <a href="https://github.com/HDFGroup/hdf5-iotest">HDF5 I/O test</a> in the future</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org13c6111" class="outline-3">
<h3 id="org13c6111">Last week's highlights</h3>
<div class="outline-text-3" id="text-org13c6111">
</div>
<ul class="org-ul">
<li><a id="org8e82ee3"></a>Announcements<br />
<div class="outline-text-4" id="text-org8e82ee3">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/webinar-announcement-h5coro-the-hdf5-cloud-optimized-read-only-library/8429">H5Coro: The HDF5 Cloud-Optimized Read-Only Library</a>
<ul class="org-ul">
<li>May 14, 11:00 AM Central</li>
<li>Looking at ways to efficiently access HDF5 files residing in AWS S3</li>
</ul></li>
<li><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a>
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for abstracts: 1 June 2021</li>
<li>Event: 12-15 October 2021</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="org82f470a"></a>Forum<br />
<ul class="org-ul">
<li><a id="org30a233f"></a><a href="https://forum.hdfgroup.org/t/zlib-ng-works-with-hdf5/8477">Zlib-ng works with HDF5</a><br />
<div class="outline-text-5" id="text-org30a233f">
<ul class="org-ul">
<li>New <code>zlib</code> implementation appears to work w/ HDF5</li>
<li>Much better performance according to the post</li>
<li>Maybe support as a dynamic plugin?</li>
</ul>
</div>
</li>
<li><a id="org05e3c1d"></a><a href="https://forum.hdfgroup.org/t/reference-manual-in-doxygen/8230">Reference Manual in Doxygen</a><br />
<div class="outline-text-5" id="text-org05e3c1d">
<ul class="org-ul">
<li><a href="http://doxygen.hdf5.s3-website.us-east-2.amazonaws.com/index.html">Current version</a></li>
<li>Interesting discussion around docs-like-code and maintenance</li>
<li>There are <a href="https://documentation.divio.com/">different kinds of documentation</a>
<ul class="org-ul">
<li>Tasks, concepts, reference (DITAA)</li>
<li>Tutorials, how-to guides, explanation, reference (Divio)</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org06f4aab"></a><a href="https://forum.hdfgroup.org/t/h5i-dec-ref-hangs/8104"><code>H5Idec_ref</code> hangs</a><br />
<div class="outline-text-5" id="text-org06f4aab">
<ul class="org-ul">
<li>Showing an example of MPI ranks doing independent writes to different datasets
w/ MPI-IO VFD</li>
</ul>
</div>
</li>
<li><a id="org15e9685"></a><a href="https://forum.hdfgroup.org/t/hdf5-infinite-loop-closing-library-v1-10-6/8468">HDF5: infinite loop closing library (v1.10.6)</a><br />
<div class="outline-text-5" id="text-org15e9685">
<ul class="org-ul">
<li>We covered file close degrees in clinic no. 10 on <span class="timestamp-wrapper"><span class="timestamp">[2021-04-20 Tue]</span></span></li>
</ul>
</div>
</li>
<li><a id="orgf479111"></a><a href="https://forum.hdfgroup.org/t/hdfql-2-3-0-release-with-excel-import-export-support/8132">HDFql 2.3.0 Release (with EXCEL import/export support!)</a><br />
<div class="outline-text-5" id="text-orgf479111">
<ul class="org-ul">
<li>Bugfix for Java <code>ArrayIndexOutOfBoundsException</code> when registering a zero
element byte array</li>
<li>Fixed in HDFql 2.4.0</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org31f660f" class="outline-3">
<h3 id="org31f660f">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org31f660f">
</div>
<ul class="org-ul">
<li><a id="orgae2db6f"></a>Fixed- vs. variable-length string performance cage match<br />
<div class="outline-text-4" id="text-orgae2db6f">
<ul class="org-ul">
<li>Trigger: <a href="https://forum.hdfgroup.org/t/writing-and-reading-variable-length-std-string-in-compound-data-type/8455">Writing and reading variable length std::string in compound data type</a></li>
<li>Contributed by Steven (Canada Dry) Varga
<ul class="org-ul">
<li><a href="http://string-performance.h5cpp.org/">Presentation</a></li>
<li><a href="https://github.com/steven-varga/HDFGroup-mailinglist/tree/master/non-pod-struct-2021-apr-29">GitHub link</a></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
<div id="outline-container-orgb3d0985" class="outline-3">
<h3 id="orgb3d0985">Coming soon</h3>
<div class="outline-text-3" id="text-orgb3d0985">
</div>
<ul class="org-ul">
<li><a id="orgc511820"></a>What happens to open HDF5 handles/IDs when your program ends?<br />
<div class="outline-text-4" id="text-orgc511820">
<ul class="org-ul">
<li>Suggested by Quincey Koziol (LBNL)</li>
<li>We'll take it in pieces
<ul class="org-ul">
<li>Current behavior</li>
<li>How async I/O changes  that picture</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orgf72b433"></a>Other topics of interest?<br />
<div class="outline-text-4" id="text-orgf72b433">
<p>
Let us know!
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org82e6dcf" class="outline-2">
<h2 id="org82e6dcf">Clinic 2021-05-04</h2>
<div class="outline-text-2" id="text-org82e6dcf">
</div>
<div id="outline-container-orgadb943f" class="outline-3">
<h3 id="orgadb943f">Your Questions</h3>
<div class="outline-text-3" id="text-orgadb943f">
<p>
???
</p>
</div>
</div>

<div id="outline-container-org2acea86" class="outline-3">
<h3 id="org2acea86">Last week's highlights</h3>
<div class="outline-text-3" id="text-org2acea86">
</div>
<ul class="org-ul">
<li><a id="orga5b023e"></a>Announcements<br />
<div class="outline-text-4" id="text-orga5b023e">
<ul class="org-ul">
<li><a href="https://www.youtube.com/watch?v=JEnYLWpBjso">Recording of last week's webinar</a></li>
<li><a href="https://forum.hdfgroup.org/t/webinar-announcement-h5coro-the-hdf5-cloud-optimized-read-only-library/8429">H5Coro: The HDF5 Cloud-Optimized Read-Only Library</a>
<ul class="org-ul">
<li>May 14, 11:00 AM Central</li>
<li>Looking at ways to efficiently access HDF5 files residing in AWS S3</li>
</ul></li>
<li><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a>
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for abstracts: 1 June 2021</li>
<li>Event: 12-15 October 2021</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="org2ea3e94"></a>Forum<br />
<ul class="org-ul">
<li><a id="org8bdbf6e"></a><a href="https://forum.hdfgroup.org/t/how-to-use-h5ocopy-to-copy-a-group-with-hard-links/8443">How to use H5ocopy to copy a group with hard links</a><br />
<div class="outline-text-5" id="text-org8bdbf6e">
<ul class="org-ul">
<li><a href="https://portal.hdfgroup.org/display/HDF5/H5O_COPY"><code>H5Ocopy</code></a> vs. <a href="https://portal.hdfgroup.org/display/HDF5/H5L_COPY"><code>H5Lcopy</code></a></li>
<li><a href="https://portal.hdfgroup.org/display/HDF5/H5P_SET_COPY_OBJECT"><code>H5Pset_copy_object</code></a></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org56c2b2f" class="outline-3">
<h3 id="org56c2b2f">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-org56c2b2f">
</div>
<ul class="org-ul">
<li><a id="org605f7f5"></a>What is <code>H5S_ALL</code> all about?<br />
<div class="outline-text-4" id="text-org605f7f5">
<div class="org-src-container">
<pre class="src src-C">
{
  <span style="color: #6434A3;">__label__</span> <span style="color: #BA36A5;">fail_update</span>, <span style="color: #BA36A5;">fail_fspace</span>, <span style="color: #BA36A5;">fail_dset</span>, <span style="color: #BA36A5;">fail_file</span>;
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file</span>, <span style="color: #BA36A5;">dset</span>, <span style="color: #BA36A5;">fspace</span>;

  <span style="color: #6434A3;">unsigned</span> <span style="color: #BA36A5;">mode</span>           = H5F_ACC_RDWR;
  <span style="color: #6434A3;">char</span>     <span style="color: #BA36A5;">file_name</span>[]    = <span style="color: #008000;">"d1.h5"</span>;
  <span style="color: #6434A3;">char</span>     <span style="color: #BA36A5;">dset_name</span>[]    = <span style="color: #008000;">"&#963;&#973;&#957;&#959;&#955;&#959;/&#948;&#949;&#948;&#959;&#956;&#941;&#957;&#969;&#957;"</span>;
  <span style="color: #6434A3;">int</span>      <span style="color: #BA36A5;">new_elts</span>[6][2] = {{-1, 1}, {-2, 2}, {-3, 3}, {-4, 4},
                             {-5, 5}, {-6, 6}};

  <span style="color: #0000FF;">if</span> ((file = H5Fopen(file_name, mode, H5P_DEFAULT))
      == H5I_INVALID_HID) {
    ret_val = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_file</span>;
  }
  <span style="color: #0000FF;">if</span> ((dset = H5Dopen2(file, dset_name, H5P_DEFAULT))
      == H5I_INVALID_HID) {
    ret_val = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_dset</span>;
  }
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">get the dataset's dataspace</span>
  <span style="color: #0000FF;">if</span> ((fspace = H5Dget_space(dset)) == H5I_INVALID_HID) {
    ret_val = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_fspace</span>;
  }
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">select the first 5 elements in odd positions</span>
  <span style="color: #0000FF;">if</span> (H5Sselect_hyperslab(fspace, H5S_SELECT_SET,
                          (<span style="color: #6434A3;">hsize_t</span>[]){1},
                          (<span style="color: #6434A3;">hsize_t</span>[]){2},
                          (<span style="color: #6434A3;">hsize_t</span>[]){5},
                          <span style="color: #D0372D;">NULL</span>) &lt; 0) {
    ret_val = EXIT_FAILURE;
    <span style="color: #0000FF;">goto</span> <span style="color: #D0372D;">fail_update</span>;
  }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">(implicitly) select and write the first 5 elements of the second</span>
  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">column of NEW_ELTS</span>
  <span style="color: #0000FF;">if</span> (H5Dwrite(dset, H5T_NATIVE_INT, H5S_ALL, fspace, H5P_DEFAULT,
               new_elts) &lt; 0)
    ret_val = EXIT_FAILURE;

 <span style="color: #D0372D;">fail_update</span>:
  H5Sclose(fspace);
 <span style="color: #D0372D;">fail_fspace</span>:
  H5Dclose(dset);
 <span style="color: #D0372D;">fail_dset</span>:
  H5Fclose(file);
 <span style="color: #D0372D;">fail_file</span>:;
}

</pre>
</div>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgc00132e" class="outline-3">
<h3 id="orgc00132e">Coming soon</h3>
<div class="outline-text-3" id="text-orgc00132e">
</div>
<ul class="org-ul">
<li><a id="org112f9c4"></a>Fixed- vs. variable-length string performance cage match<br />
<div class="outline-text-4" id="text-org112f9c4">
<ul class="org-ul">
<li>Contributed by Steven (Canada Dry) Varga</li>
<li>You don't want to miss that one!</li>
</ul>
</div>
</li>
<li><a id="org46c05bc"></a>What happens to open HDF5 handles/IDs when your program ends?<br />
<div class="outline-text-4" id="text-org46c05bc">
<ul class="org-ul">
<li>Suggested by Quincey Koziol (LBNL)</li>
<li>We'll take it in pieces
<ul class="org-ul">
<li>Current behavior</li>
<li>How async I/O changes  that picture</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orgee80819"></a>Other topics of interest?<br />
<div class="outline-text-4" id="text-orgee80819">
<p>
Let us know!
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org3cb711f" class="outline-2">
<h2 id="org3cb711f">Clinic 2021-04-27</h2>
<div class="outline-text-2" id="text-org3cb711f">
</div>
<div id="outline-container-org6239fbe" class="outline-3">
<h3 id="org6239fbe">Your questions</h3>
<div class="outline-text-3" id="text-org6239fbe">
</div>
<ul class="org-ul">
<li><a id="org715087e"></a>Question 1<br />
<div class="outline-text-4" id="text-org715087e">
<blockquote>
<p>
Last week you mentioned that one might use the Fortran version of the HDF5
library from C/C++ when working with column-major data.  Could you say more
about this? Is the difference simply how the arguments to the library functions
are interpreted (e.g <code>H5Screate</code>, <code>H5Sselect_hyperslab</code>) are interpreted, or is it
possible to discern from the file itself whether the data is column-major or
row-major?
</p>
</blockquote>
</div>
</li>
</ul>
</div>

<div id="outline-container-org15f5e8a" class="outline-3">
<h3 id="org15f5e8a">Last week's highlights</h3>
<div class="outline-text-3" id="text-org15f5e8a">
</div>
<ul class="org-ul">
<li><a id="org08cd963"></a>Announcements<br />
<div class="outline-text-4" id="text-org08cd963">
<ul class="org-ul">
<li>ECP BOF Day slides are <a href="https://www.hdfgroup.org/wp-content/uploads/2021/04/ECP-HDF5-Comm-BOF-All-Slides.pdf">available</a></li>
<li>Part 2 of  <a href="https://forum.hdfgroup.org/t/webinar-announcement-hdf5-application-tuning-there-is-more-than-one-way-to-skin-a-cat-fish-part-2/8387">HDF5 Application Tuning</a>
<ul class="org-ul">
<li>April 30, 11:00 AM Central</li>
<li>This time it's about HDF5 library performance variability</li>
</ul></li>
<li><a href="https://forum.hdfgroup.org/t/webinar-announcement-h5coro-the-hdf5-cloud-optimized-read-only-library/8429">H5Coro: The HDF5 Cloud-Optimized Read-Only Library</a>
<ul class="org-ul">
<li>May 14, 11:00 AM Central</li>
<li>Looking at ways to efficiently access HDF5 files residing in AWS S3</li>
</ul></li>
<li><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a>
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for abstracts: 1 June 2021</li>
<li>Event: 12-15 October 2021</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org80f929c"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgc203add"></a><a href="https://forum.hdfgroup.org/t/reference-manual-in-doxygen/8230">Doxygen-based RM merged to <code>develop</code></a><br />
<div class="outline-text-5" id="text-orgc203add">
<ul class="org-ul">
<li>Pull requests welcome</li>
<li>Feedback on life cycle intros wanted, e.g., <a href="http://doxygen.hdf5.s3-website.us-east-2.amazonaws.com/group___h5_a.html">H5A</a>, <a href="http://doxygen.hdf5.s3-website.us-east-2.amazonaws.com/group___h5_d.html">H5D</a>, <a href="http://doxygen.hdf5.s3-website.us-east-2.amazonaws.com/group___h5_f.html">H5F</a></li>
</ul>
</div>
</li>
<li><a id="org7d6a000"></a><a href="https://forum.hdfgroup.org/t/parallel-hdf5-write-with-irregular-size-in-one-dimension/8284">Parallel HDF5 write with irregular size in one dimension</a><br />
<div class="outline-text-5" id="text-org7d6a000">
<ul class="org-ul">
<li>Rob Latham confirmed an <a href="https://forum.hdfgroup.org/t/parallel-hdf5-write-with-irregular-size-in-one-dimension/8284/10">issue</a> in Darshan's HDF5 module</li>
</ul>
</div>
</li>
<li><a id="org28ca112"></a><a href="https://forum.hdfgroup.org/t/how-to-use-h5ocopy-to-copy-a-group-with-hard-links/8443">How to use H5ocopy to copy a group with hard links</a><br />
<div class="outline-text-5" id="text-org28ca112">
<ul class="org-ul">
<li>I don't understand it: are we copying groups or links (or both)?</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orgd67e903" class="outline-3">
<h3 id="orgd67e903">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orgd67e903">
</div>
<ul class="org-ul">
<li><a id="org416d2ca"></a>The <code>h5stat</code> tool<br />
<div class="outline-text-5" id="text-org416d2ca">
<pre class="example" id="orgc226828">
Usage: h5stat [OPTIONS] file

      OPTIONS
     -h, --help            Print a usage message and exit
     -V, --version         Print version number and exit
     -f, --file            Print file information
     -F, --filemetadata    Print file space information for file's metadata
     -g, --group           Print group information
     -l N, --links=N       Set the threshold for the # of links when printing
                           information for small groups.  N is an integer greater
                           than 0.  The default threshold is 10.
     -G, --groupmetadata   Print file space information for groups' metadata
     -d, --dset            Print dataset information
     -m N, --dims=N        Set the threshold for the dimension sizes when printing
                           information for small datasets.  N is an integer greater
                           than 0.  The default threshold is 10.
     -D, --dsetmetadata    Print file space information for datasets' metadata
     -T, --dtypemetadata   Print datasets' datatype information
     -A, --attribute       Print attribute information
     -a N, --numattrs=N    Set the threshold for the # of attributes when printing
                           information for small # of attributes.  N is an integer greater
                           than 0.  The default threshold is 10.
     -s, --freespace       Print free space information
     -S, --summary         Print summary of file space information
     --enable-error-stack  Prints messages from the HDF5 error stack as they occur
     --s3-cred=&lt;cred&gt;      Access file on S3, using provided credential
                           &lt;cred&gt; :: (region,id,key)
                           If &lt;cred&gt; == "(,,)", no authentication is used.
     --hdfs-attrs=&lt;attrs&gt;  Access a file on HDFS with given configuration
                           attributes.
                           &lt;attrs&gt; :: (&lt;namenode name&gt;,&lt;namenode port&gt;,
                                       &lt;kerberos cache path&gt;,&lt;username&gt;,
                                       &lt;buffer size&gt;)
                           If an attribute is empty, a default value will be
                           used.
</pre>

<p>
Let's see this in action:
</p>

<pre class="example" id="org04e3427">
File information
        # of unique groups: 718
        # of unique datasets: 351
        # of unique named datatypes: 4
        # of unique links: 353
        # of unique other: 0
        Max. # of links to object: 701
        Max. # of objects in group: 350
File space information for file metadata (in bytes):
        Superblock: 48
        Superblock extension: 0
        User block: 0
        Object headers: (total/unused)
                Groups: 156725/16817
                Datasets(exclude compact data): 129918/538
                Datatypes: 1474/133
        Groups:
                B-tree/List: 21656
                Heap: 33772
        Attributes:
                B-tree/List: 0
                Heap: 0
        Chunked datasets:
                Index: 138
        Datasets:
                Heap: 0
        Shared Messages:
                Header: 0
                B-tree/List: 0
                Heap: 0
        Free-space managers:
                Header: 0
                Amount of free space: 0
Small groups (with 0 to 9 links):
        # of groups with 0 link(s): 1
        # of groups with 1 link(s): 710
        # of groups with 2 link(s): 1
        # of groups with 3 link(s): 2
        # of groups with 4 link(s): 1
        # of groups with 5 link(s): 1
        Total # of small groups: 716
Group bins:
        # of groups with 0 link: 1
        # of groups with 1 - 9 links: 715
        # of groups with 100 - 999 links: 2
        Total # of groups: 718
Dataset dimension information:
        Max. rank of datasets: 1
        Dataset ranks:
                # of dataset with rank 1: 351
1-D Dataset information:
        Max. dimension size of 1-D datasets: 736548
        Small 1-D datasets (with dimension sizes 0 to 9):
                # of datasets with dimension sizes 1: 1
                Total # of small datasets: 1
        1-D Dataset dimension bins:
                # of datasets with dimension size 1 - 9: 1
                # of datasets with dimension size 100000 - 999999: 350
                Total # of datasets: 351
Dataset storage information:
        Total raw data size: 9330522
        Total external raw data size: 0
Dataset layout information:
        Dataset layout counts[COMPACT]: 0
        Dataset layout counts[CONTIG]: 0
        Dataset layout counts[CHUNKED]: 351
        Dataset layout counts[VIRTUAL]: 0
        Number of external files : 0
Dataset filters information:
        Number of datasets with:
                NO filter: 1
                GZIP filter: 0
                SHUFFLE filter: 350
                FLETCHER32 filter: 0
                SZIP filter: 0
                NBIT filter: 0
                SCALEOFFSET filter: 0
                USER-DEFINED filter: 350
Dataset datatype information:
        # of unique datatypes used by datasets: 4
        Dataset datatype #0:
                Count (total/named) = (1/1)
                Size (desc./elmt) = (60/64)
        Dataset datatype #1:
                Count (total/named) = (347/0)
                Size (desc./elmt) = (14/1)
        Dataset datatype #2:
                Count (total/named) = (2/0)
                Size (desc./elmt) = (14/2)
        Dataset datatype #3:
                Count (total/named) = (1/1)
                Size (desc./elmt) = (79/12)
        Total dataset datatype count: 351
Small # of attributes (objects with 1 to 10 attributes):
        # of objects with 1 attributes: 1
        # of objects with 2 attributes: 551
        # of objects with 3 attributes: 147
        # of objects with 4 attributes: 2
        # of objects with 5 attributes: 4
        # of objects with 6 attributes: 1
        Total # of objects with small # of attributes: 706
Attribute bins:
        # of objects with 1 - 9 attributes: 706
        Total # of objects with attributes: 706
        Max. # of attributes to objects: 6
Free-space persist: FALSE
Free-space section threshold: 1 bytes
Small size free-space sections (&lt; 10 bytes):
        Total # of small size sections: 0
Free-space section bins:
        Total # of sections: 0
File space management strategy: H5F_FSPACE_STRATEGY_FSM_AGGR
File space page size: 4096 bytes
Summary of file space information:
  File metadata: 343731 bytes
  Raw data: 9330522 bytes
  Amount/Percent of tracked free space: 0 bytes/0.0%
  Unaccounted space: 5582 bytes
Total space: 9679835 bytes
</pre>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgf252d05" class="outline-3">
<h3 id="orgf252d05">Coming soon</h3>
<div class="outline-text-3" id="text-orgf252d05">
</div>
<ul class="org-ul">
<li><a id="org7762ae8"></a>What happens to open HDF5 handles/IDs when your program ends?<br />
<div class="outline-text-4" id="text-org7762ae8">
<ul class="org-ul">
<li>Suggested by Quincey Koziol (LBNL)</li>
<li>We'll take it in pieces
<ul class="org-ul">
<li>Current behavior</li>
<li>How async I/O changes  that picture</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org06d5137"></a>Other topics of interest?<br />
<div class="outline-text-4" id="text-org06d5137">
<p>
Let us know!
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org31b65c9" class="outline-2">
<h2 id="org31b65c9">Clinic 2021-04-20</h2>
<div class="outline-text-2" id="text-org31b65c9">
</div>
<div id="outline-container-org4f920af" class="outline-3">
<h3 id="org4f920af">Your questions</h3>
</div>
<div id="outline-container-org7d143f5" class="outline-3">
<h3 id="org7d143f5">Last week's highlights</h3>
<div class="outline-text-3" id="text-org7d143f5">
</div>
<ul class="org-ul">
<li><a id="org29580b5"></a>Announcements<br />
<div class="outline-text-4" id="text-org29580b5">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/meetingc-online-tool-fair/8417">MeetingC++ online Tool Fair</a> <b>TODAY</b>
<ul class="org-ul">
<li>A <a href="http://meetingcpp-toolfair.h5cpp.org/#/">must-see</a> for all <a href="http://h5cpp.org/">H5CPP</a> fans!</li>
</ul></li>
<li>Part 2 of  <a href="https://forum.hdfgroup.org/t/webinar-announcement-hdf5-application-tuning-there-is-more-than-one-way-to-skin-a-cat-fish-part-2/8387">HDF5 Application Tuning</a>
<ul class="org-ul">
<li>This time it's about HDF5 library performance variability</li>
</ul></li>
<li><a href="https://forum.hdfgroup.org/t/webinar-announcement-h5coro-the-hdf5-cloud-optimized-read-only-library/8429">H5Coro: The HDF5 Cloud-Optimized Read-Only Library</a>
<ul class="org-ul">
<li>Looking at ways to efficiently access HDF5 files residing in AWS S3</li>
</ul></li>
<li><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a>
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for abstracts: 1 June 2021</li>
<li>Event: 12-15 October 2021</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org1fccf74"></a>Forum<br />
<ul class="org-ul">
<li><a id="org0d71ed8"></a><a href="https://forum.hdfgroup.org/t/parallel-hdf5-write-with-irregular-size-in-one-dimension/8284">Parallel HDF5 write with irregular size in one dimension</a><br />
<div class="outline-text-5" id="text-org0d71ed8">
<ul class="org-ul">
<li>Potential issue in Darshan's HDF5 module</li>
</ul>
</div>
</li>
<li><a id="orga1ac0c5"></a><a href="https://forum.hdfgroup.org/t/independent-datasets-for-mpi-processes-progress/8202">Independent datasets for MPI processes. Progress?</a><br />
<div class="outline-text-5" id="text-orga1ac0c5">
<ul class="org-ul">
<li>Discussing data life cycle and design options
<ul class="org-ul">
<li>Competing requirements</li>
<li>For better or worse, there are often many ways to do one thing in HDF5</li>
<li>Robustness</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org495df6d"></a><a href="https://forum.hdfgroup.org/t/increases-the-use-of-the-system-ram-until-it-reaches-ram-saturation/8392">Increases the use of the system RAM until it reaches RAM saturation</a><br />
<div class="outline-text-5" id="text-org495df6d">
<ul class="org-ul">
<li>Long running application w/ no apparent handle leakage</li>
<li><a href="https://valgrind.org/">Valgrind</a></li>
</ul>
</div>
</li>
<li><a id="org862b455"></a><a href="https://forum.hdfgroup.org/t/calling-fortran-hdf5-function-h5dwrite-f-from-c/8386">Calling fortran HDF5 function h5dwrite<sub>f</sub> from C++</a><br />
<div class="outline-text-5" id="text-org862b455">
<ul class="org-ul">
<li>I'm out of my depth when it comes to Fortran :-(</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orgc0e82c3" class="outline-3">
<h3 id="orgc0e82c3">Tips, tricks, &amp; insights</h3>
<div class="outline-text-3" id="text-orgc0e82c3">
</div>
<ul class="org-ul">
<li><a id="orgcd37cb4"></a>Do I need a degree to use <a href="https://portal.hdfgroup.org/display/HDF5/H5P_SET_FCLOSE_DEGREE"><code>H5Pset_fclose_degree</code></a>?<br />
<div class="outline-text-4" id="text-orgcd37cb4">
<ul class="org-ul">
<li>Identifiers are transient runtime handles to manage HDF5 things</li>
<li>Everything begins with a file handle, but how does it end?
<ul class="org-ul">
<li>Files can be re-opened</li>
<li>Other files can be mounted in HDF5 groups</li>
<li>Traversal of external links may trigger the opening of other files and
objects, but see <a href="https://portal.hdfgroup.org/display/HDF5/H5P_SET_ELINK_FILE_CACHE_SIZE"><code>H5Pset_elink_file_cache_size</code></a></li>
</ul></li>
<li>What happens if a file is closed before other (non-file) handles?
<dl class="org-dl">
<dt><code>H5F_CLOSE_WEAK</code></dt><dd><ul class="org-ul">
<li>File is closed if last open handle</li>
<li>Invalidate file handle and delay file close until remaining objects are
closed</li>
</ul></dd>
<dt><code>H5F_CLOSE_SEMI</code></dt><dd><ul class="org-ul">
<li>File is closed if last open handle</li>
<li><code>H5Fclose</code> generates error if open handles remain</li>
</ul></dd>
<dt><code>H5F_CLOSE_STRONG</code></dt><dd><ul class="org-ul">
<li>File is closed, closing any remaining handles if necessary.</li>
</ul></dd>
<dt><code>H5F_CLOSE_DEFAULT</code></dt><dd>VFD decides, <code>H5F_CLOSE_WEAK</code> for most VFDs. Notable exception: MPI-IO - <code>H5F_CLOSE_SEMI</code></dd>
</dl></li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-org8296843" class="outline-3">
<h3 id="org8296843">Coming soon</h3>
<div class="outline-text-3" id="text-org8296843">
</div>
<ul class="org-ul">
<li><a id="orgdca8611"></a>What happens to open HDF5 handles/IDs when your program ends?<br />
<div class="outline-text-4" id="text-orgdca8611">
<ul class="org-ul">
<li>Suggested by Quincey Koziol (LBNL)</li>
<li>We'll take it in pieces
<ul class="org-ul">
<li>Current behavior</li>
<li>How async I/O changes  that picture</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org0957e9d"></a>Other topics of interest?<br />
<div class="outline-text-4" id="text-org0957e9d">
<p>
Let us know!
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org55684ea" class="outline-2">
<h2 id="org55684ea">Clinic 2021-04-06</h2>
<div class="outline-text-2" id="text-org55684ea">
</div>
<div id="outline-container-org0e0ba1d" class="outline-3">
<h3 id="org0e0ba1d">Your questions</h3>
<div class="outline-text-3" id="text-org0e0ba1d">
</div>
<ul class="org-ul">
<li><a id="org940347f"></a>Question 1<br />
<div class="outline-text-4" id="text-org940347f">
<p>
We have observed that reading a dataset with variable-length ASCII strings and
setting the read mem. type to <code>H5T_C_S1 (size=H5T_VARIABLE /
cset=H5T_CSET_UTF8)</code>, produces an error with <code>H5T.c line 4893 in
H5T__path_find_real(): no appropriate function for conversion path</code>. However,
if we read first another dataset of the same file that contains UTF8 strings and
then the same dataset with ASCII strings, no errors are returned whatsoever and
the content seems to be retrieved. Is this an expected behaviour, or are we
missing something?
</p>
<ul class="org-ul">
<li>As a side note, the same situation can be replicated by setting the cset to
<code>H5T_CSET_ASCII</code> and opening first the ASCII-based dataset before the
UTF8-dataset, or any other combination, as long as the first call succeeded
(e.g., opening the ASCII dataset with <code>cset=H5T_CSET_ASCII</code>, then opening the
same ASCII dataset with <code>cset=H5T_CSET_UTF8</code> also seems to work).</li>
<li>Tested using HDF5 v1.10.7, v1.12.0, and manually compiling the most recent
commit on the official GitHub repository. The code was compiled with GCC
9.3.0 + HPE-MPI v2.22, but no MPI file access property was given (i.e., using
<code>H5P_DEFAULT</code> to avoid MPI-IO).</li>
<li>Further information: <a href="https://github.com/HDFGroup/hdf5/issues/544">https://github.com/HDFGroup/hdf5/issues/544</a></li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgf487ba5" class="outline-3">
<h3 id="orgf487ba5">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgf487ba5">
</div>
<ul class="org-ul">
<li><a id="orgaae18b3"></a>Announcements<br />
<div class="outline-text-4" id="text-orgaae18b3">
<ul class="org-ul">
<li><a href="https://www.nuget.org/packages/HDF5.NET">Alpha 4 release</a> of <a href="https://github.com/Apollo3zehn/HDF5.NET">HDF5.NET</a>
<ul class="org-ul">
<li>Based on the HDF5 file format spec. &amp; no HDF5 library dependence!</li>
</ul></li>
<li><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a>
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for abstracts: 1 June 2021</li>
<li>Event: 12-15 October 2021</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="org7e3bd61"></a>Forum<br />
<ul class="org-ul">
<li><a id="org32a468d"></a><a href="https://forum.hdfgroup.org/t/how-can-attributes-of-an-existing-object-be-modified/8319">How can attributes of an existing object be modified?</a><br />
<div class="outline-text-5" id="text-org32a468d">
<ul class="org-ul">
<li>There are several different "namespaces" in HDF5</li>
<li>Examples:
<ul class="org-ul">
<li>Global (=file-level) path names</li>
<li>Per object attribute names</li>
<li>Per compound type field names</li>
<li>Etc.</li>
</ul></li>
<li>Some have constraints such as reserved characters, character encoding, length,
etc.</li>
<li>Most importantly, they are disjoint and <i>don't mix</i>
<ul class="org-ul">
<li>Disambiguation would be too costly, if not impossible</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org86bd4d3"></a><a href="https://forum.hdfgroup.org/t/hdf5dotnet-library/8314">HDF5DotNet library</a><br />
<div class="outline-text-5" id="text-org86bd4d3">
<ul class="org-ul">
<li>There's perhaps a place for wrappers of the HDF5 C-API and and independent .NET native (=full-managed) solution (e.g., <a href="https://github.com/Apollo3zehn/HDF5.NET">HDF5.NET</a>)</li>
<li><a href="http://swig.org/">SWIG</a> (Simplified Wrapper and Interface Generator) has come a long way
<ul class="org-ul">
<li>Should that be the path forward for <a href="https://github.com/HDFGroup/HDF.PInvoke">HDF.PInvoke</a></li>
<li>We need greater automation and (.NET) platform independence</li>
<li>Focus on testing</li>
<li>Any thoughts/comments?</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="org367e567"></a><a href="https://forum.hdfgroup.org/t/parallel-hdf5-write-with-irregular-size-in-one-dimension/8284">Parallel HDF5 write with irregular size in one dimension</a><br />
<div class="outline-text-5" id="text-org367e567">
<ul class="org-ul">
<li>Posted an example that shows how different ranks can write varying amounts of
data to a chunked dataset in parallel. Some ranks don't write any data. The
chunk size is chosen arbitrarily.</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orgfb8aeb2" class="outline-3">
<h3 id="orgfb8aeb2">Tips &amp; tricks</h3>
<div class="outline-text-3" id="text-orgfb8aeb2">
</div>
<ul class="org-ul">
<li><a id="org02cba01"></a>The "mystery" of the HDF5 file format<br />
<div class="outline-text-4" id="text-org02cba01">
<ul class="org-ul">
<li>The specification published <a href="https://portal.hdfgroup.org/display/HDF5/File+Format+Specification">here</a> can seem overwhelming. Part of the problem is
that you are seeing at least three versions layered on top of each other.</li>
<li>The <a href="https://hdf5.io/develop/_f_m_t1.html">first (?) release</a> was a lot simpler, and has all the core ideas</li>
<li>Once you've digested that, you are ready for the <a href="https://hdf5.io/develop/_s_p_e_c.html">other releases</a> and consider
writing your own (de-)serializer</li>
<li>Don't get carried away: only a tiny fraction of the HDF5 library's code deals
w/ serialization</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="outline-container-org579c7ef" class="outline-3">
<h3 id="org579c7ef">Coming soon</h3>
<div class="outline-text-3" id="text-org579c7ef">
</div>
<ul class="org-ul">
<li><a id="orgf77aae0"></a>What happens to open HDF5 handles/IDs when your program ends?<br />
<div class="outline-text-4" id="text-orgf77aae0">
<ul class="org-ul">
<li>Suggested by Quincey Koziol (LBNL)</li>
<li>We'll take it in pieces
<ul class="org-ul">
<li>Current behavior</li>
<li>How async I/O changes  that picture</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orgcc541f1"></a>Other topics of interest?<br />
<div class="outline-text-4" id="text-orgcc541f1">
<p>
Let us know!
</p>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-orga1d3df8" class="outline-2">
<h2 id="orga1d3df8">Clinic 2021-03-30</h2>
<div class="outline-text-2" id="text-orga1d3df8">
<p>
Canceled because of ECP event.
</p>
</div>
</div>
<div id="outline-container-org84a3fb4" class="outline-2">
<h2 id="org84a3fb4">Clinic 2021-03-23</h2>
<div class="outline-text-2" id="text-org84a3fb4">
</div>
<div id="outline-container-org04fd3b9" class="outline-3">
<h3 id="org04fd3b9">Your questions</h3>
<div class="outline-text-3" id="text-org04fd3b9">
<p>
???
</p>
</div>
</div>

<div id="outline-container-orgeeadf41" class="outline-3">
<h3 id="orgeeadf41">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgeeadf41">
</div>
<ul class="org-ul">
<li><a id="org72aca50"></a>Announcements<br />
<div class="outline-text-4" id="text-org72aca50">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/2021-hdf5-user-group-hug21-call-for-papers/8301">2021 HDF5 User Group Call for Papers</a>
<ul class="org-ul">
<li>Format: "Paper and Presentation" or "Presentation"</li>
<li>Deadline for abstracts: 1 June 2021</li>
<li>Event: 12-15 October 2021</li>
</ul></li>
<li><a href="https://github.com/hdfgroup/hdf4">HDF4 is on GitHub</a></li>
<li>Don't forget to <a href="https://forum.hdfgroup.org/t/webinar-announcement-hermes-a-distributed-buffering-system-for-heterogeneous-storage-hierarchies/8269">register for the Hermes webinar</a> on Friday (03/26)</li>
</ul>
</div>
</li>
<li><a id="org523f220"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgd23f44b"></a><a href="https://forum.hdfgroup.org/t/how-to-convert-xml-to-hdf5/8279">How to convert XML to HDF5</a><br />
<div class="outline-text-5" id="text-orgd23f44b">
<ul class="org-ul">
<li>There is no <i>canonical</i> conversion path, even if you have an XML schema
<ul class="org-ul">
<li>XML is simpler because elements are strictly nested</li>
<li>XML can be trickier because of element repetition and the non-obligatory
nature of certain elements or attributes</li>
</ul></li>
<li>Start w/ a scripting language that has XML (parsing) and HDF5 modules
<ul class="org-ul">
<li><a href="https://github.com/akheron/jansson">Jannson</a> works well if you prefer C</li>
</ul></li>
<li>Consider XSLT to simplify first</li>
</ul>
</div>
</li>
<li><a id="org6826d32"></a><a href="https://forum.hdfgroup.org/t/hdf5dotnet-library/8314">HDF5DotNet library</a><br />
<div class="outline-text-5" id="text-org6826d32">
<ul class="org-ul">
<li>It's been out of maintenance for many years</li>
<li><span class="underline">Alternatives</span>: <a href="https://www.nuget.org/packages/HDF.PInvoke/">HDF.PInvoke</a> (Windows only) and <a href="https://www.nuget.org/packages/HDF.PInvoke.1.10/">HDF.PInvoke.1.10</a> (.NET
Standard)
<ul class="org-ul">
<li>Both are based on HDF5 1.10.x</li>
</ul></li>
<li><b>Note:</b> We (The HDF Group) are neither C# nor .NET experts. <a href="https://docs.microsoft.com/en-us/dotnet/standard/native-interop/pinvoke"><code>PInvoke</code></a> is about
the level of abstraction we can handle. We count on and rely on knowledgeable
community members for advice and contributions.</li>
<li>There are many interesting community projects, for example, <a href="https://github.com/Apollo3zehn/HDF5.NET">HDF5.NET</a>:
<ul class="org-ul">
<li>Based on the HDF5 file format spec. &amp; no HDF5 library dependence!</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org9ee5cc4"></a><a href="https://forum.hdfgroup.org/t/parallel-hdf5-write-with-irregular-size-in-one-dimension/8284">Parallel HDF5 write with irregular size in one dimension</a><br />
<div class="outline-text-5" id="text-org9ee5cc4">
<ul class="org-ul">
<li>Many of our examples s..k, and we have to do a lot better
<ul class="org-ul">
<li>Maybe we created them this way to generate more questions? :-/</li>
</ul></li>
<li>HDF5 dataspaces are logical, chunks are physical
<ul class="org-ul">
<li>Write a (logically) correct program first and then optimize performance!</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org40cce24" class="outline-3">
<h3 id="org40cce24">Tips &amp; tricks</h3>
<div class="outline-text-3" id="text-org40cce24">
</div>
<ul class="org-ul">
<li><a id="org054897c"></a>Large (&gt; 64 KiB) HDF5 attributes<br />
<div class="outline-text-4" id="text-org054897c">
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #0000FF;">import</span> h5py, numpy <span style="color: #0000FF;">as</span> np

<span style="color: #0000FF;">with</span> h5py.File(<span style="color: #008000;">'my.h5'</span>, <span style="color: #008000;">'w'</span>, libver=<span style="color: #008000;">'latest'</span>) <span style="color: #0000FF;">as</span> <span style="color: #006FE0;">file</span>:
    <span style="color: #006FE0;">file</span>.attrs[<span style="color: #008000;">'random[1024]'</span>] = np.random.random(1024)
    <span style="color: #006FE0;">file</span>.attrs[<span style="color: #008000;">'random[1048576]'</span>] = np.random.random(1024*1024)

</pre>
</div>

<p>
The <code>h5dump</code> output looks like this:
</p>

<pre class="example" id="orga2a9415">

gerd@guix ~/scratch/run$ h5dump -pBH my.h5
HDF5 "my.h5" {
SUPER_BLOCK {
   SUPERBLOCK_VERSION 3
   FREELIST_VERSION 0
   SYMBOLTABLE_VERSION 0
   OBJECTHEADER_VERSION 0
   OFFSET_SIZE 8
   LENGTH_SIZE 8
   BTREE_RANK 16
   BTREE_LEAF 4
   ISTORE_K 32
   FILE_SPACE_STRATEGY H5F_FSPACE_STRATEGY_FSM_AGGR
   FREE_SPACE_PERSIST FALSE
   FREE_SPACE_SECTION_THRESHOLD 1
   FILE_SPACE_PAGE_SIZE 4096
   USER_BLOCK {
      USERBLOCK_SIZE 0
   }
}
GROUP "/" {
   ATTRIBUTE "random[1024]" {
      DATATYPE  H5T_IEEE_F64LE
      DATASPACE  SIMPLE { ( 1024 ) / ( 1024 ) }
   }
   ATTRIBUTE "random[1048576]" {
      DATATYPE  H5T_IEEE_F64LE
      DATASPACE  SIMPLE { ( 1048576 ) / ( 1048576 ) }
   }
}
}

</pre>

<p>
The <code>libver='latest'</code> keyword is critical. Running without produces this error:
</p>

<pre class="example" id="org255ea39">

gerd@guix ~/scratch/run$ python3 large_attribute.py
Traceback (most recent call last):
  File "large_attribute.py", line 6, in &lt;module&gt;
    file.attrs['random[1048576]'] = np.random.random(1024*1024)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "/home/gerd/.guix-profile/lib/python3.8/site-packages/h5py/_hl/attrs.py", line 100, in __setitem__
    self.create(name, data=value)
  File "/home/gerd/.guix-profile/lib/python3.8/site-packages/h5py/_hl/attrs.py", line 201, in create
    attr = h5a.create(self._id, self._e(tempname), htype, space)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5a.pyx", line 47, in h5py.h5a.create
RuntimeError: Unable to create attribute (object header message is too large)

</pre>

<p>
<code>libver=('v108', 'v108')</code> also works. (<code>v108</code> corresponds to HDF5 1.8.x).
</p>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-orge41e153" class="outline-2">
<h2 id="orge41e153">Clinic 2021-03-16</h2>
<div class="outline-text-2" id="text-orge41e153">
</div>
<div id="outline-container-org2654620" class="outline-3">
<h3 id="org2654620">Your questions</h3>
<div class="outline-text-3" id="text-org2654620">
<p>
???
</p>
</div>
</div>

<div id="outline-container-orgb4a333a" class="outline-3">
<h3 id="orgb4a333a">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgb4a333a">
</div>
<ul class="org-ul">
<li><a id="org084f5b3"></a>Announcements<br />
<div class="outline-text-4" id="text-org084f5b3">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/webinar-announcement-hermes-a-distributed-buffering-system-for-heterogeneous-storage-hierarchies/8269">Webinar Announcement: Hermes  A Distributed Buffering System for
Heterogeneous Storage Hierarchies</a></li>
<li><a href="https://forum.hdfgroup.org/t/hsds-version-0-6-3-released/8270">HSDS version 0.6.3 released</a>
<ul class="org-ul">
<li>Grab the latest image on Docker Hub <code>hdfgroup/hsds:v0.6.3</code>!</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org657b9cf"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgf3072ba"></a><a href="https://forum.hdfgroup.org/t/multithreaded-writing-to-a-single-file-in-c/8264">Multithreaded writing to a single file in C++ </a><br />
<div class="outline-text-5" id="text-orgf3072ba">
<ul class="org-ul">
<li>Beware of non-thread-safe wrappers or language bindings!</li>
<li>Compiling the C library with <code>--enable-threadsafe</code> is only the first step</li>
</ul>
</div>
</li>
<li><a id="org219372a"></a><a href="https://forum.hdfgroup.org/t/reference-manual-in-doxygen/8230">Reference Manual in Doxygen</a><br />
<div class="outline-text-5" id="text-org219372a">
<ul class="org-ul">
<li>Making good progress; see <a href="https://github.com/HDFGroup/hdf5/tree/doxygen2">GitHub</a> and <a href="https://hdf5.io/develop/index.html">preview</a></li>
<li>What do you think?</li>
<li>In which order should existing content be migrated? <a href="https://forum.hdfgroup.org/t/reference-manual-in-doxygen/8230">Chime in!</a>
<ul class="org-ul">
<li><a href="https://portal.hdfgroup.org/display/knowledge">HDF Knowledge Base</a>?</li>
</ul></li>
<li>Examples:
<ul class="org-ul">
<li><a href="https://hdf5.io/develop/api-compat-macros.html">API Compatibility Macros</a></li>
<li><a href="https://hdf5.io/develop/_t_n_m_d_c.html">Metadata Caching in HDF5</a></li>
<li><a href="https://hdf5.io/develop/_f_m_t.html">File Format Specification</a></li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org47f1880"></a><a href="https://forum.hdfgroup.org/t/h5i-get-name-call-is-very-slow-for-hdf5-file-5-gb/8246"><code>H5Iget_name</code> call is very slow for HDF5 file &gt; 5 GB</a><br />
<div class="outline-text-5" id="text-org47f1880">
<ul class="org-ul">
<li><a href="https://portal.hdfgroup.org/display/HDF5/H5I_GET_NAME"><code>H5Iget_name</code></a> constructs <i>an</i> HDF5 path name given an object identifier
<ul class="org-ul">
<li><span class="underline">Use Case</span>: You are in a corner of an application where all you've got is a
handle (identifier) and you would like to render something meaningful to
humans.</li>
</ul></li>
<li>It's not so much the file size but the number and arrangement of objects that
makes <code>H5Iget_name</code> slow
<ul class="org-ul">
<li>See the <a href="https://portal.hdfgroup.org/display/HDF5/h5stat"><code>h5stat</code></a> output the user provided!</li>
</ul></li>
<li>What contributes to <code>H5Iget_name</code> being slow?
<ul class="org-ul">
<li>The path names are not stored in an HDF5 file (except in symbolic links&#x2026;)
and are created on-demand</li>
<li>In general, HDF5 <i>arrangements</i> are not trees, not even directed graphs, but
directed multi-graphs
<ul class="org-ul">
<li>A node can be the target of multiple edges (including from the same source
node)</li>
<li>Certain nodes (groups) can be source and target of an edge</li>
</ul></li>
</ul></li>
<li>*Take-Home-Message:*Unless you are certain that your HDF5 arrangement is a
tree, you are skating on thin ice with path names!
<ul class="org-ul">
<li>Trying to uniquely identify objects via path name is asking for trouble
<ul class="org-ul">
<li>Use addresses + file IDs (pre-HDF 1.12) or tokens (HDF 1.12+) for that!</li>
</ul></li>
</ul></li>
<li>Quincey points out that
<ul class="org-ul">
<li>The library caches metadata that can accelerate <code>H5Iget_name</code></li>
<li><p>
But there are other complications
</p>
<ul class="org-ul">
<li>For example, you can have "anonymous" objects (objects that haven't</li>
</ul>
<p>
been linked to groups in the file. i.e., no path yet)
</p>
<ul class="org-ul">
<li>Another source of trouble are objects that have been unlinked</li>
</ul></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-org00cc3b5" class="outline-3">
<h3 id="org00cc3b5">Tips &amp; tricks</h3>
<div class="outline-text-3" id="text-org00cc3b5">
</div>
<ul class="org-ul">
<li><a id="orgce67672"></a>How to open an HDF5 in append mode?<br />
<div class="outline-text-4" id="text-orgce67672">
<p>
To be clear, there is no <code>H5F*</code> call that behaves like an append call. But we
can mimic one as follows:
</p>

<p>
<b>Credits:</b> Werner Benger
</p>

<div class="org-src-container">
<pre class="src src-C"><span class="linenr"> 1: </span>
<span class="linenr"> 2: </span>hid = H5Fcreate(filename, H5F_ACC_EXCL|H5F_ACC_SWMR_WRITE, fcpl_id, fapl_id);
<span class="linenr"> 3: </span><span style="color: #0000FF;">if</span> (hid &lt; 0)
<span class="linenr"> 4: </span>  {
<span class="linenr"> 5: </span>    hid = H5Fopen(filename, H5F_ACC_RDWR|H5F_ACC_SWMR_WRITE, fapl_id);
<span class="linenr"> 6: </span>  }
<span class="linenr"> 7: </span>
<span class="linenr"> 8: </span><span style="color: #0000FF;">if</span> (hid &lt; 0)
<span class="linenr"> 9: </span>  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">something's going on...</span>
<span class="linenr">10: </span>
</pre>
</div>

<ul class="org-ul">
<li>If the file exists <code>H5Fcreate</code> will fail and <code>H5Fopen</code> with <code>H5F_ACC_RDWR</code>
will kick in.
<ul class="org-ul">
<li>If the file is not an HDF5 file, both will fail.</li>
</ul></li>
<li>If the file does not exist, <code>H5Fcreate</code> will do its job.</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org3456aa7" class="outline-2">
<h2 id="org3456aa7">Clinic 2021-03-09</h2>
<div class="outline-text-2" id="text-org3456aa7">
</div>
<div id="outline-container-org090db3c" class="outline-3">
<h3 id="org090db3c">Your questions (as of 9:00 a.m. Central Time)</h3>
<div class="outline-text-3" id="text-org090db3c">
</div>
<ul class="org-ul">
<li><a id="orgbb5a03c"></a>Question 1<br />
<div class="outline-text-4" id="text-orgbb5a03c">
<blockquote>
<p>
Is there a limit on array size if I save an array as an attribute of a dataset?
</p>

<p>
In terms of the performance, is there any consequence if I save a large amount
of data into an attribute?
</p>
</blockquote>

<dl class="org-dl">
<dt>Size limit</dt><dd>No, not in newer versions (1.8.x+) of HDF5. See <a href="https://portal.hdfgroup.org/pages/viewpage.action?pageId=48808714">What limits are there in HDF5?</a>
<ul class="org-ul">
<li>Make sure that downstream applications can handle such attributes (i.e., use
HDF5 1.8.x or later)</li>
<li>Remember to tell the library that you want to use the 1.8 or later file
format via <a href="https://portal.hdfgroup.org/display/HDF5/H5F_SET_LIBVER_BOUNDS"><code>H5Fset_libverbounds</code></a> (e.g., set <code>low</code> to <code>H5F_LIBVER_V18</code>)</li>
<li>Also keep an eye on <a href="https://portal.hdfgroup.org/display/HDF5/H5P_SET_ATTR_PHASE_CHANGE"><code>H5Pset_attr_phase_change</code></a> (Consider setting <code>max_compact</code> to 0.)</li>
</ul></dd>
<dt>Performance</dt><dd>It depends. (&#x2026;on what you mean by <i>performance</i>)
<ul class="org-ul">
<li>Attributes have a different function (from datasets) in HDF5
<ul class="org-ul">
<li>They "decorate" other objects - application metadata</li>
</ul></li>
<li>Their values are treated as atomic units, i.e., you will always write and
read the entire "large" value.
<ul class="org-ul">
<li>In other words, you lose partial I/O</li>
<li>Several layouts available for datasets are not supported with attributes
<ul class="org-ul">
<li>No compression</li>
</ul></li>
</ul></li>
</ul></dd>
</dl>
</div>
</li>

<li><a id="org1f1732c"></a>Question 2<br />
<div class="outline-text-4" id="text-org1f1732c">
<blockquote>
<p>
Question regarding hdf5 I/O performance, compare saving data into a large array
in one dataset Vs saving data into several smaller arrays and in several
dataset. Any consequence in terms of the performance? Will there be any sweet
spot for best performance? Or any tricks to make it reading/writing faster? I
know parallel I/O but parallel I/O would need hardware support which is not
always available. So the question is about the tricks to speed up I/O without
parallel I/O.
</p>
</blockquote>

<dl class="org-dl">
<dt>One large dataset vs. many small datasets, which is faster?</dt><dd>It depends.
<ul class="org-ul">
<li>How do you access the data?
<ul class="org-ul">
<li>Do you always write/read the entire array in the order it was written?</li>
<li>Is it WORM (write once read many)?
<ul class="org-ul">
<li>How and how frequently does it change?</li>
</ul></li>
</ul></li>
<li>How compressible is the data?
<ul class="org-ul">
<li>Do you need to store data at all? E.g., <a href="https://www.hdfgroup.org/2021/02/webinar-learn-about-data-virtualization-with-hdf5-udf-and-how-it-can-streamline-your-work-materials/">HDF5-UDF</a></li>
</ul></li>
<li>What is performance for you and how do you measure it?</li>
<li>What percentage of total runtime does your application spend doing I/O?</li>
<li>What scalability behavior do you expect?</li>
<li>Assuming throughput is the measure, create a baseline for your target
system, for example, via <a href="https://fio.readthedocs.io/en/latest/fio_doc.html">FIO</a> or <a href="https://github.com/hpc/ior">IOR</a>
<ul class="org-ul">
<li>Your goal is to saturate the I/O subsystem</li>
<li>Is this a dedicated system?</li>
</ul></li>
<li>Which other systems do you need to support? Are you the only user? What's
the future?</li>
<li><b><b>What's the budget?</b></b></li>
</ul></dd>
</dl>
</div>
</li>
</ul>
</div>

<div id="outline-container-org74980f9" class="outline-3">
<h3 id="org74980f9">Last week's highlights</h3>
<div class="outline-text-3" id="text-org74980f9">
</div>
<ul class="org-ul">
<li><a id="orgc006b67"></a>Announcements<br />
<ul class="org-ul">
<li><a id="org3ad689b"></a><a href="https://forum.hdfgroup.org/t/ann-h5py-3-2-released/8232">h5py 3.2 release</a><br />
<div class="outline-text-5" id="text-org3ad689b">
<ul class="org-ul">
<li>Supports the HDF5 S3 (read-only) VFD thanks to Satrajit Ghosh
<ul class="org-ul">
<li>Need to <a href="https://docs.h5py.org/en/stable/build.html#source-install">build h5py from source</a></li>
</ul></li>
<li>Minimum Python version 3.7</li>
<li>Interesting bugfix: <a href="https://github.com/h5py/h5py/issues/1817">Fix reading data with a datatype of variable-length arrays of fixed length strings</a></li>
</ul>
</div>
</li>
<li><a id="org9e63ab6"></a>HDF5 Community BOF at ECP Community BOF Days<br />
<div class="outline-text-5" id="text-org9e63ab6">
<ul class="org-ul">
<li>March 30, 3:00 p.m. (Eastern)</li>
<li><a href="https://exascaleproject.zoomgov.com/meeting/register/vJItf-Chrj4jH9xNnStZkPE-P84YcZ52-7s">Registration</a></li>
</ul>
</div>
</li>
</ul>
</li>
<li><a id="org58b534c"></a>Forum<br />
<ul class="org-ul">
<li><a id="org4a0415d"></a><a href="https://forum.hdfgroup.org/t/get-object-header-size/8233">Get Object Header size</a><br />
<div class="outline-text-5" id="text-org4a0415d">
<ul class="org-ul">
<li><p>
The user created a compound type with 100s of fields and eventually saw this
error:
</p>
<pre class="example" id="orgdb24686">
H5Oalloc.c line 1312 in H5O__alloc(): object header message is too large
</pre></li>
<li>This issue was first raised (Jira-ticket HDFFV-1089 date) on  Jun 08, 2009</li>
<li><b><b>Root cause:</b></b> the size of header message data is represented in a 2 byte
unsigned integer (see section IV.A.1.a and IV.A.1.b of the <a href="https://portal.hdfgroup.org/display/HDF5/File+Format+Specification">HDF5 file format spec.</a>)
<ul class="org-ul">
<li>Ergo, header messages, currently, cannot be larger than 64 KB.</li>
<li>Datatype information is stored in a header message (see section IV.A.2.d)</li>
<li>This can be fixed with a file format update, but it's <i>fallen through the
cracks</i> for over 10 years</li>
</ul></li>
<li>The customer is always right, but who needs 100s of fields in a compound type?
<ul class="org-ul">
<li><span class="underline">Use Case</span>: You have a large record type and you always (or most of the
time) read and write all fields together.</li>
<li>Outside this narrow use case you are bound to lose a lot of performance and
flexibility</li>
</ul></li>
<li>You are Leaving the <del>American Sector</del> Mainstream: not too many tools will be
able to handle your data</li>
<li>Better approach: divide-and-conquer, i.e., go w/ a group of compounds or
individual columns</li>
</ul>
</div>
</li>
<li><a id="orgb6cb4a0"></a><a href="https://forum.hdfgroup.org/t/using-hdf5-in-qt-creator/8194">Using HDF5 in Qt Creator</a><br />
<div class="outline-text-5" id="text-orgb6cb4a0">
<ul class="org-ul">
<li>Linker can't find <code>H5::FileAccPropList()</code> and <code>H5::FileCreatPropList()</code></li>
<li>Works fine in release mode, but not in debug mode</li>
<li>AFAIK, we don't distribute debug libraries in binary form. Still doesn't
explain why the user couldn't use the release binaries in a debug build,
unless QT Creator is extra pedantic?</li>
</ul>
</div>
</li>
<li><a id="org686f045"></a><a href="https://forum.hdfgroup.org/t/reference-manual-in-doxygen/8230">Reference Manual in Doxygen</a><br />
<div class="outline-text-5" id="text-org686f045">
<ul class="org-ul">
<li>Making good progress; see <a href="https://github.com/HDFGroup/hdf5/tree/doxygen2">GitHub</a> and <a href="https://hdf5.io/develop/index.html">preview</a></li>
<li>What do you think?</li>
<li>In which order should existing content be migrated? <a href="https://forum.hdfgroup.org/t/reference-manual-in-doxygen/8230">Chime in!</a>
<ul class="org-ul">
<li><a href="https://portal.hdfgroup.org/display/knowledge">HDF Knowledge Base</a>?</li>
</ul></li>
<li>Examples:
<ul class="org-ul">
<li><a href="https://hdf5.io/develop/api-compat-macros.html">API Compatibility Macros</a></li>
<li><a href="https://hdf5.io/develop/_t_n_m_d_c.html">Metadata Caching in HDF5</a></li>
<li><a href="https://hdf5.io/develop/_f_m_t.html">File Format Specification</a></li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org56484ae"></a><a href="https://forum.hdfgroup.org/t/h5i-get-name-call-is-very-slow-for-hdf5-file-5-gb/8246"><code>H5Iget_name</code> call is very slow for HDF5 file &gt; 5 GB</a><br />
<div class="outline-text-5" id="text-org56484ae">
<ul class="org-ul">
<li><a href="https://portal.hdfgroup.org/display/HDF5/H5I_GET_NAME"><code>H5Iget_nname</code></a> constructs <i>an</i> HDF5 path name given an object identifier
<ul class="org-ul">
<li><span class="underline">Use Case</span>: You are in a corner of an application where all you've got is a
handle (identifier) and you would like to render something meaningful to
humans.</li>
</ul></li>
<li>It's not so much the file size but the number and arrangement of objects that
makes <code>H5Iget_name</code> slow
<ul class="org-ul">
<li>See the <a href="https://portal.hdfgroup.org/display/HDF5/h5stat"><code>h5stat</code></a> output the user provided!</li>
</ul></li>
<li>What contributes to <code>H5Iget_name</code> being slow?
<ul class="org-ul">
<li>The path names are not stored in an HDF5 file (except in symbolic links&#x2026;)
and are created on-demand</li>
<li>In general, HDF5 <i>arrangements</i> are not trees, not even directed graphs, but
directed multi-graphs
<ul class="org-ul">
<li>A node can be the target of multiple edges (including from the same source
node)</li>
<li>Certain nodes (groups) can be source and target of an edge</li>
</ul></li>
</ul></li>
<li>*Take-Home-Message:*Unless you are certain that your HDF5 arrangement is a
tree, you are skating on thin ice with path names!
<ul class="org-ul">
<li>Trying to uniquely identify objects via path name is asking for trouble
<ul class="org-ul">
<li>Use addresses + file IDs (pre-HDF 1.12) or tokens (HDF 1.12+) for that!</li>
</ul></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgd371dc4" class="outline-2">
<h2 id="orgd371dc4">Clinic 2021-03-02</h2>
<div class="outline-text-2" id="text-orgd371dc4">
</div>
<div id="outline-container-org9b9e410" class="outline-3">
<h3 id="org9b9e410">Your questions</h3>
<div class="outline-text-3" id="text-org9b9e410">
</div>
<ul class="org-ul">
<li><a id="orgc62190c"></a><a href="https://github.com/steven-varga/h5rnd">h5rnd</a><br />
<div class="outline-text-4" id="text-orgc62190c">
<ul class="org-ul">
<li><b><b>Question:</b></b> How are generated HDF5 objects named?  An integer name, or can a
randomized string be used?
<ul class="org-ul">
<li><code>h5rnd</code> Generates a pool of random strings as link names</li>
<li>Uniform length distribution between 5 and 30 over <code>[a-z][A-Z]</code></li>
</ul></li>

<li><b><b>Question:</b></b> Does it create multi-dimensional datasets with a rich set of
HDF5 datatypes?  Compound datatypes, perhaps?
<ul class="org-ul">
<li>Currently, it creates 1,000 element 1D FP64 datasets (w/ attribute)</li>
<li>RE: types - anything is possible. Budget?</li>
</ul></li>

<li><b><b>Question:</b></b> Are named datatypes generated? If not, are these reasonable
types of extensions for <code>h5rnd</code>?
<ul class="org-ul">
<li>Not currently, but anything is possible</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="org4826d08"></a>Other questions?<br />
<div class="outline-text-4" id="text-org4826d08">
<ul class="org-ul">
<li><b><b>Question:</b></b> How do these extensions fit with the general intent and
extensibility of <code>h5rnd</code>?
<ul class="org-ul">
<li>It was written as an illustration</li>
<li>Uses an older version of H5CPP</li>
<li>Labeling could be improved</li>
<li>Dataset generation under development</li>
<li>Some enhancements in a future version</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgd251c7b" class="outline-3">
<h3 id="orgd251c7b">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgd251c7b">
</div>
<ul class="org-ul">
<li><a id="orgee691ea"></a>Forum<br />
<ul class="org-ul">
<li><a id="orgecd2d11"></a><a href="https://forum.hdfgroup.org/t/external-link-access-in-parallel-hdf5-1-12-0/8219">External link access in parallel HDF5 1.12.0</a><br />
<div class="outline-text-5" id="text-orgecd2d11">
<ul class="org-ul">
<li>Can't access externally linked datasets in parallel; fine in 1.10.x and in serial</li>
<li>It appears that someone encountered a known bug in the field</li>
<li>Dev. claim it's fixed in <code>develop</code>, waiting for confirmation from the user</li>
</ul>
</div>
</li>

<li><a id="org2262597"></a><a href="https://forum.hdfgroup.org/t/h5i-dec-ref-hangs/8104"><code>H5I_dec_ref</code> hangs</a><br />
<div class="outline-text-5" id="text-org2262597">
<ul class="org-ul">
<li><a href="https://portal.hdfgroup.org/display/HDF5/H5I_DEC_REF"><code>H5Idec_ref</code></a> is one of those functions that needs to be used w/ extra care</li>
<li>Using <code>mpi4py</code> and <code>h5py</code></li>
<li>User provided an MWE (in Python) and, honestly, there is limited help we can
offer (as we are neither <code>mpi4py</code> nor <code>h5py</code> experts)</li>
<li>A C or C++ MWE might be the better starting point</li>
</ul>
</div>
</li>

<li><a id="org97c543b"></a><a href="https://forum.hdfgroup.org/t/h5diff-exits-with-1-but-doesnt-print-differences/6872"><code>h5diff</code> exits with 1 but doesnt print differences</a><br />
<div class="outline-text-5" id="text-org97c543b">
<ul class="org-ul">
<li>Case of out-of-date/poor documentation</li>
<li><a href="https://portal.hdfgroup.org/display/HDF5/h5diff"><code>h5diff</code></a> is perhaps the most complex tool (multi-graph comparison + what does
<code>'='</code> mean?)</li>
<li>Writing code is the easy part</li>
<li>We need to do better</li>
</ul>
</div>
</li>

<li><a id="org5a9e9c8"></a><a href="https://forum.hdfgroup.org/t/independent-datasets-for-mpi-processes-progress/8202">Independent datasets for MPI processes. Progress?</a><br />
<div class="outline-text-5" id="text-org5a9e9c8">
<ul class="org-ul">
<li>Need some clarification on the problem formulation</li>
<li>Current status (w/ MPI) MD-modifying ops. must be collective</li>
<li>On the horizon: asynchronous operations (ASYNC VOL)</li>
</ul>
</div>
</li>

<li><a id="orgede0eb0"></a><a href="https://forum.hdfgroup.org/t/writing-to-virtual-datasets/8188">Writing to virtual datasets</a><br />
<div class="outline-text-5" id="text-orgede0eb0">
<ul class="org-ul">
<li>Apparently broken when a datatype conversion (truncation!) is involved</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org58dc469" class="outline-2">
<h2 id="org58dc469">Clinic 2021-02-23</h2>
<div class="outline-text-2" id="text-org58dc469">
</div>
<div id="outline-container-org8ddbc97" class="outline-3">
<h3 id="org8ddbc97">Your questions</h3>
<div class="outline-text-3" id="text-org8ddbc97">
</div>
<ul class="org-ul">
<li><a id="orgd4de7d6"></a>How to use <code>H5Ocopy</code> in C++ code?<br />
<div class="outline-text-4" id="text-orgd4de7d6">
<ul class="org-ul">
<li><p>
<a href="https://forum.hdfgroup.org/t/how-to-use-h5copy-in-c-code/8175">Forum post</a>
</p>
<blockquote>
<p>
sandhya.v250 (Feb 19)
</p>

<p>
Hello Team, I want to copy few groups from one hdf5 file to hdf5 another file
which is not yet created and this should be done inside the C++ code..can you
please tell me how can I use this inside this tool
</p>
</blockquote></li>

<li><p>
The <a href="https://portal.hdfgroup.org/display/HDF5/H5O_COPY">function in question</a>  (there is also a tool called <code>h5copy</code>):
</p>
<div class="org-src-container">
<pre class="src src-C">
<span style="color: #6434A3;">herr_t</span> <span style="color: #006699;">H5Ocopy</span>
(
 <span style="color: #6434A3;">hid_t</span>       <span style="color: #BA36A5;">src_loc_id</span>,
 <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">char</span>* <span style="color: #BA36A5;">src_name</span>,
 <span style="color: #6434A3;">hid_t</span>       <span style="color: #BA36A5;">dst_loc_id</span>,
 <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">char</span>* <span style="color: #BA36A5;">dst_name</span>,
 <span style="color: #6434A3;">hid_t</span>       <span style="color: #BA36A5;">ocpypl_id</span>,
 <span style="color: #6434A3;">hid_t</span>       <span style="color: #BA36A5;">lcpl_id</span>
 );

</pre>
</div></li>

<li>The emphasis  appears to be on C++
<ul class="org-ul">
<li>You can do this in C. It's just more boilerplate.</li>
<li>Whenever I need something C++, I turn to my colleague Steven Varga (=
Mr. <a href="http://h5cpp.org/">H5CPP</a>)</li>
<li>He also created a nice <a href="https://github.com/steven-varga/h5rnd">random HDF5 file generator/tester</a> (= 'Prfer' in
German)</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="org50ed3e2"></a>Steven's solution (excerpt)<br />
<div class="outline-text-4" id="text-org50ed3e2">
<p>
The full example can be downloaded from <a href="https://github.com/steven-varga/HDFGroup-mailinglist/tree/master/object-copy-2021-feb-18">here</a>.
</p>

<p>
<b><b>Basic idea:</b></b> Visit all objects in the source via <code>H5Ovisit</code> and invoke
<code>H5Ocopy</code> in the callback.
</p>

<div class="org-src-container">
<pre class="src src-C++"><span class="linenr"> 1: </span>
<span class="linenr"> 2: </span><span style="color: #808080;">#include</span> <span style="color: #008000;">"argparse.h"</span>
<span class="linenr"> 3: </span><span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;h5cpp/all&gt;</span>
<span class="linenr"> 4: </span><span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;string&gt;</span>
<span class="linenr"> 5: </span>
<span class="linenr"> 6: </span><span style="color: #6434A3;">herr_t</span> <span style="color: #006699;">ocpy_callback</span>(<span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">src</span>, <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">char</span> *<span style="color: #BA36A5;">name</span>, <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">H5O_info_t</span> *<span style="color: #BA36A5;">info</span>,
<span class="linenr"> 7: </span>                     <span style="color: #6434A3;">void</span> *<span style="color: #BA36A5;">dst_</span>) {
<span class="linenr"> 8: </span>  <span style="color: #6434A3;">hid_t</span>* <span style="color: #BA36A5;">dst</span> = <span style="color: #0000FF;">static_cast</span>&lt;<span style="color: #6434A3;">hid_t</span>*&gt;(dst_);
<span class="linenr"> 9: </span>  <span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">err</span> = 0;
<span class="linenr">10: </span>  <span style="color: #0000FF;">switch</span>( info-&gt;type ){
<span class="linenr">11: </span>  <span style="color: #0000FF;">case</span> H5O_TYPE_GROUP:
<span class="linenr">12: </span>    <span style="color: #0000FF;">if</span>(H5Lexists( *dst, name, H5P_DEFAULT) &gt;= 0)
<span class="linenr">13: </span>      err = H5Ocopy(src, name, *dst, name, H5P_DEFAULT, H5P_DEFAULT);
<span class="linenr">14: </span>    <span style="color: #0000FF;">break</span>;
<span class="linenr">15: </span>  <span style="color: #0000FF;">case</span> H5O_TYPE_DATASET:
<span class="linenr">16: </span>    err = H5Ocopy(src, name, *dst, name, H5P_DEFAULT, H5P_DEFAULT);
<span class="linenr">17: </span>    <span style="color: #0000FF;">break</span>;
<span class="linenr">18: </span>  <span style="color: #0000FF;">default</span>: <span style="color: #8D8D84;">/*</span><span style="color: #8D8D84; font-style: italic;">H5O_TYPE_NAMED_DATATYPE, H5O_TYPE_NTYPES, H5O_TYPE_UNKNOWN</span><span style="color: #8D8D84;"> */</span>
<span class="linenr">19: </span>    ; <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">nop to keep compiler happy</span>
<span class="linenr">20: </span>  }
<span class="linenr">21: </span>  <span style="color: #0000FF;">return</span> 0;
<span class="linenr">22: </span>}
<span class="linenr">23: </span>
<span class="linenr">24: </span><span style="color: #6434A3;">int</span> <span style="color: #006699;">main</span>(<span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">argc</span>, <span style="color: #6434A3;">char</span> **<span style="color: #BA36A5;">argv</span>)
<span class="linenr">25: </span>{
<span class="linenr">26: </span>  <span style="color: #D0372D;">argparse</span>::<span style="color: #6434A3;">ArgumentParser</span> <span style="color: #BA36A5;">arg</span>(<span style="color: #008000;">"ocpy"</span>, <span style="color: #008000;">"0.0.1"</span>);
<span class="linenr">27: </span>  arg.add_argument(<span style="color: #008000;">"-i"</span>, <span style="color: #008000;">"--input"</span>)
<span class="linenr">28: </span>    .required().help(<span style="color: #008000;">"path to input hdf5 file"</span>);
<span class="linenr">29: </span>  arg.add_argument(<span style="color: #008000;">"-s"</span>, <span style="color: #008000;">"--source"</span>)
<span class="linenr">30: </span>    .default_value(<span style="color: #D0372D;">std</span>::string(<span style="color: #008000;">"/"</span>))
<span class="linenr">31: </span>    .help(<span style="color: #008000;">"path to group within hdf5 container"</span>);
<span class="linenr">32: </span>  arg.add_argument(<span style="color: #008000;">"-o"</span>, <span style="color: #008000;">"--output"</span>).required()
<span class="linenr">33: </span>    .help(<span style="color: #008000;">"the new hdf5 will be created/or opened rw"</span>);
<span class="linenr">34: </span>  arg.add_argument(<span style="color: #008000;">"-d"</span>, <span style="color: #008000;">"--destination"</span>)
<span class="linenr">35: </span>    .default_value(<span style="color: #D0372D;">std</span>::string(<span style="color: #008000;">"/"</span>))
<span class="linenr">36: </span>    .help(<span style="color: #008000;">"target group"</span>);
<span class="linenr">37: </span>
<span class="linenr">38: </span>  <span style="color: #D0372D;">std</span>::<span style="color: #6434A3;">string</span> <span style="color: #BA36A5;">input</span>, <span style="color: #BA36A5;">output</span>, <span style="color: #BA36A5;">source</span>, <span style="color: #BA36A5;">destination</span>;
<span class="linenr">39: </span>  <span style="color: #0000FF;">try</span> {
<span class="linenr">40: </span>    arg.parse_args(argc, argv);
<span class="linenr">41: </span>    input = arg.get&lt;<span style="color: #D0372D;">std</span>::<span style="color: #6434A3;">string</span>&gt;(<span style="color: #008000;">"--input"</span>);
<span class="linenr">42: </span>    output = arg.get&lt;<span style="color: #D0372D;">std</span>::<span style="color: #6434A3;">string</span>&gt;(<span style="color: #008000;">"--output"</span>);
<span class="linenr">43: </span>    source = arg.get&lt;<span style="color: #D0372D;">std</span>::<span style="color: #6434A3;">string</span>&gt;(<span style="color: #008000;">"--source"</span>);
<span class="linenr">44: </span>    destination = arg.get&lt;<span style="color: #D0372D;">std</span>::<span style="color: #6434A3;">string</span>&gt;(<span style="color: #008000;">"--destination"</span>);
<span class="linenr">45: </span>
<span class="linenr">46: </span>    <span style="color: #D0372D;">h5</span>::<span style="color: #6434A3;">fd_t</span> <span style="color: #BA36A5;">fd_i</span> = <span style="color: #D0372D;">h5</span>::open(input, H5F_ACC_RDONLY);
<span class="linenr">47: </span>    <span style="color: #D0372D;">h5</span>::<span style="color: #6434A3;">fd_t</span> <span style="color: #BA36A5;">fd_o</span> = <span style="color: #D0372D;">h5</span>::create(output, H5F_ACC_TRUNC);
<span class="linenr">48: </span>    <span style="color: #D0372D;">h5</span>::<span style="color: #6434A3;">gr_t</span> <span style="color: #BA36A5;">dgr</span>{H5I_UNINIT}, <span style="color: #BA36A5;">sgr</span> = <span style="color: #D0372D;">h5</span>::gr_t{H5Gopen(fd_i, source.data(),
<span class="linenr">49: </span>                                                     H5P_DEFAULT)};
<span class="linenr">50: </span>    <span style="color: #D0372D;">h5</span>::mute();
<span class="linenr">51: </span>    <span style="color: #0000FF;">if</span>( destination != <span style="color: #008000;">"/"</span> ){
<span class="linenr">52: </span>      <span style="color: #6434A3;">char</span> * <span style="color: #BA36A5;">gname</span> = destination.data();
<span class="linenr">53: </span>      dgr = H5Lexists(fd_o, gname, H5P_DEFAULT) &gt;= 0 ?
<span class="linenr">54: </span>        <span style="color: #D0372D;">h5</span>::gr_t{H5Gcreate(fd_o, gname, H5P_DEFAULT, H5P_DEFAULT,
<span class="linenr">55: </span>                           H5P_DEFAULT)}
<span class="linenr">56: </span>        : <span style="color: #D0372D;">h5</span>::gr_t{H5Gopen(fd_i, gname, H5P_DEFAULT)};
<span class="linenr">57: </span>      H5Ovisit(sgr, H5_INDEX_CRT_ORDER, H5_ITER_NATIVE, ocpy_callback, &amp;dgr );
<span class="linenr">58: </span>    } <span style="color: #0000FF;">else</span>
<span class="linenr">59: </span>      H5Ovisit(sgr, H5_INDEX_CRT_ORDER, H5_ITER_NATIVE, ocpy_callback, &amp;fd_o);
<span class="linenr">60: </span>    <span style="color: #D0372D;">h5</span>::unmute();
<span class="linenr">61: </span>  } <span style="color: #0000FF;">catch</span> ( <span style="color: #0000FF;">const</span> <span style="color: #D0372D;">h5</span>::<span style="color: #D0372D;">error</span>::<span style="color: #6434A3;">any</span>&amp; <span style="color: #BA36A5;">e</span> ) {
<span class="linenr">62: </span>    <span style="color: #D0372D;">std</span>::cerr &lt;&lt; e.what() &lt;&lt; <span style="color: #D0372D;">std</span>::endl;
<span class="linenr">63: </span>    <span style="color: #D0372D;">std</span>::cout &lt;&lt; arg;
<span class="linenr">64: </span>  }
<span class="linenr">65: </span>  <span style="color: #0000FF;">return</span> 0;
<span class="linenr">66: </span>}
<span class="linenr">67: </span>
</pre>
</div>
</div>
</li>

<li><a id="org2d76e46"></a>Parting thoughts<br />
<div class="outline-text-4" id="text-org2d76e46">
<ul class="org-ul">
<li>This is can be tricky business depending on how selective you want to be</li>
<li><code>H5Ovisit</code> visits <i>objects</i> and does not account for dangling links, etc.</li>
<li><code>H5Ocopy</code>'s behavior is highly customizable. Check the options &amp; play w/
<code>h5copy</code> to see the effect!</li>
</ul>
</div>
</li>

<li><a id="org2b872d4"></a>More Questions<br />
<ul class="org-ul">
<li><a id="orgb1655f1"></a>Question 1<br />
<div class="outline-text-5" id="text-orgb1655f1">
<blockquote>
<p>
I have an unrelated question. I have 7,000 HDF5 files, each 500 MB long. When I
use them, should I open them selectively, when I need them, or is it
advantageous to make one big file, or to open virtual files? I am interested in
the speed of the different approaches.
</p>
</blockquote>

<ul class="org-ul">
<li>40 GbE connectivity</li>
<li>10 contiguously laid out Datasets per file =&gt; ~50 MB per dataset</li>
<li>Always reading full datasets</li>
<li><b><b>Considerations:</b></b>
<ul class="org-ul">
<li>If you have the RAM and use all data in an "epoch" just read whole files and
use <a href="https://support.hdfgroup.org/HDF5/doc/Advanced/FileImageOperations/HDF5FileImageOperations.pdf">HDF5 file images</a> for "in-memory I/O."</li>
<li>You could maintain an index file <i>I</i> which contains external links (one for
each of the 7,000 files), and a dataset which for each external file and
dataset contains the offset of the dataset in the file. You would keep <i>I</i>
(small!) in memory and, for each dataset request, read the ~50MB directly
w/o the HDF5 library. This assumes that no datatype conversion is necessary
and you have no trouble interpreting the bytes.</li>
<li>A variation of the previous approach would be for the stub-file to contain
HDF5 <a href="https://www.star.nesdis.noaa.gov/jpss/documents/HDF5_Tutorial_201509/2-3-Working%20with%20collections%20of%20HDF5%20files.pptx.pdf"><i>virtual datasets</i></a>, datasets stitched together from other
datasets. This would we a good option, if you wanted to simplify your
application code and make everything appear as a single large HDF5
file. It'd be important though to have that (small) stub-file on the clients
in memory to not incur a high latency penalty.</li>
<li>Both approaches can be easily parallelized, assuming read-only access. If
there are writers involved, it's still doable, but additional considerations
apply.</li>
</ul></li>
</ul>

<blockquote>
<p>
Another question: what is the recommended way to combine Python with C++ with
C++ reading in and working on large hdf5 files that require a lot of speed.
</p>
</blockquote>

<ul class="org-ul">
<li>To be honest, we ran out of time and I (GH) didn't fully grasp the question.</li>
<li>Steven said something about Julia</li>
<li>Henric uses Boost Python.  What about Cython?</li>
<li><p>
What's the access pattern?
</p>

<p>
<b><b>Let's continue the discussion on the forum or come back next week!</b></b>
</p></li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orgb116dc4" class="outline-3">
<h3 id="orgb116dc4">Last week's highlights</h3>
<div class="outline-text-3" id="text-orgb116dc4">
</div>
<ul class="org-ul">
<li><a id="orgfe5f104"></a>Forum<br />
<div class="outline-text-4" id="text-orgfe5f104">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/possible-bug-with-hyperslab-selection-in-1-10-7/8164">Hyperslab selection bug confirmed</a></li>
<li><a href="https://forum.hdfgroup.org/t/write-data-to-variable-length-string-attribute/8101">Write data to variable length string attribute</a> bug is a feature <code>;-)</code></li>
<li><a href="https://forum.hdfgroup.org/t/creating-a-dataset-through-external-link-does-not-allow-hdf5view-to-see-resulting-dataset-from-root-file/8148">Possible bug in HDFView</a>
<ul class="org-ul">
<li>The <a href="https://en.wikipedia.org/wiki/Minimal_working_example">MWE</a> checks out and it looks more and more like a bug in HDFView</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-org280a8f8" class="outline-3">
<h3 id="org280a8f8">Appendix</h3>
<div class="outline-text-3" id="text-org280a8f8">
</div>
<ul class="org-ul">
<li><a id="org6f8d9a1"></a>The <code>h5copy</code> command line tool<br />
<div class="outline-text-4" id="text-org6f8d9a1">
<pre class="example" id="org9c9259e">
gerd@guix ~$ h5copy

usage: h5copy [OPTIONS] [OBJECTS...]
   OBJECTS
      -i, --input        input file name
      -o, --output       output file name
      -s, --source       source object name
      -d, --destination  destination object name
   OPTIONS
      -h, --help         Print a usage message and exit
      -p, --parents      No error if existing, make parent groups as needed
      -v, --verbose      Print information about OBJECTS and OPTIONS
      -V, --version      Print version number and exit
      --enable-error-stack
                  Prints messages from the HDF5 error stack as they occur.
      -f, --flag         Flag type

      Flag type is one of the following strings:

      shallow     Copy only immediate members for groups

      soft        Expand soft links into new objects

      ext         Expand external links into new objects

      ref         Copy references and any referenced objects, i.e., objects
                  that the references point to.
                    Referenced objects are copied in addition to the objects
                  specified on the command line and reference datasets are
                  populated with correct reference values. Copies of referenced
                  datasets outside the copy range specified on the command line
                  will normally have a different name from the original.
                    (Default:Without this option, reference value(s) in any
                  reference datasets are set to NULL and referenced objects are
                  not copied unless they are otherwise within the copy range
                  specified on the command line.)

      noattr      Copy object without copying attributes

      allflags    Switches all flags from the default to the non-default setting

      These flag types correspond to the following API symbols

      H5O_COPY_SHALLOW_HIERARCHY_FLAG
      H5O_COPY_EXPAND_SOFT_LINK_FLAG
      H5O_COPY_EXPAND_EXT_LINK_FLAG
      H5O_COPY_EXPAND_REFERENCE_FLAG
      H5O_COPY_WITHOUT_ATTR_FLAG
      H5O_COPY_ALL
</pre>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org691498e" class="outline-2">
<h2 id="org691498e">Clinic 2021-02-09</h2>
<div class="outline-text-2" id="text-org691498e">
<p>
<b><b>THIS MEETING IS BEING RECORDED</b></b> and the recording will be available on The
HDF Group's <a href="https://www.youtube.com/channel/UCRhtsIZquL3r-zH-R-r9-tQ">YouTube channel</a>. Remember to subscribe!
</p>
</div>

<div id="outline-container-org9e0398f" class="outline-3">
<h3 id="org9e0398f">Goal(s)</h3>
</div>
<div id="outline-container-org3a8eccc" class="outline-3">
<h3 id="org3a8eccc">This is a meeting dedicated to <i>your</i> questions.</h3>
</div>
<div id="outline-container-org74fd3c7" class="outline-3">
<h3 id="org74fd3c7">In the unlikely event there aren't any</h3>
<div class="outline-text-3" id="text-org74fd3c7">
<p>
We have a few prepared topics (forum posts, announcements, etc.)
</p>
</div>
</div>
<div id="outline-container-org4ed2812" class="outline-3">
<h3 id="org4ed2812">Sometimes life deals you an HDF5 file</h3>
<div class="outline-text-3" id="text-org4ed2812">
<p>
No question is too small. We are here to learn. All of us.
</p>
</div>
</div>

<div id="outline-container-org7a83c7b" class="outline-3">
<h3 id="org7a83c7b">Meeting Etiquette</h3>
</div>
<div id="outline-container-org4783aaf" class="outline-3">
<h3 id="org4783aaf">Be social, turn on your camera (if you've got one)</h3>
<div class="outline-text-3" id="text-org4783aaf">
<p>
Talking to black boxes isn't fun.
</p>
</div>
</div>

<div id="outline-container-org20cb2e0" class="outline-3">
<h3 id="org20cb2e0">Raise your hand to signal a contribution (question, comment)</h3>
<div class="outline-text-3" id="text-org20cb2e0">
<p>
Mute yourself while others are speaking, be ready to participate.
</p>
</div>
</div>

<div id="outline-container-orgd4ade04" class="outline-3">
<h3 id="orgd4ade04">Be mindful of your "airtime"</h3>
<div class="outline-text-3" id="text-orgd4ade04">
<p>
We want to cover as many of your topics as possible. Be fair to others.
</p>
</div>
</div>

<div id="outline-container-org815075d" class="outline-3">
<h3 id="org815075d">Introduce yourself</h3>
<div class="outline-text-3" id="text-org815075d">
<ol class="org-ol">
<li>Your Name</li>
<li>Your affiliation/organization/group</li>
<li>One reason why you are here today</li>
</ol>
</div>
</div>

<div id="outline-container-orgd5e1cb1" class="outline-3">
<h3 id="orgd5e1cb1">Use the shared Google doc for questions and code snippets</h3>
<div class="outline-text-3" id="text-orgd5e1cb1">
<p>
The <a href="https://docs.google.com/document/d/17j7MsAdNdCLxxWA_PtXv3jTgWDTqOm2uTk5jHCj8zXM/edit">link</a> can be found in the chat window.
</p>
</div>
</div>

<div id="outline-container-org95e8ff4" class="outline-3">
<h3 id="org95e8ff4">When the 30 min. timer runs out, this meeting is over.</h3>
<div class="outline-text-3" id="text-org95e8ff4">
<p>
Continue the discussion on the <a href="https://forum.hdfgroup.org/">HDF Forum</a> or come back next week!
</p>
</div>
</div>

<div id="outline-container-orgb944216" class="outline-3">
<h3 id="orgb944216">Notes</h3>
</div>
<div id="outline-container-org427786a" class="outline-3">
<h3 id="org427786a">Don't miss our next webinar about data virtualization with HDF5-UDF and how it can streamline your work</h3>
<div class="outline-text-3" id="text-org427786a">
<ul class="org-ul">
<li>Presented by Lucas Villa Real (IBM Research)</li>
<li>Feb 12, 2021 11:00 AM in Central Time (US and Canada)</li>
<li><a href="https://zoom.us/meeting/register/tJEsc-iqrj4iGNJirT52ttruJ1DH2uWmFV">Sign-up link</a></li>
</ul>
</div>
</div>

<div id="outline-container-org3af2c31" class="outline-3">
<h3 id="org3af2c31">Bug-of-the-Week Award (my candidate)</h3>
<div class="outline-text-3" id="text-org3af2c31">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/write-data-to-variable-length-string-attribute/8101">Write data to variable length string attribute</a> by Kerim Khemraev</li>
<li><a href="https://jira.hdfgroup.org/browse/HDFFV-11215">Jira issue HDFFV-11215</a></li>
<li><p>
Quick demonstration
</p>
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #808080;">#include</span> <span style="color: #008000;">"hdf5.h"</span>

<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;filesystem&gt;</span>
<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;iostream&gt;</span>
<span style="color: #808080;">#include</span> <span style="color: #008000;">&lt;string&gt;</span>

<span style="color: #808080;">#define</span> <span style="color: #BA36A5;">H5FILE_NAME</span> <span style="color: #008000;">"Attributes.h5"</span>
<span style="color: #808080;">#define</span> <span style="color: #BA36A5;">ATTR_NAME</span>   <span style="color: #008000;">"VarLenAttr"</span>

<span style="color: #0000FF;">namespace</span> <span style="color: #D0372D;">fs</span> = <span style="color: #D0372D;">std</span>::filesystem;

<span style="color: #6434A3;">int</span> <span style="color: #006699;">main</span>(<span style="color: #6434A3;">int</span> <span style="color: #BA36A5;">argc</span>, <span style="color: #6434A3;">char</span> *<span style="color: #BA36A5;">argv</span>[])
{
  <span style="color: #6434A3;">hid_t</span> <span style="color: #BA36A5;">file</span>, <span style="color: #BA36A5;">attr</span>;

  <span style="color: #0000FF;">auto</span> <span style="color: #BA36A5;">attr_type</span> = H5Tcopy(H5T_C_S1);
  H5Tset_size(attr_type, H5T_VARIABLE);
  H5Tset_cset(attr_type, H5T_CSET_UTF8);

  <span style="color: #0000FF;">auto</span> <span style="color: #BA36A5;">make_scalar_attr</span> = [](<span style="color: #0000FF;">auto</span>&amp; <span style="color: #BA36A5;">file</span>, <span style="color: #0000FF;">auto</span>&amp; <span style="color: #BA36A5;">attr_type</span>)
    -&gt; hid_t
  {
    <span style="color: #0000FF;">auto</span> <span style="color: #BA36A5;">attr_space</span>  = H5Screate(H5S_SCALAR);
    <span style="color: #0000FF;">auto</span> <span style="color: #BA36A5;">result</span> = H5Acreate(file, ATTR_NAME,
                            attr_type, attr_space,
                            H5P_DEFAULT, H5P_DEFAULT);
    H5Sclose(attr_space);
    <span style="color: #0000FF;">return</span> result;
  };

  <span style="color: #0000FF;">if</span>( !<span style="color: #D0372D;">fs</span>::exists(H5FILE_NAME) )
    { <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">If the file doesn't exist we create it &amp;</span>
      <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">add a root group attribute</span>
      <span style="color: #D0372D;">std</span>::cout &lt;&lt; <span style="color: #008000;">"Creating file...\n"</span>;
      file = H5Fcreate(H5FILE_NAME, H5F_ACC_TRUNC,
                       H5P_DEFAULT, H5P_DEFAULT);
      attr = make_scalar_attr(file, attr_type);
    }
  <span style="color: #0000FF;">else</span>
    { <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">File exists: we either delete the attribute and</span>
      <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">re-create it, or we just re-write it.</span>
      <span style="color: #D0372D;">std</span>::cout &lt;&lt; <span style="color: #008000;">"Opening file...\n"</span>;
      file = H5Fopen(H5FILE_NAME, H5F_ACC_RDWR, H5P_DEFAULT);

<span style="color: #808080;">#if</span><span style="color: #808080;">n</span><span style="color: #808080;">def</span> REWRITE_ONLY
      H5Adelete(file, ATTR_NAME);
      attr = make_scalar_attr(file, attr_type);
<span style="color: #808080;">#else</span>
      attr = H5Aopen(file, ATTR_NAME, H5P_DEFAULT);
<span style="color: #808080;">#endif</span>
    }

  <span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Write or re-write the attribute</span>
  <span style="color: #0000FF;">const</span> <span style="color: #6434A3;">char</span>* <span style="color: #BA36A5;">data</span>[1] = { <span style="color: #008000;">"Let it be &#955;!"</span> };
  H5Awrite(attr, attr_type, data);

  <span style="color: #6434A3;">hsize_t</span> <span style="color: #BA36A5;">size</span>;
  H5Fget_filesize(file, &amp;size);
  <span style="color: #D0372D;">std</span>::cout &lt;&lt; <span style="color: #008000;">"File size: "</span> &lt;&lt; size &lt;&lt; <span style="color: #008000;">" bytes\n"</span>;

  H5Tclose(attr_type);
  H5Aclose(attr);
  H5Fclose(file);
}
</pre>
</div></li>
</ul>
</div>
</div>

<div id="outline-container-orgf0a7121" class="outline-3">
<h3 id="orgf0a7121">Documentation update</h3>
<div class="outline-text-3" id="text-orgf0a7121">
<ul class="org-ul">
<li>Doxygen-based RM</li>
<li>Remaining: a few <code>H5P</code>  calls and <code>H5E</code></li>
<li>Current version: <a href="https://hdf5.io/develop/modules.html">https://hdf5.io/develop/modules.html</a></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org4f24f13" class="outline-2">
<h2 id="org4f24f13">Clinic 2021-02-16</h2>
<div class="outline-text-2" id="text-org4f24f13">
<p>
<a id="org87af9da"></a>
</p>
</div>
<div id="outline-container-orgf10e574" class="outline-3">
<h3 id="orgf10e574">Your questions</h3>
</div>
<div id="outline-container-org3da215c" class="outline-3">
<h3 id="org3da215c">Last week's highlights</h3>
<div class="outline-text-3" id="text-org3da215c">
</div>
<ul class="org-ul">
<li><a id="org5824579"></a>Events<br />
<div class="outline-text-4" id="text-org5824579">
<ul class="org-ul">
<li><a href="https://www.youtube.com/watch?v=7ZYZKB7DNUg">Webinar: <i>Learn about data virtualization with HDF5-UDF and how it can
streamline your work</i></a></li>
<li><a href="https://www.youtube.com/watch?v=g5h_YlvI9Aw">Recording of last week's clinic</a></li>
</ul>
</div>
</li>
<li><a id="org3f133f0"></a>Forum<br />
<div class="outline-text-4" id="text-org3f133f0">
<ul class="org-ul">
<li><a href="https://forum.hdfgroup.org/t/hdfql-2-3-0-release-with-excel-import-export-support/8132">Release of HDFql 2.3.0</a>
<ul class="org-ul">
<li>Excel import and export (no Excel or OLE dependency!)</li>
</ul></li>
<li><a href="https://forum.hdfgroup.org/t/creating-a-dataset-through-external-link-does-not-allow-hdf5view-to-see-resulting-dataset-from-root-file/8148">Possible bug in HDFView</a>
<ul class="org-ul">
<li>Based on the description, it appears that external links are not properly
traversed</li>
<li>Waiting for <a href="https://en.wikipedia.org/wiki/Minimal_working_example">MWE</a></li>
</ul></li>
<li><a href="https://forum.hdfgroup.org/t/possible-bug-with-hyperslab-selection-in-1-10-7/8164">Possible hyperslab selection bug in 1.10.7</a>
<ul class="org-ul">
<li>It appears that <code>H5S_SELECT_OR</code> is no longer "commutative", i.e., <code>H5Dread</code>
with <code>SelA OR SelB</code> works, but not <code>SelB OR SelA</code></li>
<li>Wasn't there in 1.10.6</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
<div id="outline-container-org672a2f4" class="outline-3">
<h3 id="org672a2f4">Notes</h3>
<div class="outline-text-3" id="text-org672a2f4">
</div>
<ul class="org-ul">
<li><a id="org64fd2d1"></a>What (if any) are the ACID properties of HDF5 operations?<br />
<ul class="org-ul">
<li><a id="org2e34fbe"></a>Split-state<br />
<div class="outline-text-5" id="text-org2e34fbe">
<p>
The state of an open (for RW) HDF5 file is <i>split</i> between RAM and persistent
storage. Often the partial states will be out of sync. In the event of a
"catastrophic" failure (power outage, application crash, system crash), it is
impossible to predict what the partial state on disk will be.
</p>

<div class="org-src-container">
<pre class="src src-plantuml">skinparam componentStyle rectangle

package <span style="color: #008000;">"HDF5 File State"</span> {
    database <span style="color: #008000;">"Disk"</span> {
        [Partial State 1]
    }
    cloud <span style="color: #008000;">"RAM"</span> {
        [Partial State 2]
    }
}
</pre>
</div>


<div id="orged5da49" class="figure">
<p><img src="../img/hdf5-file-state.png" alt="hdf5-file-state.png" />
</p>
</div>
</div>
</li>

<li><a id="org472e66c"></a>Non-transactional<br />
<div class="outline-text-5" id="text-org472e66c">
<p>
The main reason why it is impossible to predict the outcome is that HDF5
operations are non-transactional. By 'transaction' I mean a collection of
operations (and the effects of their execution) on the physical and abstract
application state. In particular, there are no concepts of beginning a
transaction, a commit, or a roll-back. Since they are not transactional, it is
not straightforward to speak about the ACID properties of HDF5 operations.
</p>
</div>
</li>

<li><a id="orgb0ba9c1"></a>File system facilities<br />
<div class="outline-text-5" id="text-orgb0ba9c1">
<p>
People sometimes speak about ACID properties with respect to file system
operations. Although the HDF5 library relies on file system operations for the
implementation of HDF5 operations, the correspondence is not as direct as
might wish. For example, what appears as a single HDF5 operation to the user
often includes multiple file system operations. Several file system operations
have a certain property only at the level of a single operation, but not
multiple operations combined.
</p>
</div>
</li>

<li><a id="org75ee2e6"></a>ACID<br />
<div class="outline-text-5" id="text-org75ee2e6">
<dl class="org-dl">
<dt>Atomicity</dt><dd>All changes to an HDF5 file's state must complete or fail as a
whole unit.
<ul class="org-ul">
<li>Supported in HDF5? <b><b>No.</b></b></li>
<li>Some file systems only support single op. atomicity, if at all.</li>
<li>A lot of HDF5 operations are <i>in-place</i>; mixed success -&gt; impossible to
recover</li>
</ul></dd>
<dt>Consistency</dt><dd>An operation is a correct transformation of the HDF5 file's
state.
<ul class="org-ul">
<li>Supported in HDF5? <b><b>Yes and No</b></b></li>
<li>Depends on one's definition of HDF5 file/object integrity constraints</li>
<li>Assuming we are dealing with a correct program</li>
<li>Special case w/ multiple processes: Single Writer Multiple Reader</li>
</ul></dd>
<dt>Isolation (serialization)</dt><dd>Even though operations execute concurrently, it
appears to each operation, OP, that others executed either before OP or after
OP, but not both.
<ul class="org-ul">
<li>Supported in HDF5? <b><b>No.</b></b></li>
<li>Depends on concurrency scenario and requires special configuration (e.g.,
MT, MPI).</li>
<li>Time-of-check-time-of-use vulnerability</li>
</ul></dd>
<dt>Durability</dt><dd>Once an operation completes successfully, it's changes to the
file's state survive failure.
<ul class="org-ul">
<li>Supported in HDF5? <b><b>No.</b></b></li>
<li>"Split brain"</li>
<li>No transaction log</li>
</ul></dd>
</dl>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: gerd</p>
<p class="date">Created: 2022-07-19 Tue 12:04</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
